---
title: "Falling Rock R notebook"
output: html_notebook
---

# Section 1: Pre-processing

The process began by downloading all data sets from https://www.sciencebase.gov/catalog/item/5d812cace4b0c4f70d05854c as a .csv file to a designated desktop folder. For this code, the Falling Rock flow data, air temperature data, and precipitation data were all downloaded. After opening Rstudio, the read.csv function was then used to import all of the data.
```{r}
FallingRock<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/FRData.csv") #reading in the falling rock flow data
FallingRock.air.temp <-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/Air_temp.csv")
#reading in the falling rock air temperature data
FallingRock.precip.data<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/Table_3_FR_B_precip.csv")
#reading in the falling rock precipitation data
Camp.precip.data <- read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/Table_2_CAMP_precip.csv")
Camp.precip.data.new <- read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/CWS_precip_tyler.csv")
#reading in the camp data
#using the read.csv function to import the data sets and assign them names in RStudio
```

After the raw data sets were imported, the different libraries necessary for data analysis were installed and loaded into Rstudio. For this project, the ggplot2 package, hydroTSM package, trend package, lubridate package, and dplyr package were all necessary. 
```{r}
library(ggplot2) #loading in ggplot2 package
library(hydroTSM) #loading in hydroTSM package
library(trend) #loading in trend package
library(lubridate)#loading in lubridate package
library(plyr)
library(dplyr) #loading in dplyr package
library(scales) #loading in scales package
library(TTR) #loading in TTR package
library(tidyquant) #loading in tidyquant
library(tidyr) #loading in tidyr
library(ggridges) #loading in ggridges
library(robslopes) #loading in robslopes
library(Kendall) #loading in Kendall package
library(zyp) #loading in zyp
library(gridExtra)
```

Every function in use
```{r}
sens.output <- function(time.step,data,conf.level=0.95) {
  thiel.sen.output <- TheilSen(time.step,data)
  slope <- thiel.sen.output$slope
  intercept <- thiel.sen.output$intercept
  p.value <- sens.slope(data,conf.level)$p.value
  p.2 <- zyp.zhang(y=data,x=time.step)[6]

 
  output.sens <- data.frame('slope'=slope,'intercept'=intercept,'p.value'=p.value,'p.zyp'=p.2)
  return(output.sens)
}
```

Next, a data frame was created for each year. A column with the respective year was also added for each data set
```{r}
FallingRock$Date.1 <- mdy(FallingRock$Date) #transforming the date class into mdy from string
FallingRock$year <- substr(x=FallingRock$Date.1,0,4) #creates a new column for Falling Rock year
FallingRock$month <- substr(x=FallingRock$Date.1,6,7)
#creates a column for the month
substrRight <- function(x, n){
  substr(x, nchar(x)-n+1, nchar(x))
}
FallingRock.air.temp$year <- substrRight(x=FallingRock.air.temp$Date,n=4) #creates a new column for year for FallingRock.air.temp data
FallingRock.air.temp$Date.1 <- mdy(FallingRock.air.temp$Date)
#creates a new date column in the mdy from string
FallingRock.air.temp$month <- substr(x=FallingRock.air.temp$Date.1,6,7)
#creates a column for the month
FallingRock.precip.data$year <- substrRight(x=FallingRock.precip.data$Date,n=4) #creates a new column for FallingRock.precip.data
FallingRock.precip.data$Date.1 <- mdy(FallingRock.precip.data$Date)
#creates a new date column in the mdy from string
FallingRock.precip.data$month <- substr(x=FallingRock.precip.data$Date.1,6,7)
#creates a new column designating which month the point falls in
Camp.precip.data$year <- substrRight(x=Camp.precip.data$Date,n=4)
#creates a new column for the year
Camp.precip.data$Date.1 <- mdy(Camp.precip.data$Date)
#creates a new date column in mdy from strings
Camp.precip.data$month <- substr(x=Camp.precip.data$Date.1,6,7)
#creates a new column designating which month the point falls in
Camp.precip.data.new$year <- substrRight(x=Camp.precip.data.new$date,n=4)
#creates a new column for the year
Camp.precip.data.new$Date.1 <- mdy(Camp.precip.data.new$date)
#creates a new date column in mdy from strings
Camp.precip.data.new$month <- substr(x=Camp.precip.data.new$Date.1,6,7)
#creates a new column designating which month the point falls in
Camp.precip.data.new$precip_mm <- Camp.precip.data.new$precip_in*25.4
FallingRock$half.decade <- ifelse(FallingRock$year>=1971 & FallingRock$year<=1975,1,
                                   ifelse(FallingRock$year>=1976 & FallingRock$year<=1980,2,
                                          ifelse(FallingRock$year>=1981 & FallingRock$year<=1985,3,
                                                 ifelse(FallingRock$year>=1986 & FallingRock$year<=1990,4,
                                                        ifelse(FallingRock$year>=1991 & FallingRock$year<=1995,5,
                                                               ifelse(FallingRock$year>=1996 & FallingRock$year<=2000,6,
                                                                      ifelse(FallingRock$year>=2001 & FallingRock$year<=2005,7,
                                                                             ifelse(FallingRock$year>=2006 & FallingRock$year<=2010,8,
                                                                                    ifelse(FallingRock$year>=2011 & FallingRock$year<=2015,9,
                                                                                    ifelse(FallingRock$year>=2016 & FallingRock$year<=2020,10,NA
                                          ))))))))))
#creating a list of 1/2 decades to split the data into
FallingRock$Flow.state.ID <- ifelse(FallingRock$mindaily_CFS>0,1,0)
```

The final part of pre-processing is ensuring each year has a complete or nearly complete data set. Any year that has less than 90% of data must be discarded. 

```{r}
Q.Threshold <- matrix(nrow=length(unique(FallingRock$year)),ncol=4) #creating a matrix to determine if 90% of data is available for each unique year
Q.Threshold <- data.frame(Q.Threshold) #turning the matrix into a data frame
colnames(Q.Threshold) <- c("Year","number_days_with_data","Total_number_of_days","ratio")#assigning column names
years <- unique(FallingRock$year) #assigning years to each unique FR year
for(i in 1:length(unique(FallingRock$year))){ #running a for loop through the length of FR years
  x <- length(FallingRock$meandaily_CFS[which(FallingRock$year==years[i])]) #counting the total number of days (NA included) in FR
  y <- length(na.omit(FallingRock$meandaily_CFS[which(FallingRock$year==years[i])])) #counting the number of days with data in FR
  ratio <- y/x #getting the ratio of days w data to total days
  Q.Threshold$Year[i] <- years[i] #assigning the years to a column
  Q.Threshold$number_days_with_data[i] <- y #assigning the days with data to a column
  Q.Threshold$Total_number_of_days[i] <- x #assigning the total number of days to a column
  Q.Threshold$ratio[i] <- ratio #assigning the ratio to a column
}
#years with less than 90% of data: 1971,2014,2016,2017,2018

Precip.Threshold <- matrix(nrow=length(unique(FallingRock.precip.data$year)),ncol=4) #creating a matrix to determine if 90% of data is available for each unique year
Precip.Threshold <- data.frame(Precip.Threshold)#turning the matrix into a data frame
colnames(Precip.Threshold) <- c("Year","number_days_with_data","Total_number_of_days","ratio")#assigning column names
years <- unique(FallingRock.precip.data$year)#assigning years to each unique FR precip data year
for(i in 1:length(unique(FallingRock.precip.data$year))){#running a for loop through the length of FR years
  x <- length(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$year==years[i])])#counting the total number of days (NA included) in FR
  y <- length(na.omit(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$year==years[i])]))#counting the number of days with data in FR
  ratio <- y/x #getting the ratio of days w data to total days
  Precip.Threshold$Year[i] <- years[i] #assigning the years to a column
  Precip.Threshold$number_days_with_data[i] <- y#assigning the days with data to a column
  Precip.Threshold$Total_number_of_days[i] <- x #assigning the total number of days to a column
  Precip.Threshold$ratio[i] <- ratio #assigning the ratio to a column
}
#years with less than 90% of data: 1994,1995,2004,2005,2006,2008-2018

Camp.precip.Threshold <- matrix(nrow=length(unique(Camp.precip.data$year)),ncol=4) #creating a matrix to determine if 90% of data is available for each unique year
Camp.precip.Threshold <- data.frame(Camp.precip.Threshold)#turning the matrix into a data frame
colnames(Camp.precip.Threshold) <- c("Year","number_days_with_data","Total_number_of_days","ratio")#assigning column names
years <- unique(Camp.precip.data$year)#assigning years to each unique FR precip data year
for(i in 1:length(unique(Camp.precip.data$year))){#running a for loop through the length of FR years
  x <- length(Camp.precip.data$Precip_mm[which(Camp.precip.data$year==years[i])])#counting the total number of days (NA included) in FR
  y <- length(na.omit(Camp.precip.data$Precip_mm[which(Camp.precip.data$year==years[i])]))#counting the number of days with data in FR
  ratio <- y/x #getting the ratio of days w data to total days
  Camp.precip.Threshold$Year[i] <- years[i] #assigning the years to a column
  Camp.precip.Threshold$number_days_with_data[i] <- y#assigning the days with data to a column
  Camp.precip.Threshold$Total_number_of_days[i] <- x #assigning the total number of days to a column
  Camp.precip.Threshold$ratio[i] <- ratio #assigning the ratio to a column
}
#years with less than 90% of data:2005, 2006, 2016, 2017

AirTemp.Threshold <- matrix(nrow=length(unique(FallingRock.air.temp$year)),ncol=4)#creating a matrix to determine if 90% of data is available for each unique year
AirTemp.Threshold <- data.frame(AirTemp.Threshold)#turning the matrix into a data frame
colnames(AirTemp.Threshold) <- c("Year","number_days_with_data","Total_number_of_days","ratio") #assigning column names
years <- as.numeric(unique(FallingRock.air.temp$year))#assigning years to each unique FR precip data year
for(i in 1:length(unique(FallingRock.air.temp$year))){#running a for loop through the length of FR years
  x <- length(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$year==years[i])])#counting the total number of days (NA included) in FR
  y <- length(na.omit(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$year==years[i])]))#counting the number of days with data in FR
  ratio <- y/x #getting the ratio of days w data to total days
  AirTemp.Threshold$Year[i] <- years[i] #assigning the years to a column
  AirTemp.Threshold$number_days_with_data[i] <- y #assigning the days with data to a column
  AirTemp.Threshold$Total_number_of_days[i] <- x #assigning the total number of days to a column
  AirTemp.Threshold$ratio[i] <- ratio #assigning the ratio to a column
}
#years with less than 90% of data: 1971,2007,2009,2016,2017

```

# Section 2: Climate Variable Plots

To begin plotting the data, data frames for precipitation, air temperature, water temperature, and discharge data were created. Through creating the data frames, each individual variable can be graphed and broken down into smaller sections for data analysis. 

```{r}
FR.Precip.data <- data.frame(FallingRock.precip.data$Date.1,FallingRock.precip.data$year,FallingRock.precip.data$Precip_mm) #creating a data frame for precipitation data

CWS.Precip.data <- data.frame(Camp.precip.data$Date.1,Camp.precip.data$year,Camp.precip.data$Precip_mm,Camp.precip.data$Precip_mm) #creating a data frame for CWS precip data

FR.airtemp.data <- data.frame(FallingRock.air.temp$Date.1,FallingRock.air.temp$year,FallingRock.air.temp$DailyMean_degF,FallingRock.air.temp$DailyMin_degF,FallingRock.air.temp$DailyMax_degF) #creating a data frame for air temperature data

FR.watertemp.data <- data.frame(FallingRock$Date.1,FallingRock$year,FallingRock$tempmean,FallingRock$tempmin,FallingRock$tempmax) #creating a data frame for water temperature data

FR.discharge.data <- data.frame(FallingRock$Date.1,FallingRock$year,FallingRock$meandaily_CFS,FallingRock$mindaily_CFS,FallingRock$maxdaily_CFS) #creating a data frame for discharge data
```


In this section, plots for each variable (precipitation, air temperature, water temperature, and mean daily flow data) were created. These plots include the entire time series from 1977 to 2016 and are general plots. 

#### Section 2.1.1: Camp Weather Station Precipitation 
```{r}
FallingRock.precip.data<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/Table_3_FR_B_precip.csv")

FallingRock.precip.data.camp<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/Table_2_CAMP_precip.csv")

FallingRock.precip.data.head<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/Table_4_FR_H_precip.csv")

FallingRock.precip.data.camp.new <- data.frame(Date=FallingRock.precip.data.camp$Date)
FallingRock.precip.data.camp.new$camp <- FallingRock.precip.data.camp$Precip_mm

FallingRock.precip.data.head.new <- data.frame(Date=FallingRock.precip.data.head$Date)
FallingRock.precip.data.head.new$head <- FallingRock.precip.data.head$Precip_mm

Falling.rock.precip.clean <- data.frame(matrix(nrow=length(FallingRock.precip.data$Precip_mm),ncol=2))
colnames(Falling.rock.precip.clean) <- c('Date','base')

Updated.camp.precip <- data.frame(matrix(nrow=length(Camp.precip.data.new$precip_mm),ncol=2))
colnames(Updated.camp.precip) <- c('Date','Camp.new')
Updated.camp.precip$Date <- Camp.precip.data.new$date
Updated.camp.precip$Camp.new <- Camp.precip.data.new$precip_mm

Falling.rock.precip.clean$Date <- FallingRock.precip.data$Date
Falling.rock.precip.clean$base <- FallingRock.precip.data$Precip_mm
Falling.rock.precip <- Falling.rock.precip.clean %>% left_join(FallingRock.precip.data.head.new,by= 'Date')
Falling.rock.precip <- Falling.rock.precip %>% left_join(FallingRock.precip.data.camp.new,by= 'Date')
Falling.rock.precip <- Falling.rock.precip %>% left_join(Updated.camp.precip,by= 'Date')
Falling.rock.precip$clean <- ifelse(!is.na(Falling.rock.precip$base),Falling.rock.precip$base,ifelse(!is.na(Falling.rock.precip$head),Falling.rock.precip$head,ifelse(!is.na(Falling.rock.precip$camp),Falling.rock.precip$camp,ifelse(!is.na(Falling.rock.precip$Camp.new),Falling.rock.precip$Camp.new,NA))))


Falling.rock.precip$year <- substrRight(x=Falling.rock.precip$Date, n=4) #creates a new column for FallingRock.precip.data
Falling.rock.precip$year <- as.numeric(Falling.rock.precip$year)
clean.Threshold <- matrix(nrow=length(unique(Falling.rock.precip$year)),ncol=4) #creating a matrix to determine if 90% of data is available for each unique year
clean.Threshold <- data.frame(clean.Threshold)#turning the matrix into a data frame
colnames(clean.Threshold) <- c("Year","number_days_with_data","Total_number_of_days","ratio")#assigning column names
for(i in 1:length(unique(Falling.rock.precip$year))){#running a for loop through the length of FR years
  x <- length(Falling.rock.precip$clean[which(Falling.rock.precip$year==years[i])])#counting the total number of days (NA included) in FR
  y <- length(na.omit(Falling.rock.precip$clean[which(Falling.rock.precip$year==years[i])]))#counting the number of days with data in FR
  ratio <- y/x #getting the ratio of days w data to total days
  clean.Threshold$Year[i] <- years[i] #assigning the years to a column
  clean.Threshold$number_days_with_data[i] <- y#assigning the days with data to a column
  clean.Threshold$Total_number_of_days[i] <- x #assigning the total number of days to a column
  clean.Threshold$ratio[i] <- ratio #assigning the ratio to a column
}

```

```{r}
FallingRock <- FallingRock[(3107:16256),]
Falling.rock.precip <- Falling.rock.precip[2984:16132,]
FallingRock.air.temp <- FallingRock.air.temp[3287:16431,]
Falling.rock.precip$Water_Year <- FallingRock$Water_Year[1:13149]
Falling.rock.precip$Climate_Year <- FallingRock$Climate_Year[1:13149]
FallingRock.air.temp$Water_Year <- FallingRock$Water_Year[1:13145]
FallingRock.air.temp$Climate_Year <- FallingRock$Climate_Year[1:13145]
```


### Section 2.1: Precipitation Plots
```{r}

FallingRock.precip.data <- data.frame(matrix(ncol=6, nrow=length(Falling.rock.precip$Date)))
colnames(FallingRock.precip.data) <- c("Date.1","Precip_mm","half.decade","year","season","Month")
FallingRock.precip.data$Date.1 <- mdy(Falling.rock.precip$Date)
FallingRock.precip.data$Precip_mm <- Falling.rock.precip$clean
FallingRock.precip.data$year <- substrRight(x=FallingRock.precip.data$Date.1, n=4)
FallingRock.precip.data$month <- as.numeric(substr(x=FallingRock.precip.data$Date.1,6,7))
FallingRock.precip.data$Water_Year <- Falling.rock.precip$Water_Year
FallingRock.precip.data$Climate_Year <- Falling.rock.precip$Climate_Year

#Entire Time Series Daily
ggplot(data=FallingRock.precip.data, aes(x=Date.1, y=Precip_mm))+
  geom_line()+
  ggtitle("Daily Precipitation Data")+
  xlab("Year")+
  ylab("Precipitation (mm)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

# 1/2 Decade
FallingRock.precip.data$half.decade <- ifelse(FallingRock.precip.data$year>=1971 & FallingRock.precip.data$year<=1975,1,
                                   ifelse(FallingRock.precip.data$year>=1976 & FallingRock.precip.data$year<=1980,2,
                                          ifelse(FallingRock.precip.data$year>=1981 & FallingRock.precip.data$year<=1985,3,
                                                 ifelse(FallingRock.precip.data$year>=1986 & FallingRock.precip.data$year<=1990,4,
                                                        ifelse(FallingRock.precip.data$year>=1991 & FallingRock.precip.data$year<=1995,5,
                                                               ifelse(FallingRock.precip.data$year>=1996 & FallingRock.precip.data$year<=2000,6,
                                                                      ifelse(FallingRock.precip.data$year>=2001 & FallingRock.precip.data$year<=2005,7,
                                                                             ifelse(FallingRock.precip.data$year>=2006 & FallingRock.precip.data$year<=2010,8,
                                                                                    ifelse(FallingRock.precip.data$year>=2011 & FallingRock.precip.data$year<=2015,9,
                                                                                    ifelse(FallingRock.precip.data$year>=2016 & FallingRock.precip.data$year<=2020,10,NA
                                          ))))))))))

precip.half.dec <- 1:6
sum.precip.half.dec <- data.frame(matrix(nrow=6)) #creating a matrix to sum the precipitation in each year
for(i in 1:length(precip.half.dec)){ #running a for loop through each year in precip data
  sum.precip.half.dec[i,1] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$half.decade==precip.half.dec[i])],na.rm=TRUE) #assigning a new variable for the sum of each years precip data
  colnames(sum.precip.half.dec)[1]="Precip.sum.mm"
  sum.precip.half.dec$half.decade <- precip.half.dec
}

sum.precip.half.dec <- na.omit(sum.precip.half.dec)
half.decades <- unique(FallingRock$half.decade)
sum.precip.half.dec$halfdec <- precip.half.dec
sum.precip.half.dec <- na.omit(sum.precip.half.dec)
sum.precip.halfdec.senslope <-sens.output(time.step=sum.precip.half.dec$halfdec,data=sum.precip.half.dec$Precip.sum.mm)
sum.precip.halfdec.senslope <- data.frame(sum.precip.halfdec.senslope)
sum.precip.halfdec.senslope$half.decade <- "Half.Decade"

ggplot(data=sum.precip.half.dec, aes(half.decade, Precip.sum.mm))+
  geom_col()+
  geom_abline(data=sum.precip.halfdec.senslope,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Half-Decadal Precipitation Data")+
  xlab("Half-Decade")+
  ylab("Precipitation (mm)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
  
#yearly
#calendar year
FallingRock.precip.data$year <- Falling.rock.precip$year
precip.year <- unique(FallingRock.precip.data$year)
sum.precip.year <- data.frame(matrix(nrow=length(precip.year))) #creating a matrix to sum the precipitation in each year
for(i in 1:length(precip.year)){ #running a for loop through each year in precip data
  sum.precip.year[i,1] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$year==precip.year[i])],na.rm=TRUE) #assigning a new variable for the sum of each years precip data
  colnames(sum.precip.year)[1] <- "Precip.sum.mm"
  sum.precip.year$year <- precip.year
}
sum.precip.year$year <- as.numeric(sum.precip.year$year)  
sum.precip.year <- na.omit(sum.precip.year)
sum.precip.year.senslope <- sens.output(time.step=sum.precip.year$year,data=sum.precip.year$Precip.sum.mm)
sum.precip.year.senslope$year <- "Calendar.Year"

#Water Year
precip.wateryear <- unique(FallingRock.precip.data$Water_Year)
sum.precip.wateryear <- data.frame(matrix(nrow=length(precip.wateryear))) #creating a matrix to sum the precipitation in each year
for(i in 1:length(precip.wateryear)){ #running a for loop through each year in precip data
  sum.precip.wateryear[i,1] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$Water_Year==precip.wateryear[i])],na.rm=TRUE) #assigning a new variable for the sum of each years precip data
  colnames(sum.precip.wateryear)[1] <- "Precip.sum.mm"
  sum.precip.wateryear$Water_Year <- precip.wateryear
}
sum.precip.wateryear <- na.omit(sum.precip.wateryear)
sum.precip.wateryear.senslope <- sens.output(time.step=sum.precip.wateryear$Water_Year,data=sum.precip.wateryear$Precip.sum.mm)
sum.precip.wateryear.senslope$year <- "Water.Year"

#Climate Year
precip.climateyear <- unique(FallingRock.precip.data$Climate_Year)
sum.precip.climateyear <- data.frame(matrix(nrow=length(precip.climateyear))) #creating a matrix to sum the precipitation in each year
for(i in 1:length(precip.climateyear)){ #running a for loop through each year in precip data
  sum.precip.climateyear[i,1] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$Climate_Year==precip.climateyear[i])],na.rm=TRUE) #assigning a new variable for the sum of each years precip data
  colnames(sum.precip.climateyear)[1] <- "Precip.sum.mm"
  sum.precip.climateyear$Climate_Year <- precip.climateyear
}
sum.precip.climateyear <- na.omit(sum.precip.climateyear)
sum.precip.climateyear.senslope <- sens.output(time.step=sum.precip.climateyear$Climate_Year,data=sum.precip.climateyear$Precip.sum.mm)
sum.precip.climateyear.senslope$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FRprecip.cal.jpeg", width=800)
ggplot(data=sum.precip.year, aes(year, Precip.sum.mm))+
  geom_col()+
  geom_abline(data=sum.precip.year.senslope,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Yearly Precipitation Data")+
  xlab("Year")+
  ylab("Precipitation (mm)")+
  theme(axis.text.x = element_text(size = 20), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FRprecip.water.jpeg", width=800)
ggplot(data=sum.precip.wateryear, aes(Water_Year, Precip.sum.mm))+
  geom_col()+
  geom_abline(data=sum.precip.climateyear.senslope,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Yearly Precipitation Data Using Water Year")+
  xlab("Water Year")+
  ylab("Precipitation (mm)")+
  theme(axis.text.x = element_text(size = 20), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FRprecip.clim.jpeg", width=800)
ggplot(data=sum.precip.climateyear, aes(Climate_Year, Precip.sum.mm))+
  geom_col()+
  geom_abline(data=sum.precip.climateyear.senslope,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Yearly Precipitation Data Using Climate Year")+
  xlab("Climate Year")+
  ylab("Precipitation (mm)")+
  theme(axis.text.x = element_text(size = 20), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#seasonal
FallingRock.precip.data$season <- time2season(FallingRock.precip.data$Date.1,out.fmt="seasons")
precip.season <- unique(FallingRock.precip.data$season)
sum.precip.season <- data.frame(matrix(nrow=length(precip.year),ncol=length(precip.season)))
for(i in 1:length(precip.year)){
  for(j in 1:length(precip.season)){
    sum.precip.season[i,j] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$year==precip.year[i]&FallingRock.precip.data$season==precip.season[j])],na.rm=TRUE)
  }
  colnames(sum.precip.season) <- c("Winter","Spring","Summer","Autumn")

}
seasons <- c("Winter","Spring","Summer","Autumn")
sum.precip.season$year <- precip.year
sum.precip.season$year <- as.numeric(sum.precip.season$year)
sum.precip.senslope.winter <- sens.output(time.step=sum.precip.season$year,data=sum.precip.season$Winter)
sum.precip.senslope.spring <- sens.output(time.step=sum.precip.season$year,data=sum.precip.season$Spring)
sum.precip.senslope.summer <- sens.output(time.step=sum.precip.season$year,data=sum.precip.season$Summer)
sum.precip.senslope.autumn <- sens.output(time.step=sum.precip.season$year,data=sum.precip.season$Autumn)
sum.precip.senslope.season <- rbind(sum.precip.senslope.winter,sum.precip.senslope.spring,sum.precip.senslope.summer,sum.precip.senslope.autumn)
sum.precip.senslope.season$season <- seasons


precipdata.season.long <- gather(sum.precip.season, key="season", value="value", c("Winter","Spring","Summer", "Autumn"))
precipdata.season.long <- na.omit(precipdata.season.long)

ggplot(precipdata.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=sum.precip.senslope.season, aes(slope=slope,intercept=intercept))+
  facet_wrap(~season)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Seasonal Precipiation Data")+
  xlab("Year")+
  ylab("Total Seasonal Precipitation (mm)")


#monthly
precip.month <- unique(FallingRock.precip.data$month) #assigning a variable to the unique months in precip data
sum.precip.month <- data.frame(matrix(nrow=length(precip.year),ncol=length(precip.month))) #creating a matrix for the sum of precip each month
for(i in 1:length(precip.year)){ #running a for loop to go through each year
  for(j in 1:length(precip.month)){ #running a nested for loop to go through the unique months in each year
    sum.precip.month[i,j] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$year==precip.year[i]&FallingRock.precip.data$month==precip.month[j])],na.rm=TRUE) #assigning a new variable for the sum of each months precip data
  }
  colnames(sum.precip.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
}
sum.precip.month$year <- precip.year
sum.precip.month$year <- as.numeric(sum.precip.month$year)

sum.precip.senslope.jan <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$January)
sum.precip.senslope.feb <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$February)
sum.precip.senslope.mar <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$March)
sum.precip.senslope.apr <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$April)
sum.precip.senslope.may <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$May)
sum.precip.senslope.jun <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$June)
sum.precip.senslope.jul <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$July)
sum.precip.senslope.aug <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$August)
sum.precip.senslope.sep <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$September)
sum.precip.senslope.oct <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$October)
sum.precip.senslope.nov <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$November)
sum.precip.senslope.dec <- sens.output(time.step=sum.precip.month$year,data=sum.precip.month$December)
sum.precip.senslope.monthly <- rbind(sum.precip.senslope.jan,sum.precip.senslope.feb,sum.precip.senslope.mar,sum.precip.senslope.apr,sum.precip.senslope.may,sum.precip.senslope.jun,sum.precip.senslope.jul,sum.precip.senslope.aug,sum.precip.senslope.sep,sum.precip.senslope.oct,sum.precip.senslope.nov,sum.precip.senslope.dec)
FallingRock$month <- as.numeric(FallingRock$month)
months.name <- c("January", "February", "March", "April", "May", "June","July", "August", "September", "October", "November", "December")
FallingRock$Month <- months.name[FallingRock$month]
sum.precip.senslope.monthly$month <- unique(FallingRock$Month)

precipdata.month.long <- gather(sum.precip.month, key="month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
precipdata.month.long <- na.omit(precipdata.month.long)

ggplot(precipdata.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=sum.precip.senslope.monthly, aes(slope=slope,intercept=intercept))+
  facet_wrap(~factor(month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Monthly Precipiation Data")+
  xlab("Year")+
  ylab("Total Monthly Precipitation (mm)")

```

#### Section 2.1.2: Precipitation Statistical Summary
```{r}
FR.Precip.statistical.summary <- rbind.fill(sum.precip.halfdec.senslope,sum.precip.year.senslope,sum.precip.wateryear.senslope,sum.precip.climateyear.senslope,sum.precip.senslope.season,sum.precip.senslope.monthly)
```


### Section 2.2: Air Temperature
```{r}
#Entire Time Series (Daily)
plot(x=FallingRock.air.temp$Date.1,y=FallingRock.air.temp$DailyMin_degF,col='blue',type='l',ylim = c(-25,110))
lines(x=FallingRock.air.temp$Date.1,y=FallingRock.air.temp$DailyMean_degF,col='yellow',type='l')
lines(x=FallingRock.air.temp$Date.1,y=FallingRock.air.temp$DailyMax_degF,col='red',type='l')
title("Daily Air Temperature")

```

#### Section 2.2.1: Minimum Air Temperature
```{r}
# 1/2 Decade
FallingRock.air.temp$half.decade <- ifelse(FallingRock.air.temp$year>=1971 & FallingRock.air.temp$year<=1975,1,
                                   ifelse(FallingRock.air.temp$year>=1976 & FallingRock.air.temp$year<=1980,2,
                                          ifelse(FallingRock.air.temp$year>=1981 & FallingRock.air.temp$year<=1985,3,
                                                 ifelse(FallingRock.air.temp$year>=1986 & FallingRock.air.temp$year<=1990,4,
                                                        ifelse(FallingRock.air.temp$year>=1991 & FallingRock.air.temp$year<=1995,5,
                                                               ifelse(FallingRock.air.temp$year>=1996 & FallingRock.air.temp$year<=2000,6,
                                                                      ifelse(FallingRock.air.temp$year>=2001 & FallingRock.air.temp$year<=2005,7,
                                                                             ifelse(FallingRock.air.temp$year>=2006 & FallingRock.air.temp$year<=2010,8,
                                                                                    ifelse(FallingRock.air.temp$year>=2011 & FallingRock.air.temp$year<=2015,9,
                                                                                    ifelse(FallingRock.air.temp$year>=2016 & FallingRock.air.temp$year<=2020,10,NA
                                          ))))))))))

air.temp.half.decs <- unique(FallingRock.air.temp$half.decade)
airtemp.half.dec <- matrix(nrow=length(air.temp.half.decs),ncol=4)
airtemp.half.dec <- data.frame(airtemp.half.dec)
colnames(airtemp.half.dec) <- c("Min","Mean","Max","HalfDec")
FallingRock.air.temp <- na.omit(FallingRock.air.temp)
  
for(i in 1:length(air.temp.half.decs)){
  airtemp.half.dec[i,1] <- min(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$half.decade==air.temp.half.decs[i])],na.rm = TRUE)
}

median.air.temp.min.halfdec <- data.frame(matrix(nrow=length(air.temp.half.decs),ncol=1))
for(i in 1:length(air.temp.half.decs)){
    median.air.temp.min.halfdec[i,1] <- median(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(median.air.temp.min.halfdec) <- c('median.airtemp')
median.air.temp.min.halfdec$halfdec <- air.temp.half.decs
median.air.temp.min.halfdec <- na.omit(median.air.temp.min.halfdec)
min.airtemp.senslope.halfdec <- sens.output(time.step=median.air.temp.min.halfdec$halfdec,data=median.air.temp.min.halfdec$median.airtemp)
min.airtemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(FallingRock.air.temp, aes(factor(half.decade), DailyMin_degF)) +
  geom_boxplot() +
  geom_abline(data=min.airtemp.senslope.halfdec, aes(intercept=intercept,slope=slope))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Minimum Half-Decadal Air Temperature Data")+
  xlab("Half-Decade")+
  ylab("Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))


#Yearly
#Calendar Year
air.temp.year <- unique(FallingRock.air.temp$year)
air.temp.year <- as.numeric(air.temp.year)
FallingRock.air.temp$year <- as.numeric(FallingRock.air.temp$year)
min.airtemp.year <- data.frame(matrix(nrow=length(air.temp.year),ncol=1))
for(i in 1:length(air.temp.year)){
  min.airtemp.year[i,1] <- min(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$year==air.temp.year[i])])
}

median.air.temp.min.years <- data.frame(matrix(nrow=length(air.temp.year),ncol=1))
for(i in 1:length(air.temp.year)){
    median.air.temp.min.years[i,1] <- median(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$year==air.temp.year[i])],na.rm=TRUE)
}

colnames(median.air.temp.min.years) <- c('median.airtemp')
median.air.temp.min.years$year <- air.temp.year
min.airtemp.senslope.year <- sens.output(time.step=median.air.temp.min.years$year,data=median.air.temp.min.years$median.airtemp)
min.airtemp.senslope.year$year <- "Calendar.Year"

#Water Year
air.temp.wateryear <- unique(FallingRock.air.temp$Water_Year)
min.airtemp.wateryear <- data.frame(matrix(nrow=length(air.temp.wateryear),ncol=1))
for(i in 1:length(air.temp.wateryear)){
  min.airtemp.wateryear[i,1] <- min(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$Water_Year==air.temp.wateryear[i])])
}

median.air.temp.min.wateryears <- data.frame(matrix(nrow=length(air.temp.wateryear),ncol=1))
for(i in 1:length(air.temp.wateryear)){
    median.air.temp.min.wateryears[i,1] <- median(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$Water_Year==air.temp.wateryear[i])],na.rm=TRUE)
}

colnames(median.air.temp.min.wateryears) <- c('median.airtemp')
median.air.temp.min.wateryears$Water_Year <- air.temp.wateryear
min.airtemp.senslope.wateryear <- sens.output(time.step=median.air.temp.min.wateryears$Water_Year,data=median.air.temp.min.wateryears$median.airtemp)
min.airtemp.senslope.wateryear$year <- "Water.Year"

#Climate Year
air.temp.climateyear <- unique(FallingRock.air.temp$Climate_Year)
min.airtemp.climateyear <- data.frame(matrix(nrow=length(air.temp.climateyear),ncol=1))
for(i in 1:length(air.temp.climateyear)){
  min.airtemp.climateyear[i,1] <- min(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$Climate_Year==air.temp.climateyear[i])])
}

median.air.temp.min.climateyears <- data.frame(matrix(nrow=length(air.temp.climateyear),ncol=1))
for(i in 1:length(air.temp.climateyear)){
    median.air.temp.min.climateyears[i,1] <- median(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$Climate_Year==air.temp.climateyear[i])],na.rm=TRUE)
}

colnames(median.air.temp.min.climateyears) <- c('median.airtemp')
median.air.temp.min.climateyears$Climate_Year <- air.temp.climateyear
min.airtemp.senslope.climateyear <- sens.output(time.step=median.air.temp.min.climateyears$Climate_Year,data=median.air.temp.min.climateyears$median.airtemp)
min.airtemp.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_mintemp.cal.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(year), DailyMin_degF)) +
  geom_boxplot() +
  geom_abline(data=min.airtemp.senslope.year, aes(intercept=40,slope=slope))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Minimum Yearly Air Temperature Data")+
  xlab("Year")+
  ylab("Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_mintemp.water.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(Water_Year), DailyMin_degF)) +
  geom_boxplot() +
  geom_abline(data=min.airtemp.senslope.wateryear, aes(intercept=40,slope=slope))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Minimum Yearly Air Temperature Data Using Water Year")+
  xlab("Year")+
  ylab("Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_mintemp.clim.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(Climate_Year), DailyMin_degF)) +
  geom_boxplot() +
  geom_abline(data=min.airtemp.senslope.climateyear, aes(intercept=40,slope=slope))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Minimum Yearly Air Temperature Data Using Climate Year")+
  xlab("Climate Year")+
  ylab("Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Seasonal
FallingRock.air.temp$season <- time2season(FallingRock.air.temp$Date.1,out.fmt="seasons")
air.temp.year <- unique(FallingRock.air.temp$year)
air.temp.season <- unique(FallingRock.air.temp$season)
seasons <- c("Winter","Spring","Summer","Autumn")
min.airtemp.season <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.season)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.season)){
    min.airtemp.season[i,j] <- min(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$season==air.temp.season[j])],na.rm=TRUE)
  }
  colnames(min.airtemp.season) <- seasons
}

median.air.temp.min.season <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.season)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.season)){
    median.air.temp.min.season[i,j] <- median(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$season==air.temp.season[j])],na.rm=TRUE)
  }
}
colnames(median.air.temp.min.season) <- seasons
median.air.temp.min.season$year <- air.temp.year
median.air.temp.min.season <- na.omit(median.air.temp.min.season)

min.airtemp.senslope.winter <- sens.output(time.step=median.air.temp.min.season$year,data=median.air.temp.min.season$Winter)
min.airtemp.senslope.spring <- sens.output(time.step=median.air.temp.min.season$year,data=median.air.temp.min.season$Spring)
min.airtemp.senslope.summer <- sens.output(time.step=median.air.temp.min.season$year,data=median.air.temp.min.season$Summer)
min.airtemp.senslope.autumn <- sens.output(time.step=median.air.temp.min.season$year,data=median.air.temp.min.season$Autumn)
min.airtemp.senslope.season <- rbind(min.airtemp.senslope.winter,min.airtemp.senslope.spring,min.airtemp.senslope.summer,min.airtemp.senslope.autumn)
min.airtemp.senslope.season$season <- unique(FallingRock.air.temp$season)

ggplot(FallingRock.air.temp, aes(factor(year), DailyMin_degF, fill=season)) +
  geom_boxplot() +
  geom_abline(data=min.airtemp.senslope.season,aes(slope=slope,intercept=intercept))+
  facet_wrap(~season)+
  geom_abline(data=min.airtemp.senslope.season,aes(intercept=40,slope=slope))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Minimum Seasonal Air Temperature Data")+
  xlab("Year")+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,85)+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))


#Monthly
air.temp.year <- unique(FallingRock.air.temp$year)
air.temp.month <- unique(FallingRock$month)
min.airtemp.month <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.month)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.month)){
    min.airtemp.month[i,j] <- min(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$month==air.temp.month[j])],na.rm=TRUE)
  }}

FallingRock.air.temp$month <- as.numeric(FallingRock.air.temp$month)
months.name <- c("January", "February", "March", "April", "May", "June","July", "August", "September", "October", "November", "December")
FallingRock.air.temp$Month <- months.name[FallingRock.air.temp$month]

median.air.temp.min.month <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.month)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(unique(FallingRock.air.temp$month))){
    median.air.temp.min.month[i,j] <- median(FallingRock.air.temp$DailyMin_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$month==air.temp.month[j])],na.rm=TRUE)
  }
}
colnames(median.air.temp.min.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
median.air.temp.min.month$year <- air.temp.year
median.air.temp.min.month <- na.omit(median.air.temp.min.month)

min.airtemp.senslope.jan <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$January)
min.airtemp.senslope.feb <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$February)
min.airtemp.senslope.mar <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$March)
min.airtemp.senslope.apr <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$April)
min.airtemp.senslope.may <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$May)
min.airtemp.senslope.jun <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$June)
min.airtemp.senslope.jul <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$July)
min.airtemp.senslope.aug <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$August)
min.airtemp.senslope.sep <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$September)
min.airtemp.senslope.oct <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$October)
min.airtemp.senslope.nov <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$November)
min.airtemp.senslope.dec <- sens.output(time.step=median.air.temp.min.month$year,data=median.air.temp.min.month$December)
min.airtemp.senslope.monthly <- rbind(min.airtemp.senslope.jan,min.airtemp.senslope.feb,min.airtemp.senslope.mar,min.airtemp.senslope.apr,min.airtemp.senslope.may,min.airtemp.senslope.jun,min.airtemp.senslope.jul,min.airtemp.senslope.aug,min.airtemp.senslope.sep,min.airtemp.senslope.oct,min.airtemp.senslope.nov,min.airtemp.senslope.dec)
min.airtemp.senslope.monthly$Month <- unique(FallingRock.air.temp$Month)

ggplot(FallingRock.air.temp, aes(factor(year), DailyMin_degF, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=min.airtemp.senslope.monthly,aes(slope=slope,intercept=40))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling ROck Minimum Monthly Air Temperature Data")+
  xlab("Year")+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,85)+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

```

##### Section 2.2.1.1: Minimum Air Temperature Statistical Summary
```{r}
FR.Min.Air.Temp.statistical.summary <- rbind.fill(min.airtemp.senslope.halfdec,min.airtemp.senslope.year,min.airtemp.senslope.wateryear,min.airtemp.senslope.climateyear,min.airtemp.senslope.season,min.airtemp.senslope.monthly)
```


#### Section 2.2.2: Mean Air Temperature
```{r}
#half decadal
for(i in 1:length(air.temp.half.decs)){
  airtemp.half.dec[i,2] <- mean(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$half.decade==air.temp.half.decs[i])],na.rm = TRUE)
}

median.air.temp.mean.halfdec <- data.frame(matrix(nrow=length(air.temp.half.decs),ncol=1))
for(i in 1:length(air.temp.half.decs)){
    median.air.temp.mean.halfdec[i,1] <- median(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(median.air.temp.mean.halfdec) <- c('median.airtemp')
median.air.temp.mean.halfdec$halfdec <- air.temp.half.decs
median.air.temp.mean.halfdec <- na.omit(median.air.temp.mean.halfdec)
mean.airtemp.senslope.halfdec <- sens.output(time.step=median.air.temp.mean.halfdec$halfdec,data=median.air.temp.mean.halfdec$median.airtemp)
mean.airtemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(FallingRock.air.temp, aes(factor(half.decade), DailyMean_degF)) +
  geom_boxplot() +
  geom_abline(data=mean.airtemp.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Mean Half-Decadal Air Temperature Data")+
  xlab("Half Decade")+
  ylab("Air Temperature (F)")

#Yearly
#Calendar Year
mean.airtemp.year <- data.frame(matrix(nrow=length(air.temp.year),ncol=1))

for(i in 1:length(air.temp.year)){
  mean.airtemp.year[i,1] <- mean(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$year==air.temp.year[i])],na.rm=TRUE)
}

median.air.temp.mean.year <- data.frame(matrix(nrow=length(air.temp.year),ncol=1))
for(i in 1:length(air.temp.year)){
    median.air.temp.mean.year[i,1] <- median(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$year==years[i])],na.rm=TRUE)
}

colnames(median.air.temp.mean.year) <- c('median.airtemp')
median.air.temp.mean.year$year <- air.temp.year
median.air.temp.mean.year <- na.omit(median.air.temp.mean.year)
mean.airtemp.senslope.year <- sens.output(time.step=median.air.temp.mean.year$year,data=median.air.temp.mean.year$median.airtemp)
mean.airtemp.senslope.year$year <- "Calendar.Year"

#Water Year
mean.airtemp.wateryear <- data.frame(matrix(nrow=length(air.temp.wateryear),ncol=1))

for(i in 1:length(air.temp.wateryear)){
  mean.airtemp.wateryear[i,1] <- mean(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$Water_Year==air.temp.wateryear[i])],na.rm=TRUE)
}

median.air.temp.mean.wateryear <- data.frame(matrix(nrow=length(air.temp.wateryear),ncol=1))
for(i in 1:length(air.temp.wateryear)){
    median.air.temp.mean.wateryear[i,1] <- median(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$Water_Year==years[i])],na.rm=TRUE)
}

colnames(median.air.temp.mean.wateryear) <- c('median.airtemp')
median.air.temp.mean.wateryear$Water_Year <- air.temp.wateryear
median.air.temp.mean.wateryear <- na.omit(median.air.temp.mean.wateryear)
mean.airtemp.senslope.wateryear <- sens.output(time.step=median.air.temp.mean.wateryear$Water_Year,data=median.air.temp.mean.wateryear$median.airtemp)
mean.airtemp.senslope.wateryear$year <- "Water.Year"

#Climate Year
mean.airtemp.climateyear <- data.frame(matrix(nrow=length(air.temp.climateyear),ncol=1))

for(i in 1:length(air.temp.climateyear)){
  mean.airtemp.climateyear[i,1] <- mean(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$Climate_Year==air.temp.climateyear[i])],na.rm=TRUE)
}

median.air.temp.mean.climateyear <- data.frame(matrix(nrow=length(air.temp.climateyear),ncol=1))
for(i in 1:length(air.temp.climateyear)){
    median.air.temp.mean.climateyear[i,1] <- median(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$Climate_Year==years[i])],na.rm=TRUE)
}

colnames(median.air.temp.mean.climateyear) <- c('median.airtemp')
median.air.temp.mean.climateyear$Climate_Year <- air.temp.climateyear
median.air.temp.mean.climateyear <- na.omit(median.air.temp.mean.climateyear)
mean.airtemp.senslope.climateyear <- sens.output(time.step=median.air.temp.mean.climateyear$Climate_Year,data=median.air.temp.mean.climateyear$median.airtemp)
mean.airtemp.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_meantemp.cal.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(year), DailyMean_degF)) +
  geom_boxplot() +
  geom_abline(data=mean.airtemp.senslope.year, aes(slope=slope, intercept=50))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,90)+
  ggtitle("Falling Rock Mean Annual Air Temperature Data")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_meantemp.water.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(Water_Year), DailyMean_degF)) +
  geom_boxplot() +
  geom_abline(data=mean.airtemp.senslope.wateryear, aes(slope=slope, intercept=50))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,90)+
  ggtitle("Falling Rock Mean Annual Air Temperature Data Using Water Year")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_meantemp.clim.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(Climate_Year), DailyMean_degF)) +
  geom_boxplot() +
  geom_abline(data=mean.airtemp.senslope.climateyear, aes(slope=slope, intercept=50))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,90)+
  ggtitle("Falling Rock Mean Annual Air Temperature Data Using Climate Year")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()


#Seasonal
mean.airtemp.season <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.season)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.season)){
    mean.airtemp.season[i,j] <- mean(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$season==air.temp.season[j])],na.rm=TRUE)
  }
    colnames(mean.airtemp.season) <- c("Winter","Spring","Summer","Autumn")
}
mean.airtemp.season$year <- air.temp.year
median.air.temp.mean.season <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.season)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.season)){
    median.air.temp.mean.season[i,j] <- median(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$season==air.temp.season[j])],na.rm=TRUE)
  }
}
colnames(median.air.temp.mean.season) <- seasons
median.air.temp.mean.season$year <- air.temp.year
median.air.temp.mean.season <- na.omit(median.air.temp.mean.season)

mean.airtemp.senslope.winter <- sens.output(time.step=median.air.temp.mean.season$year,data=median.air.temp.mean.season$Winter)
mean.airtemp.senslope.spring <- sens.output(time.step=median.air.temp.mean.season$year,data=median.air.temp.mean.season$Spring)
mean.airtemp.senslope.summer <- sens.output(time.step=median.air.temp.mean.season$year,data=median.air.temp.mean.season$Summer)
mean.airtemp.senslope.autumn <- sens.output(time.step=median.air.temp.mean.season$year,data=median.air.temp.mean.season$Autumn)
mean.airtemp.senslope.season <- rbind(mean.airtemp.senslope.winter,mean.airtemp.senslope.spring,mean.airtemp.senslope.summer,mean.airtemp.senslope.autumn)
mean.airtemp.senslope.season$season <- unique(FallingRock.air.temp$season)


ggplot(FallingRock.air.temp, aes(factor(year), DailyMean_degF, fill=season)) +
  geom_boxplot() +
  geom_abline(data=mean.airtemp.senslope.season, aes(slope=slope, intercept=50))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,90)+
  facet_wrap(~season)+
  ggtitle("Falling Rock Mean Seasonal Air Temperature Data")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Monthly
mean.airtemp.month <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.month)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.month)){
    mean.airtemp.month[i,j] <- mean(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$month==air.temp.month[j])],na.rm=TRUE)
  }}
FallingRock.air.temp$month <- as.numeric(FallingRock.air.temp$month)
months.name <- c("January", "February", "March", "April", "May", "June","July", "August", "September", "October", "November", "December")
FallingRock.air.temp$Month <- months.name[FallingRock.air.temp$month]

median.air.temp.mean.month <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.month)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.month)){
    median.air.temp.mean.month[i,j] <- median(FallingRock.air.temp$DailyMean_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$month==air.temp.month[j])],na.rm=TRUE)
  }
}
colnames(median.air.temp.mean.month) <- unique(FallingRock.air.temp$Month)
median.air.temp.mean.month$year <- air.temp.year

median.air.temp.mean.month <- na.omit(median.air.temp.mean.month)
mean.airtemp.senslope.jan <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$January)
mean.airtemp.senslope.feb <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$February)
mean.airtemp.senslope.mar <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$March)
mean.airtemp.senslope.apr <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$April)
mean.airtemp.senslope.may <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$May)
mean.airtemp.senslope.jun <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$June)
mean.airtemp.senslope.jul <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$July)
mean.airtemp.senslope.aug <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$August)
mean.airtemp.senslope.sep <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$September)
mean.airtemp.senslope.oct <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$October)
mean.airtemp.senslope.nov <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$November)
mean.airtemp.senslope.dec <- sens.output(time.step=median.air.temp.mean.month$year,data=median.air.temp.mean.month$December)
mean.airtemp.senslope.monthly <- rbind(mean.airtemp.senslope.jan,mean.airtemp.senslope.feb,mean.airtemp.senslope.mar,mean.airtemp.senslope.apr,mean.airtemp.senslope.may,mean.airtemp.senslope.jun,mean.airtemp.senslope.jul,mean.airtemp.senslope.aug,mean.airtemp.senslope.sep,mean.airtemp.senslope.oct,mean.airtemp.senslope.nov,mean.airtemp.senslope.dec)
mean.airtemp.senslope.monthly$Month <- unique(FallingRock.air.temp$Month)


ggplot(FallingRock.air.temp, aes(factor(year), DailyMean_degF, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=mean.airtemp.senslope.monthly, aes(slope=slope, intercept=50))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,90)+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Mean Monthly Air Temperature Data")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
```

##### Section 2.2.2.1: Mean Air Temperature Statistical Summary
```{r}
FR.Mean.Air.Temp.statistical.summary <- rbind.fill(mean.airtemp.senslope.halfdec,mean.airtemp.senslope.year,mean.airtemp.senslope.wateryear,mean.airtemp.senslope.climateyear,mean.airtemp.senslope.season,mean.airtemp.senslope.monthly)
```


####Section 2.2.3: Maximum Air Temperature
```{r}
#1/2 Decadal
for(i in 1:length(air.temp.half.decs)){
  airtemp.half.dec[i,3] <- max(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$half.decade==air.temp.half.decs[i])],na.rm = TRUE)
}
airtemp.half.dec$HalfDec <- (1:8)

median.air.temp.max.halfdec <- data.frame(matrix(nrow=length(air.temp.half.decs),ncol=1))
for(i in 1:length(air.temp.half.decs)){
    median.air.temp.max.halfdec[i,1] <- median(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(median.air.temp.max.halfdec) <- c('median.airtemp')
median.air.temp.max.halfdec$halfdec <- air.temp.half.decs
median.air.temp.max.halfdec <- na.omit(median.air.temp.max.halfdec)
max.airtemp.senslope.halfdec <- sens.output(time.step=median.air.temp.max.halfdec$halfdec,data=median.air.temp.max.halfdec$median.airtemp)
max.airtemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(FallingRock.air.temp, aes(factor(half.decade), DailyMax_degF)) +
  geom_boxplot() +
  geom_abline(data=max.airtemp.senslope.halfdec,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling ROck Maximum Half-Decadal Air Temperature Data")+
  xlab("Half Decade")+
  ylab("Air Temperature (F)")

#Yearly
#Calendar Year
max.airtemp.year <- data.frame(matrix(nrow=length(air.temp.year),ncol=1))
for(i in 1:length(air.temp.year)){
  max.airtemp.year[i,1] <- max(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$year==air.temp.year[i])])
}

median.air.temp.max.year <- data.frame(matrix(nrow=length(air.temp.year),ncol=1))
for(i in 1:length(air.temp.year)){
    median.air.temp.max.year[i,1] <- median(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$year==years[i])],na.rm=TRUE)
}

colnames(median.air.temp.max.year) <- c('median.airtemp')
median.air.temp.max.year$year <- air.temp.year
median.air.temp.max.year <- na.omit(median.air.temp.max.year)
max.airtemp.senslope.year <- sens.output(time.step=median.air.temp.max.year$year,data=median.air.temp.max.year$median.airtemp)
max.airtemp.senslope.year$year <- "Calendar.Year"

#Water Year
max.airtemp.wateryear <- data.frame(matrix(nrow=length(air.temp.wateryear),ncol=1))
for(i in 1:length(air.temp.wateryear)){
  max.airtemp.wateryear[i,1] <- max(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$Water_Year==air.temp.wateryear[i])])
}

median.air.temp.max.wateryear <- data.frame(matrix(nrow=length(air.temp.wateryear),ncol=1))
for(i in 1:length(air.temp.wateryear)){
    median.air.temp.max.wateryear[i,1] <- median(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$Water_Year==years[i])],na.rm=TRUE)
}

colnames(median.air.temp.max.wateryear) <- c('median.airtemp')
median.air.temp.max.wateryear$Water_Year <- air.temp.wateryear
median.air.temp.max.wateryear <- na.omit(median.air.temp.max.wateryear)
max.airtemp.senslope.wateryear <- sens.output(time.step=median.air.temp.max.wateryear$Water_Year,data=median.air.temp.max.wateryear$median.airtemp)
max.airtemp.senslope.wateryear$year <- "Water.Year"

#Climate Year
max.airtemp.climateyear <- data.frame(matrix(nrow=length(air.temp.climateyear),ncol=1))
for(i in 1:length(air.temp.climateyear)){
  max.airtemp.climateyear[i,1] <- max(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$Climate_Year==air.temp.climateyear[i])])
}

median.air.temp.max.climateyear <- data.frame(matrix(nrow=length(air.temp.climateyear),ncol=1))
for(i in 1:length(air.temp.climateyear)){
    median.air.temp.max.climateyear[i,1] <- median(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$Climate_Year==years[i])],na.rm=TRUE)
}

colnames(median.air.temp.max.climateyear) <- c('median.airtemp')
median.air.temp.max.climateyear$Climate_Year <- air.temp.climateyear
median.air.temp.max.climateyear <- na.omit(median.air.temp.max.climateyear)
max.airtemp.senslope.climateyear <- sens.output(time.step=median.air.temp.max.climateyear$Climate_Year,data=median.air.temp.max.climateyear$median.airtemp)
max.airtemp.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_maxtemp.cal.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(year), DailyMax_degF)) +
  geom_boxplot() +
  geom_abline(data=max.airtemp.senslope.year,aes(slope=slope,intercept=70))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,110)+
  ggtitle("Falling Rock Maximum Annual Air Temperature Data")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_maxtemp.water.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(Water_Year), DailyMax_degF)) +
  geom_boxplot() +
  geom_abline(data=max.airtemp.senslope.wateryear,aes(slope=slope,intercept=70))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,110)+
  ggtitle("Falling Rock Maximum Annual Air Temperature Data Using Water Year")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_maxtemp.clim.jpeg", width=1000)
ggplot(FallingRock.air.temp, aes(factor(Climate_Year), DailyMax_degF)) +
  geom_boxplot() +
  geom_abline(data=max.airtemp.senslope.climateyear,aes(slope=slope,intercept=70))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,110)+
  ggtitle("Falling Rock Maximum Annual Air Temperature Data Using Climate Year")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Seasonal
max.airtemp.season <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.season)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.season)){
    max.airtemp.season[i,j] <- max(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$season==air.temp.season[j])],na.rm=TRUE)
  }
    colnames(max.airtemp.season) <- c("Winter","Spring","Summer","Autumn")
}
max.airtemp.season$year <- unique(FallingRock.air.temp$year)
median.air.temp.max.season <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.season)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.season)){
    median.air.temp.max.season[i,j] <- median(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$season==air.temp.season[j])],na.rm=TRUE)
  }
}
colnames(median.air.temp.max.season) <- seasons
median.air.temp.max.season$year <- air.temp.year
median.air.temp.max.season <- na.omit(median.air.temp.max.season)

max.airtemp.senslope.winter <- sens.output(time.step=median.air.temp.max.season$year,data=median.air.temp.max.season$Winter)
max.airtemp.senslope.spring <- sens.output(time.step=median.air.temp.max.season$year,data=median.air.temp.max.season$Spring)
max.airtemp.senslope.summer <- sens.output(time.step=median.air.temp.max.season$year,data=median.air.temp.max.season$Summer)
max.airtemp.senslope.autumn <- sens.output(time.step=median.air.temp.mean.season$year,data=median.air.temp.max.season$Autumn)
max.airtemp.senslope.season <- rbind(max.airtemp.senslope.winter,max.airtemp.senslope.spring,max.airtemp.senslope.summer,max.airtemp.senslope.autumn)
max.airtemp.senslope.season$season <- unique(FallingRock.air.temp$season)


ggplot(FallingRock.air.temp, aes(factor(year), DailyMax_degF, fill=season)) +
  geom_boxplot() +
  geom_abline(data=max.airtemp.senslope.season,aes(slope=slope,intercept=70))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,110)+
  facet_wrap(~season)+
  ggtitle("Falling Rock Maximum Seasonal Air Temperature Data")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Monthly
max.airtemp.month <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.month)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.month)){
    max.airtemp.month[i,j] <- max(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$month==air.temp.month[j])],na.rm=TRUE)
  }}

median.air.temp.max.month <- data.frame(matrix(nrow=length(air.temp.year),ncol=length(air.temp.month)))
for(i in 1:length(air.temp.year)){
  for(j in 1:length(air.temp.month)){
    median.air.temp.max.month[i,j] <- median(FallingRock.air.temp$DailyMax_degF[which(FallingRock.air.temp$year==air.temp.year[i]&FallingRock.air.temp$month==air.temp.month[j])],na.rm=TRUE)
  }
}
colnames(median.air.temp.max.month) <- unique(FallingRock.air.temp$Month)
median.air.temp.max.month$year <- air.temp.year

median.air.temp.max.month <- na.omit(median.air.temp.max.month)
max.airtemp.senslope.jan <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$January)
max.airtemp.senslope.feb <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$February)
max.airtemp.senslope.mar <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$March)
max.airtemp.senslope.apr <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$April)
max.airtemp.senslope.may <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$May)
max.airtemp.senslope.jun <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$June)
max.airtemp.senslope.jul <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$July)
max.airtemp.senslope.aug <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$August)
max.airtemp.senslope.sep <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$September)
max.airtemp.senslope.oct <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$October)
max.airtemp.senslope.nov <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$November)
max.airtemp.senslope.dec <- sens.output(time.step=median.air.temp.max.month$year,data=median.air.temp.max.month$December)
max.airtemp.senslope.monthly <- rbind(max.airtemp.senslope.jan,max.airtemp.senslope.feb,max.airtemp.senslope.mar,max.airtemp.senslope.apr,max.airtemp.senslope.may,max.airtemp.senslope.jun,max.airtemp.senslope.jul,max.airtemp.senslope.aug,max.airtemp.senslope.sep,max.airtemp.senslope.oct,max.airtemp.senslope.nov,max.airtemp.senslope.dec)
max.airtemp.senslope.monthly$Month <- unique(FallingRock.air.temp$Month)


ggplot(FallingRock.air.temp, aes(factor(year), DailyMax_degF, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=max.airtemp.senslope.monthly,aes(slope=slope,intercept=70))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,110)+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Maximum Monthly Air Temperature Data")+
  xlab("Year")+
  ylab("Air Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
```

##### Section 2.2.3.1: Maximum Air Temperature Statistical Summary
```{r}
FR.Max.Air.Temp.statistical.summary <- rbind.fill(max.airtemp.senslope.halfdec,max.airtemp.senslope.year,max.airtemp.senslope.wateryear,max.airtemp.senslope.climateyear,max.airtemp.senslope.season,max.airtemp.senslope.monthly)
```


#Section 3: Stream Variables
##Section 3.1: Minimum Flow
```{r}
#Entire Time Series (Daily)
FallingRock$min.discharge.nozero <- FallingRock$mindaily_CFS+0.0001
FallingRock$year <- as.numeric(FallingRock$year)

ggplot(data=FallingRock, aes(x=Date.1, y=min.discharge.nozero))+
  geom_line()+
  scale_y_log10()+
  ggtitle("Minimum Daily Discharge at Falling Rock (Log Scale)")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

FallingRock$min.discharge.nozero <- FallingRock$mindaily_CFS+0.0001
ggplot(data=FallingRock, aes(x=Date.1, y=mindaily_CFS))+
  geom_line()+
  ggtitle("Minimum Daily Discahrge at Falling Rock")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#1/2 Decade
discharge.half.dec <- unique(FallingRock$half.decade)
min.discharge.half.dec <- data.frame(matrix(nrow=length(discharge.half.dec),ncol=1))
for(i in 1:length(discharge.half.dec)){
  min.discharge.half.dec[i,1] <- min(FallingRock$mindaily_CFS[which(FallingRock$half.decade==discharge.half.dec[i])],na.rm=TRUE)
}


min.discharge.half.dec$halfdec <- unique(FallingRock$half.decade)
min.discharge.half.dec$no.zero <- min.discharge.half.dec$matrix.nrow...length.discharge.half.dec...ncol...1.+0.0001

min.discharge.min.halfdec <- data.frame(matrix(nrow=length(unique(FallingRock$half.decade)),ncol=1))
for(i in 1:length(unique(FallingRock$half.decade))){
    min.discharge.min.halfdec[i,1] <- min(FallingRock$mindaily_CFS[which(FallingRock$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(min.discharge.min.halfdec) <- c('min.discharge.min')
min.discharge.min.halfdec$halfdec <- half.decades[1:8]
min.discharge.min.halfdec <- na.omit(min.discharge.min.halfdec)
min.discharge.senslope.halfdec <- sens.output(time.step=min.discharge.min.halfdec$halfdec,data=min.discharge.min.halfdec$min.discharge.min)
min.discharge.senslope.halfdec$half.decade <- "Half.Decade"

min.discharge.min.halfdec.nozero <- data.frame(matrix(nrow=length(unique(FallingRock$half.decade)),ncol=1))
for(i in 1:length(unique(FallingRock$half.decade))){
    min.discharge.min.halfdec.nozero[i,1] <- min(FallingRock$min.discharge.nozero[which(FallingRock$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(min.discharge.min.halfdec.nozero) <- c('min.discharge.min')
min.discharge.min.halfdec.nozero$halfdec <- half.decades[1:8]
min.discharge.nozero.senslope.halfdec <- sens.output(time.step=min.discharge.min.halfdec.nozero$halfdec,data=log(min.discharge.min.halfdec.nozero$min.discharge.min))
min.discharge.nozero.senslope.halfdec$half.decade <- "Half.Decade"


ggplot(FallingRock, aes(factor(half.decade), min.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.nozero.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_y_log10()+
  ggtitle("Falling Rock Minimum Half-Decadal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))


ggplot(FallingRock, aes(factor(half.decade), mindaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Minimum Half-Decadal Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Yearly
#Calendar Year
discharge.year <- as.numeric(unique(FallingRock$year))
min.discharge.year <- data.frame(matrix(nrow=length(discharge.year),ncol=1))
for(i in 1:length(discharge.year)){
  min.discharge.year[i,1] <- min(FallingRock$mindaily_CFS[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

min.discharge.year$year <- unique(FallingRock$year)
min.discharge.min.year <- data.frame(matrix((nrow=length(discharge.year)),ncol=1))
for(i in 1:length(unique(FallingRock$year))){
    min.discharge.min.year[i,1] <- min(FallingRock$mindaily_CFS[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

colnames(min.discharge.min.year) <- c('min.discharge.min')
min.discharge.min.year$year <- discharge.year
min.discharge.min.year <- na.omit(min.discharge.min.year)
min.discharge.senslope.year <- sens.output(time.step=min.discharge.min.year$year,data=min.discharge.min.year$min.discharge.min)
min.discharge.senslope.year$year <- "Calendar.Year"

min.discharge.min.year.nozero <- data.frame(matrix((nrow=length(discharge.year)),ncol=1))
for(i in 1:length(unique(FallingRock$year))){
    min.discharge.min.year.nozero[i,1] <- min(FallingRock$min.discharge.nozero[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

colnames(min.discharge.min.year.nozero) <- c('min.discharge.min')
min.discharge.min.year.nozero$year <- as.numeric(discharge.year)
min.discharge.min.year.nozero <- na.omit(min.discharge.min.year.nozero)
min.discharge.senslope.year.nozero <- sens.output(time.step=min.discharge.min.year.nozero$year,data=log(min.discharge.min.year.nozero$min.discharge.min))
min.discharge.senslope.year.nozero$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_minflow.cal.jpeg", width=1000)
ggplot(FallingRock, aes(factor(year), min.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.year.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Minimum Annual Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(year), mindaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.year,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling Rock Minimum Annual Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Water Year
discharge.wateryear <- unique(FallingRock$Water_Year)
min.discharge.wateryear <- data.frame(matrix(nrow=length(discharge.wateryear),ncol=1))
for(i in 1:length(discharge.wateryear)){
  min.discharge.wateryear[i,1] <- min(FallingRock$mindaily_CFS[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

min.discharge.wateryear$Water_Year <- unique(FallingRock$Water_Year)
min.discharge.min.wateryear <- data.frame(matrix((nrow=length(min.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(FallingRock$Water_Year))){
    min.discharge.min.wateryear[i,1] <- min(FallingRock$mindaily_CFS[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

colnames(min.discharge.min.wateryear) <- c('min.discharge.min')
min.discharge.min.wateryear$Water_Year <- discharge.wateryear
min.discharge.min.wateryear <- na.omit(min.discharge.min.wateryear)
min.discharge.senslope.wateryear <- sens.output(time.step=min.discharge.min.wateryear$Water_Year,data=min.discharge.min.wateryear$min.discharge.min)
min.discharge.senslope.wateryear$year <- "Water.Year"

min.discharge.min.wateryear.nozero <- data.frame(matrix((nrow=length(discharge.wateryear)),ncol=1))
for(i in 1:length(unique(FallingRock$Water_Year))){
    min.discharge.min.wateryear.nozero[i,1] <- min(FallingRock$min.discharge.nozero[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

colnames(min.discharge.min.wateryear.nozero) <- c('min.discharge.min')
min.discharge.min.wateryear.nozero$Water_Year <- discharge.wateryear
min.discharge.min.wateryear.nozero <- na.omit(min.discharge.min.wateryear.nozero)
min.discharge.senslope.wateryear.nozero <- sens.output(time.step=min.discharge.min.wateryear.nozero$Water_Year,data=log(min.discharge.min.wateryear.nozero$min.discharge.min))
min.discharge.senslope.wateryear.nozero$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_minflow.water.jpeg", width=1000)
ggplot(FallingRock, aes(factor(Water_Year), min.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Minimum Annual Discharge (Log Scale) Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(Water_Year), mindaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.wateryear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling ROck Minimum Annual Discharge Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Climate Year
discharge.climateyear <- unique(FallingRock$Water_Year)
min.discharge.climateyear <- data.frame(matrix(nrow=length(discharge.climateyear),ncol=1))
for(i in 1:length(discharge.climateyear)){
  min.discharge.climateyear[i,1] <- min(FallingRock$mindaily_CFS[which(FallingRock$Water_Year==discharge.climateyear[i])],na.rm=TRUE)
}

min.discharge.climateyear$Water_Year <- unique(FallingRock$Water_Year)
min.discharge.min.climateyear <- data.frame(matrix((nrow=length(min.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(FallingRock$Water_Year))){
    min.discharge.min.climateyear[i,1] <- min(FallingRock$mindaily_CFS[which(FallingRock$Water_Year==discharge.climateyear[i])],na.rm=TRUE)
}

colnames(min.discharge.min.climateyear) <- c('min.discharge.min')
min.discharge.min.climateyear$Water_Year <- discharge.climateyear
min.discharge.min.climateyear <- na.omit(min.discharge.min.climateyear)
min.discharge.senslope.climateyear <- sens.output(time.step=min.discharge.min.climateyear$Water_Year,data=min.discharge.min.climateyear$min.discharge.min)
min.discharge.senslope.climateyear$year <- "Climate.Year"

min.discharge.min.climateyear.nozero <- data.frame(matrix((nrow=length(discharge.climateyear)),ncol=1))
for(i in 1:length(unique(FallingRock$Water_Year))){
    min.discharge.min.climateyear.nozero[i,1] <- min(FallingRock$min.discharge.nozero[which(FallingRock$Water_Year==discharge.climateyear[i])],na.rm=TRUE)
}

colnames(min.discharge.min.climateyear.nozero) <- c('min.discharge.min')
min.discharge.min.climateyear.nozero$Water_Year <- discharge.climateyear
min.discharge.min.climateyear.nozero <- na.omit(min.discharge.min.climateyear.nozero)
min.discharge.senslope.climateyear.nozero <- sens.output(time.step=min.discharge.min.climateyear.nozero$Water_Year,data=log(min.discharge.min.climateyear.nozero$min.discharge.min))
min.discharge.senslope.climateyear.nozero$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_minflow.clim.jpeg", width=1000)
ggplot(FallingRock, aes(factor(Water_Year), min.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.climateyear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Minimum Annual Discharge (Log Scale) Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(Water_Year), mindaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.climateyear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling Rock Minimum Annual Discharge Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
FallingRock$season <- time2season(FallingRock$Date.1,out.fmt="seasons")
discharge.season <- unique(FallingRock$season)
min.discharge.season <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.season)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    min.discharge.season[i,j] <- min(FallingRock$mindaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])],na.rm=TRUE)
  }
  colnames(min.discharge.season) <- c("Summer","Autumn","Winter","Spring")
}
min.discharge.season$year <- unique(FallingRock$year)

min.discharge.min.season <- data.frame(matrix(nrow=length(discharge.year),ncol=length(seasons)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    min.discharge.min.season[i,j] <- min(FallingRock$mindaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])],na.rm=TRUE)
  }
}
colnames(min.discharge.min.season) <- seasons
min.discharge.min.season$year <- discharge.year
min.discharge.senslope.winter <- sens.output(time.step=min.discharge.min.season$year,data=min.discharge.min.season$Winter)
min.discharge.senslope.spring <- sens.output(time.step=min.discharge.min.season$year,data=min.discharge.min.season$Spring)
min.discharge.senslope.summer <- sens.output(time.step=min.discharge.min.season$year,data=min.discharge.min.season$Summer)
min.discharge.senslope.autumn <- sens.output(time.step=min.discharge.min.season$year,data=min.discharge.min.season$Autumn)
min.discharge.senslope.season <- rbind(min.discharge.senslope.winter,min.discharge.senslope.spring,min.discharge.senslope.summer,min.discharge.senslope.autumn)
min.discharge.senslope.season$season <- unique(FallingRock.air.temp$season)

min.discharge.min.season.nozero <- data.frame(matrix(nrow=length(discharge.year),ncol=length(seasons)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    min.discharge.min.season.nozero[i,j] <- min(FallingRock$min.discharge.nozero[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])],na.rm=TRUE)
  }
}
colnames(min.discharge.min.season.nozero) <- seasons
min.discharge.min.season.nozero$year <- discharge.year
min.discharge.senslope.winter.nozero <- sens.output(time.step=min.discharge.min.season.nozero$year,data=log(min.discharge.min.season.nozero$Winter))
min.discharge.senslope.spring.nozero <- sens.output(time.step=min.discharge.min.season.nozero$year,data=log(min.discharge.min.season.nozero$Spring))
min.discharge.senslope.summer.nozero <- sens.output(time.step=min.discharge.min.season.nozero$year,data=log(min.discharge.min.season.nozero$Summer))
min.discharge.senslope.autumn.nozero <- sens.output(time.step=min.discharge.min.season.nozero$year,data=log(min.discharge.min.season.nozero$Autumn))
min.discharge.senslope.season.nozero <- rbind(min.discharge.senslope.winter.nozero,min.discharge.senslope.spring.nozero,min.discharge.senslope.summer.nozero,min.discharge.senslope.autumn.nozero)
min.discharge.senslope.season.nozero$season <- unique(FallingRock.air.temp$season)


ggplot(FallingRock, aes(factor(year), min.discharge.nozero, fill=season)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.season.nozero,aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0.0001,100)+
  scale_y_log10()+
  facet_wrap(~season)+
  ggtitle("Falling Rock Minimum Seasonal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(FallingRock, aes(factor(year), mindaily_CFS, fill=season)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.season,aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,10)+
  facet_wrap(~season)+
  ggtitle("Falling Rock Minimum Seasonal Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Monthly
discharge.month <- unique(FallingRock$month)
min.discharge.month <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    min.discharge.month[i,j] <- min(FallingRock$mindaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }
  colnames(min.discharge.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
}
FallingRock$month <- as.numeric(FallingRock$month)
min.discharge.month$year <- unique(FallingRock$year)
FallingRock$Month <- months.name[FallingRock$month]

min.discharge.min.month <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    min.discharge.min.month[i,j] <- min(FallingRock$mindaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(min.discharge.min.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
min.discharge.min.month$year <- discharge.year
min.discharge.min.month$March[35] <- NA
min.discharge.min.month <- na.omit(min.discharge.min.month)

min.discharge.senslope.jan <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$January)
min.discharge.senslope.feb <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$February)
min.discharge.senslope.mar <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$March)
min.discharge.senslope.apr <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$April)
min.discharge.senslope.may <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$May)
min.discharge.senslope.jun <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$June)
min.discharge.senslope.jul <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$July)
min.discharge.senslope.aug <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$August)
min.discharge.senslope.sep <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$September)
min.discharge.senslope.oct <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$October)
min.discharge.senslope.nov <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$November)
min.discharge.senslope.dec <- sens.output(time.step=min.discharge.min.month$year,data=min.discharge.min.month$December)
min.discharge.senslope.month <- rbind(min.discharge.senslope.jan,min.discharge.senslope.feb,min.discharge.senslope.mar,min.discharge.senslope.apr,min.discharge.senslope.may,min.discharge.senslope.jun,min.discharge.senslope.jul,min.discharge.senslope.aug,min.discharge.senslope.sep,min.discharge.senslope.oct,min.discharge.senslope.nov,min.discharge.senslope.dec)
min.discharge.senslope.month$Month <- unique(FallingRock$Month)

min.discharge.min.month.nozero <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    min.discharge.min.month.nozero[i,j] <- min(FallingRock$min.discharge.nozero[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(min.discharge.min.month.nozero) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
min.discharge.min.month.nozero$year <- discharge.year
min.discharge.min.month.nozero$March[35] <- NA
min.discharge.min.month.nozero <- na.omit(min.discharge.min.month.nozero)

min.discharge.senslope.jan.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$January))
min.discharge.senslope.feb.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$February))
min.discharge.senslope.mar.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$March))
min.discharge.senslope.apr.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$April))
min.discharge.senslope.may.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$May))
min.discharge.senslope.jun.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$June))
min.discharge.senslope.jul.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$July))
min.discharge.senslope.aug.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$August))
min.discharge.senslope.sep.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$September))
min.discharge.senslope.oct.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$October))
min.discharge.senslope.nov.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$November))
min.discharge.senslope.dec.nozero <- sens.output(time.step=min.discharge.min.month.nozero$year,data=log(min.discharge.min.month.nozero$December))
min.discharge.senslope.month.nozero <- rbind(min.discharge.senslope.jan.nozero,min.discharge.senslope.feb.nozero,min.discharge.senslope.mar.nozero,min.discharge.senslope.apr.nozero,min.discharge.senslope.may.nozero,min.discharge.senslope.jun.nozero,min.discharge.senslope.jul.nozero,min.discharge.senslope.aug.nozero,min.discharge.senslope.sep.nozero,min.discharge.senslope.oct.nozero,min.discharge.senslope.nov.nozero,min.discharge.senslope.dec.nozero)
min.discharge.senslope.month.nozero$Month <- unique(FallingRock$Month)

ggplot(FallingRock, aes(factor(year), min.discharge.nozero, fill=month)) +
  geom_boxplot() +
  geom_abline(data=min.discharge.senslope.month.nozero,aes(slope=slope,intercept=0.01))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ylim(0,100)+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Minimum Monthly Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(FallingRock, aes(factor(year), mindaily_CFS, fill=month)) +
  geom_boxplot()+
  geom_abline(data=min.discharge.senslope.month,aes(slope=slope, intercept=0.01))+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,15)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Minimum Monthly Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

```

### Section 3.1.1: Minimum Flow Statistical Summary
```{r}
FR.Min.Flow.statistical.summary <- rbind.fill(min.discharge.senslope.halfdec,min.discharge.senslope.year,min.discharge.senslope.wateryear,min.discharge.senslope.climateyear,min.discharge.senslope.season,min.discharge.senslope.month)

FR.Min.Flow.Nozero.statistical.summary <- rbind.fill(min.discharge.nozero.senslope.halfdec,min.discharge.senslope.year.nozero,min.discharge.senslope.wateryear.nozero,min.discharge.senslope.climateyear.nozero,min.discharge.senslope.season.nozero,min.discharge.senslope.month.nozero)
```


##Section 3.2: Mean Flow
```{r}
#Entire Time Series (daily)
FallingRock$mean.discharge.nozero <- FallingRock$meandaily_CFS+0.0001
ggplot(data=FallingRock, aes(x=Date.1, y=mean.discharge.nozero))+
  geom_line()+
  scale_y_log10()+
  ggtitle("Falling Rock Mean Daily Discharge (Log Scale)")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(data=FallingRock, aes(x=Date.1, y=meandaily_CFS))+
  geom_line()+
  ggtitle("Falling Rock Mean Daily Discharge")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#plotting mean daily flow over the entire time series 

#1/2 Decade
mean.discharge.half.dec <- data.frame(matrix(nrow=length(discharge.half.dec),ncol=1))
for(i in 1:length(discharge.half.dec)){
  mean.discharge.half.dec[i,1] <- mean(FallingRock$meandaily_CFS[which(FallingRock$half.decade==discharge.half.dec[i])],na.rm=TRUE)
}

median.discharge.mean.halfdec <- data.frame(matrix(nrow=length(unique(FallingRock$half.decade)),ncol=1))
for(i in 1:length(unique(FallingRock$half.decade))){
    median.discharge.mean.halfdec[i,1] <- median(FallingRock$meandaily_CFS[which(FallingRock$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(median.discharge.mean.halfdec) <- c('median.discharge.mean')
median.discharge.mean.halfdec$halfdec <- half.decades
median.discharge.mean.halfdec <- na.omit(median.discharge.mean.halfdec)
mean.discharge.senslope.halfdec <- sens.output(time.step=median.discharge.mean.halfdec$halfdec,data=median.discharge.mean.halfdec$median.discharge.mean)
mean.discharge.senslope.halfdec$half.decade <- "Half.Decade"

median.discharge.mean.halfdec.nozero <- data.frame(matrix(nrow=length(unique(FallingRock$half.decade)),ncol=1))
for(i in 1:length(unique(FallingRock$half.decade))){
    median.discharge.mean.halfdec.nozero[i,1] <- median(FallingRock$mean.discharge.nozero[which(FallingRock$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(median.discharge.mean.halfdec.nozero) <- c('median.discharge.mean')
median.discharge.mean.halfdec.nozero$halfdec <- half.decades
mean.discharge.senslope.halfdec.nozero <- sens.output(time.step=median.discharge.mean.halfdec.nozero$halfdec,data=median.discharge.mean.halfdec.nozero$median.discharge.mean)
mean.discharge.senslope.halfdec.nozero$half.decade <- "Half.Decade"

ggplot(FallingRock, aes(factor(half.decade), mean.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_y_log10()+
  ggtitle("Falling Rock Mean Half-Decadal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))


ggplot(FallingRock, aes(factor(half.decade), meandaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.halfdec.nozero, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Mean Half-Decadal Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Yearly
mean.discharge.year <- data.frame(matrix(nrow=length(discharge.year),ncol=1))
for(i in 1:length(discharge.year)){
  mean.discharge.year[i,1] <- mean(FallingRock$meandaily_CFS[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

mean.discharge.year$year <- unique(FallingRock$year)
median.discharge.mean.year <- data.frame(matrix((nrow=length(mean.discharge.year)),ncol=1))
for(i in 1:length(unique(FallingRock$year))){
    median.discharge.mean.year[i,1] <- median(FallingRock$meandaily_CFS[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

colnames(median.discharge.mean.year) <- c('median.discharge.mean')
median.discharge.mean.year$year <- discharge.year
median.discharge.mean.year <- na.omit(median.discharge.mean.year)
mean.discharge.senslope.year <- sens.output(time.step=median.discharge.mean.year$year,data=median.discharge.mean.year$median.discharge.mean)
mean.discharge.senslope.year$year <- "Calendar.Year"

median.discharge.mean.year.nozero <- data.frame(matrix((nrow=length(discharge.year)),ncol=1))
for(i in 1:length(unique(FallingRock$year))){
    median.discharge.mean.year.nozero[i,1] <- median(FallingRock$mean.discharge.nozero[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

colnames(median.discharge.mean.year.nozero) <- c('median.discharge.mean')
median.discharge.mean.year.nozero$year <- discharge.year
median.discharge.mean.year.nozero <- na.omit(median.discharge.mean.year.nozero)
mean.discharge.senslope.year.nozero <- sens.output(time.step=median.discharge.mean.year.nozero$year,data=median.discharge.mean.year.nozero$median.discharge.mean)
mean.discharge.senslope.year.nozero$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_meanflow.cal.jpeg", width=1000)
ggplot(FallingRock, aes(factor(year), mean.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Mean Annual Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(year), meandaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.year.nozero, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling Rock Mean Annual Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Water Year
discharge.wateryear <- unique(FallingRock$Water_Year)
mean.discharge.wateryear <- data.frame(matrix(nrow=length(discharge.wateryear),ncol=1))
for(i in 1:length(discharge.wateryear)){
  mean.discharge.wateryear[i,1] <- mean(FallingRock$meandaily_CFS[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

mean.discharge.wateryear$Water_Year <- unique(FallingRock$Water_Year)
mean.discharge.mean.wateryear <- data.frame(matrix((nrow=length(mean.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(FallingRock$Water_Year))){
    mean.discharge.mean.wateryear[i,1] <- mean(FallingRock$meandaily_CFS[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

colnames(mean.discharge.mean.wateryear) <- c('mean.discharge.mean')
mean.discharge.mean.wateryear$Water_Year <- discharge.wateryear
mean.discharge.mean.wateryear <- na.omit(mean.discharge.mean.wateryear)
mean.discharge.senslope.wateryear <- sens.output(time.step=mean.discharge.mean.wateryear$Water_Year,data=mean.discharge.mean.wateryear$mean.discharge.mean)
mean.discharge.senslope.wateryear$year <- "Water.Year"

mean.discharge.mean.wateryear.nozero <- data.frame(matrix((nrow=length(discharge.wateryear)),ncol=1))
for(i in 1:length(unique(FallingRock$Water_Year))){
    mean.discharge.mean.wateryear.nozero[i,1] <- mean(FallingRock$mean.discharge.nozero[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

colnames(mean.discharge.mean.wateryear.nozero) <- c('mean.discharge.mean')
mean.discharge.mean.wateryear.nozero$Water_Year <- discharge.wateryear
mean.discharge.mean.wateryear.nozero <- na.omit(mean.discharge.mean.wateryear.nozero)
mean.discharge.senslope.wateryear.nozero <- sens.output(time.step=mean.discharge.mean.wateryear.nozero$Water_Year,data=log(mean.discharge.mean.wateryear.nozero$mean.discharge.mean))
mean.discharge.senslope.wateryear.nozero$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_meanflow.water.jpeg", width=1000)
ggplot(FallingRock, aes(factor(Water_Year), mean.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Mean Annual Discharge (Log Scale) Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(Water_Year), meandaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.wateryear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling Rock Mean Annual Discharge Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Climate Year

discharge.climateyear <- unique(FallingRock$Climate_Year)
mean.discharge.climateyear <- data.frame(matrix(nrow=length(discharge.climateyear),ncol=1))
for(i in 1:length(discharge.climateyear)){
  mean.discharge.climateyear[i,1] <- mean(FallingRock$meandaily_CFS[which(FallingRock$Climate_Year==discharge.climateyear[i])],na.rm=TRUE)
}

mean.discharge.climateyear$Climate_Year <- unique(FallingRock$Climate_Year)
mean.discharge.mean.climateyear <- data.frame(matrix((nrow=length(mean.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(FallingRock$Climate_Year))){
    mean.discharge.mean.climateyear[i,1] <- mean(FallingRock$meandaily_CFS[which(FallingRock$Climate_Year==discharge.climateyear[i])],na.rm=TRUE)
}

colnames(mean.discharge.mean.climateyear) <- c('mean.discharge.mean')
mean.discharge.mean.climateyear$Climate_Year <- discharge.climateyear
mean.discharge.mean.climateyear <- na.omit(mean.discharge.mean.climateyear)
mean.discharge.senslope.climateyear <- sens.output(time.step=mean.discharge.mean.climateyear$Climate_Year,data=mean.discharge.mean.climateyear$mean.discharge.mean)
mean.discharge.senslope.climateyear$year <- "Climate.Year"

mean.discharge.mean.climateyear.nozero <- data.frame(matrix((nrow=length(discharge.climateyear)),ncol=1))
for(i in 1:length(unique(FallingRock$Climate_Year))){
    mean.discharge.mean.climateyear.nozero[i,1] <- mean(FallingRock$mean.discharge.nozero[which(FallingRock$Climate_Year==discharge.climateyear[i])],na.rm=TRUE)
}

colnames(mean.discharge.mean.climateyear.nozero) <- c('mean.discharge.mean')
mean.discharge.mean.climateyear.nozero$Climate_Year <- discharge.climateyear
mean.discharge.mean.climateyear.nozero <- na.omit(mean.discharge.mean.climateyear.nozero)
mean.discharge.senslope.climateyear.nozero <- sens.output(time.step=mean.discharge.mean.climateyear.nozero$Climate_Year,data=log(mean.discharge.mean.climateyear.nozero$mean.discharge.mean))
mean.discharge.senslope.climateyear.nozero$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_meanflow.clim.jpeg", width=1000)
ggplot(FallingRock, aes(factor(Climate_Year), mean.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.climateyear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Mean Annual Discharge (Log Scale) Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(Climate_Year), meandaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.climateyear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling Rock Mean Annual Discharge Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))


#Seasonal
mean.discharge.season <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.season)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    mean.discharge.season[i,j] <- mean(FallingRock$meandaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])],na.rm=TRUE)
  }
}

median.discharge.mean.season <- data.frame(matrix(nrow=length(discharge.year),ncol=length(seasons)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    median.discharge.mean.season[i,j] <- median(FallingRock$meandaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])],na.rm=TRUE)
  }
}
colnames(median.discharge.mean.season) <- seasons
median.discharge.mean.season$year <- discharge.year
mean.discharge.senslope.winter <- sens.output(time.step=median.discharge.mean.season$year,data=median.discharge.mean.season$Winter)
mean.discharge.senslope.spring <- sens.output(time.step=median.discharge.mean.season$year,data=median.discharge.mean.season$Spring)
mean.discharge.senslope.summer <- sens.output(time.step=median.discharge.mean.season$year,data=median.discharge.mean.season$Summer)
mean.discharge.senslope.autumn <- sens.output(time.step=median.discharge.mean.season$year,data=median.discharge.mean.season$Autumn)
mean.discharge.senslope.season <- rbind(mean.discharge.senslope.winter,mean.discharge.senslope.spring,mean.discharge.senslope.summer,mean.discharge.senslope.autumn)
mean.discharge.senslope.season$season <- unique(FallingRock.air.temp$season)

median.discharge.mean.season.nozero <- data.frame(matrix(nrow=length(discharge.year),ncol=length(seasons)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    median.discharge.mean.season.nozero[i,j] <- median(FallingRock$mean.discharge.nozero[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])],na.rm=TRUE)
  }
}
colnames(median.discharge.mean.season.nozero) <- seasons
median.discharge.mean.season.nozero$year <- discharge.year
mean.discharge.senslope.winter.nozero <- sens.output(time.step=median.discharge.mean.season.nozero$year,data=median.discharge.mean.season.nozero$Winter)
mean.discharge.senslope.spring.nozero <- sens.output(time.step=median.discharge.mean.season.nozero$year,data=median.discharge.mean.season.nozero$Spring)
mean.discharge.senslope.summer.nozero <- sens.output(time.step=median.discharge.mean.season.nozero$year,data=median.discharge.mean.season.nozero$Summer)
mean.discharge.senslope.autumn.nozero <- sens.output(time.step=median.discharge.mean.season.nozero$year,data=median.discharge.mean.season.nozero$Autumn)
mean.discharge.senslope.season.nozero <- rbind(mean.discharge.senslope.winter.nozero,mean.discharge.senslope.spring.nozero,mean.discharge.senslope.summer.nozero,mean.discharge.senslope.autumn.nozero)
mean.discharge.senslope.season.nozero$season <- unique(FallingRock.air.temp$season)

ggplot(FallingRock, aes(factor(year), mean.discharge.nozero, fill=season)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.season.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  facet_wrap(~season)+
  ggtitle("Falling Rock Mean Seasonal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(FallingRock, aes(factor(year), meandaily_CFS, fill=season)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.season, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~season)+
  ggtitle("Falling Rock Mean Seasonal Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Monthly
mean.discharge.month <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    mean.discharge.month[i,j] <- mean(FallingRock$meandaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }}

median.discharge.mean.month <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    median.discharge.mean.month[i,j] <- median(FallingRock$meandaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(median.discharge.mean.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
median.discharge.mean.month$year <- discharge.year
median.discharge.mean.month <- na.omit(median.discharge.mean.month)

mean.discharge.senslope.jan <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$January)
mean.discharge.senslope.feb <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$February)
mean.discharge.senslope.mar <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$March)
mean.discharge.senslope.apr <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$April)
mean.discharge.senslope.may <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$May)
mean.discharge.senslope.jun <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$June)
mean.discharge.senslope.jul <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$July)
mean.discharge.senslope.aug <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$August)
mean.discharge.senslope.sep <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$September)
mean.discharge.senslope.oct <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$October)
mean.discharge.senslope.nov <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$November)
mean.discharge.senslope.dec <- sens.output(time.step=median.discharge.mean.month$year,data=median.discharge.mean.month$December)
mean.discharge.senslope.month <- rbind(mean.discharge.senslope.jan,mean.discharge.senslope.feb,mean.discharge.senslope.mar,mean.discharge.senslope.apr,mean.discharge.senslope.may,mean.discharge.senslope.jun,mean.discharge.senslope.jul,mean.discharge.senslope.aug,mean.discharge.senslope.sep,mean.discharge.senslope.oct,mean.discharge.senslope.nov,mean.discharge.senslope.dec)
mean.discharge.senslope.month$Month <- unique(FallingRock$Month)

median.discharge.mean.month.nozero <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    median.discharge.mean.month.nozero[i,j] <- median(FallingRock$mean.discharge.nozero[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(median.discharge.mean.month.nozero) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
median.discharge.mean.month.nozero$year <- discharge.year
median.discharge.mean.month.nozero <- na.omit(median.discharge.mean.month.nozero)

mean.discharge.senslope.jan.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$January)
mean.discharge.senslope.feb.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$February)
mean.discharge.senslope.mar.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$March)
mean.discharge.senslope.apr.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$April)
mean.discharge.senslope.may.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$May)
mean.discharge.senslope.jun.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$June)
mean.discharge.senslope.jul.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$July)
mean.discharge.senslope.aug.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$August)
mean.discharge.senslope.sep.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$September)
mean.discharge.senslope.oct.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$October)
mean.discharge.senslope.nov.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$November)
mean.discharge.senslope.dec.nozero <- sens.output(time.step=median.discharge.mean.month.nozero$year,data=median.discharge.mean.month.nozero$December)
mean.discharge.senslope.month.nozero <- rbind(mean.discharge.senslope.jan.nozero,mean.discharge.senslope.feb.nozero,mean.discharge.senslope.mar.nozero,mean.discharge.senslope.apr.nozero,mean.discharge.senslope.may.nozero,mean.discharge.senslope.jun.nozero,mean.discharge.senslope.jul.nozero,mean.discharge.senslope.aug.nozero,mean.discharge.senslope.sep.nozero,mean.discharge.senslope.oct.nozero,mean.discharge.senslope.nov.nozero,mean.discharge.senslope.dec.nozero)
mean.discharge.senslope.month.nozero$Month <- unique(FallingRock$Month)


ggplot(FallingRock, aes(factor(year), mean.discharge.nozero, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.month.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Mean Monthly Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(FallingRock, aes(factor(year), meandaily_CFS, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=mean.discharge.senslope.month.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Mean Monthly Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
```

### Section 3.2.1: Mean Flow Statistical Summary
```{r}
FR.Mean.Flow.statistical.summary <- rbind.fill(mean.discharge.senslope.halfdec,mean.discharge.senslope.year,mean.discharge.senslope.wateryear,mean.discharge.senslope.climateyear,mean.discharge.senslope.season,mean.discharge.senslope.month)

FR.Mean.Flow.Nozero.statistical.summary <- rbind.fill(mean.discharge.senslope.halfdec.nozero,mean.discharge.senslope.year.nozero,mean.discharge.senslope.wateryear.nozero,mean.discharge.senslope.climateyear.nozero,mean.discharge.senslope.season.nozero,mean.discharge.senslope.month.nozero)
```


##Section 3.3: Maximum Flow
```{r}
#Entire Time Series (daily)
FallingRock$max.discharge.nozero <- FallingRock$maxdaily_CFS+0.0001
ggplot(data=FallingRock, aes(x=Date.1, y=max.discharge.nozero))+
  geom_line()+
  scale_y_log10()+
  ggtitle("Maximum Daily Discharge at Falling Rock")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(data=FallingRock, aes(x=Date.1, y=maxdaily_CFS))+
  geom_line()+
  ggtitle("Maximum Daily Discharge at Falling Rock")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#1/2 Decade
max.discharge.half.dec <- data.frame(matrix(nrow=length(discharge.half.dec),ncol=1))
for(i in 1:length(discharge.half.dec)){
  max.discharge.half.dec[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$half.decade==discharge.half.dec[i])],na.rm=TRUE)
}
max.discharge.max.halfdec <- data.frame(matrix(nrow=length(unique(FallingRock$half.decade)),ncol=1))
for(i in 1:length(unique(FallingRock$half.decade))){
    max.discharge.max.halfdec[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(max.discharge.max.halfdec) <- c('max.discharge.max')
max.discharge.max.halfdec$halfdec <- discharge.half.dec
max.discharge.max.halfdec <- na.omit(max.discharge.max.halfdec)
max.discharge.senslope.halfdec <- sens.output(time.step=max.discharge.max.halfdec$halfdec,data=max.discharge.max.halfdec$max.discharge.max)
max.discharge.senslope.halfdec$half.decade <- "Half.Decade"

max.discharge.max.halfdec.nozero <- data.frame(matrix(nrow=length(unique(FallingRock$half.decade)),ncol=1))
for(i in 1:length(unique(FallingRock$half.decade))){
    max.discharge.max.halfdec.nozero[i,1] <- max(FallingRock$max.discharge.nozero[which(FallingRock$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(max.discharge.max.halfdec.nozero) <- c('max.discharge.max')
max.discharge.max.halfdec.nozero$halfdec <- half.decades[2:9]
max.discharge.senslope.halfdec.nozero <- sens.output(time.step=max.discharge.max.halfdec.nozero$halfdec,data=log(max.discharge.max.halfdec.nozero$max.discharge.max))
max.discharge.senslope.halfdec.nozero$half.deacade <- "Half.Decade"


ggplot(FallingRock, aes(factor(half.decade), max.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.halfdec.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_y_log10()+
  ggtitle("Falling Rock Maximum Half-Decadal Discharge (Log Scale)")+
  xlab("Half-Decade")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(FallingRock, aes(factor(half.decade), maxdaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Maximum Half-Decadal Discharge")+
  xlab("Half-Decade")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Yearly
max.discharge.year <- data.frame(matrix(nrow=length(discharge.year),ncol=1))
for(i in 1:length(discharge.year)){
  max.discharge.year[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

max.discharge.max.year <- data.frame(matrix((nrow=length(max.discharge.year)),ncol=1))
for(i in 1:length(unique(FallingRock$year))){
    max.discharge.max.year[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

colnames(max.discharge.max.year) <- c('max.discharge.max')
max.discharge.max.year$year <- discharge.year
max.discharge.max.year <- na.omit(max.discharge.max.year)
max.discharge.senslope.year <- sens.output(time.step=max.discharge.max.year$year,data=max.discharge.max.year$max.discharge.max)
max.discharge.senslope.year$year <- "Calendar.Year"

max.discharge.max.year.nozero <- data.frame(matrix((nrow=length(discharge.year)),ncol=1))
for(i in 1:length(unique(FallingRock$year))){
    max.discharge.max.year.nozero[i,1] <- max(FallingRock$max.discharge.nozero[which(FallingRock$year==discharge.year[i])],na.rm=TRUE)
}

colnames(max.discharge.max.year.nozero) <- c('max.discharge.max')
max.discharge.max.year.nozero$year <- discharge.year
max.discharge.max.year.nozero <- na.omit(max.discharge.max.year.nozero)
max.discharge.senslope.year.nozero <- sens.output(time.step=max.discharge.max.year.nozero$year,data=log(max.discharge.max.year.nozero$max.discharge.max))
max.discharge.senslope.year.nozero$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_maxflow.cal.jpeg", width=1000)
ggplot(FallingRock, aes(factor(year), max.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.year.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Maximum Annual Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(year), maxdaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.year, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling Rock Maximum Annual Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Water Year
discharge.wateryear <- unique(FallingRock$Water_Year)
max.discharge.wateryear <- data.frame(matrix(nrow=length(discharge.wateryear),ncol=1))
for(i in 1:length(discharge.wateryear)){
  max.discharge.wateryear[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

max.discharge.wateryear$Water_Year <- unique(FallingRock$Water_Year)
max.discharge.max.wateryear <- data.frame(matrix((nrow=length(max.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(FallingRock$Water_Year))){
    max.discharge.max.wateryear[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

colnames(max.discharge.max.wateryear) <- c('max.discharge.max')
max.discharge.max.wateryear$Water_Year <- discharge.wateryear
max.discharge.max.wateryear <- na.omit(max.discharge.max.wateryear)
max.discharge.senslope.wateryear <- sens.output(time.step=max.discharge.max.wateryear$Water_Year,data=max.discharge.max.wateryear$max.discharge.max)
max.discharge.senslope.wateryear$year <- "Water.Year"

max.discharge.max.wateryear.nozero <- data.frame(matrix((nrow=length(discharge.wateryear)),ncol=1))
for(i in 1:length(unique(FallingRock$Water_Year))){
    max.discharge.max.wateryear.nozero[i,1] <- max(FallingRock$max.discharge.nozero[which(FallingRock$Water_Year==discharge.wateryear[i])],na.rm=TRUE)
}

colnames(max.discharge.max.wateryear.nozero) <- c('max.discharge.max')
max.discharge.max.wateryear.nozero$Water_Year <- discharge.wateryear
max.discharge.max.wateryear.nozero <- na.omit(max.discharge.max.wateryear.nozero)
max.discharge.senslope.wateryear.nozero <- sens.output(time.step=max.discharge.max.wateryear.nozero$Water_Year,data=log(max.discharge.max.wateryear.nozero$max.discharge.max))
max.discharge.senslope.wateryear.nozero$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_maxflow.water.jpeg", width=1000)
ggplot(FallingRock, aes(factor(Water_Year), max.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Maximum Annual Discharge (Log Scale) Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(Water_Year), maxdaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.wateryear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling Rock Maximum Annual Discharge Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Climate Year

discharge.climateyear <- unique(FallingRock$Climate_Year)
max.discharge.climateyear <- data.frame(matrix(nrow=length(discharge.climateyear),ncol=1))
for(i in 1:length(discharge.climateyear)){
  max.discharge.climateyear[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$Climate_Year==discharge.climateyear[i])],na.rm=TRUE)
}

max.discharge.climateyear$Climate_Year <- unique(FallingRock$Climate_Year)
max.discharge.max.climateyear <- data.frame(matrix((nrow=length(max.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(FallingRock$Climate_Year))){
    max.discharge.max.climateyear[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$Climate_Year==discharge.climateyear[i])],na.rm=TRUE)
}

colnames(max.discharge.max.climateyear) <- c('max.discharge.max')
max.discharge.max.climateyear$Climate_Year <- discharge.climateyear
max.discharge.max.climateyear <- na.omit(max.discharge.max.climateyear)
max.discharge.senslope.climateyear <- sens.output(time.step=max.discharge.max.climateyear$Climate_Year,data=max.discharge.max.climateyear$max.discharge.max)
max.discharge.senslope.climateyear$year <- "Climate.Year"

max.discharge.max.climateyear.nozero <- data.frame(matrix((nrow=length(discharge.climateyear)),ncol=1))
for(i in 1:length(unique(FallingRock$Climate_Year))){
    max.discharge.max.climateyear.nozero[i,1] <- max(FallingRock$max.discharge.nozero[which(FallingRock$Climate_Year==discharge.climateyear[i])],na.rm=TRUE)
}

colnames(max.discharge.max.climateyear.nozero) <- c('max.discharge.max')
max.discharge.max.climateyear.nozero$Climate_Year <- discharge.climateyear
max.discharge.max.climateyear.nozero <- na.omit(max.discharge.max.climateyear.nozero)
max.discharge.senslope.climateyear.nozero <- sens.output(time.step=max.discharge.max.climateyear.nozero$Climate_Year,data=log(max.discharge.max.climateyear.nozero$max.discharge.max))
max.discharge.senslope.wateryear.nozero$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_maxflow.clim.jpeg", width=1000)
ggplot(FallingRock, aes(factor(Climate_Year), max.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Falling Rock Maximum Annual Discharge (Log Scale) Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(FallingRock, aes(factor(Climate_Year), maxdaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.wateryear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Falling Rock Maximum Annual Discharge Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
max.discharge.max.season <- data.frame(matrix(nrow=length(discharge.year),ncol=length(seasons)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    max.discharge.max.season[i,j] <- max(FallingRock$maxdaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])],na.rm=TRUE)
  }
}

colnames(max.discharge.max.season) <- seasons
max.discharge.max.season$year <- discharge.year
max.discharge.senslope.winter <- sens.output(time.step=max.discharge.max.season$year,data=max.discharge.max.season$Winter)
max.discharge.senslope.spring <- sens.output(time.step=max.discharge.max.season$year,data=max.discharge.max.season$Spring)
max.discharge.senslope.summer <- sens.output(time.step=max.discharge.max.season$year,data=max.discharge.max.season$Summer)
max.discharge.senslope.autumn <- sens.output(time.step=max.discharge.max.season$year,data=max.discharge.max.season$Autumn)
max.discharge.senslope.season <- rbind(max.discharge.senslope.winter,max.discharge.senslope.spring,max.discharge.senslope.summer,max.discharge.senslope.autumn)
max.discharge.senslope.season$season <- unique(FallingRock.air.temp$season)

max.discharge.max.season.nozero <- data.frame(matrix(nrow=length(discharge.year),ncol=length(seasons)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    max.discharge.max.season.nozero[i,j] <- max(FallingRock$max.discharge.nozero[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])],na.rm=TRUE)
  }
}
colnames(max.discharge.max.season.nozero) <- seasons
max.discharge.max.season.nozero$year <- discharge.year
max.discharge.senslope.winter.nozero <- sens.output(time.step=max.discharge.max.season.nozero$year,data=log(max.discharge.max.season.nozero$Winter))
max.discharge.senslope.spring.nozero <- sens.output(time.step=max.discharge.max.season.nozero$year,data=log(max.discharge.max.season.nozero$Spring))
max.discharge.senslope.summer.nozero <- sens.output(time.step=max.discharge.max.season.nozero$year,data=log(max.discharge.max.season.nozero$Summer))
max.discharge.senslope.autumn.nozero <- sens.output(time.step=max.discharge.max.season.nozero$year,data=log(max.discharge.max.season.nozero$Autumn))
max.discharge.senslope.season.nozero <- rbind(max.discharge.senslope.winter.nozero,max.discharge.senslope.spring.nozero,max.discharge.senslope.summer.nozero,max.discharge.senslope.autumn.nozero)
max.discharge.senslope.season.nozero$season <- unique(FallingRock.air.temp$season)


ggplot(FallingRock, aes(factor(year), max.discharge.nozero, fill=season)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.season.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  facet_wrap(~season)+
  ggtitle("Falling Rock Maximum Seasonal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(FallingRock, aes(factor(year), maxdaily_CFS, fill=season)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.season, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~season)+
  ggtitle("Falling Rock Maximum Seasonal Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Monthly
max.discharge.month <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    max.discharge.month[i,j] <- max(FallingRock$maxdaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }}

max.discharge.max.month <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    max.discharge.max.month[i,j] <- max(FallingRock$maxdaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(max.discharge.max.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
max.discharge.max.month$year <- discharge.year
max.discharge.max.month$March[35] <- NA
max.discharge.max.month <- na.omit(max.discharge.max.month)

max.discharge.senslope.jan <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$January)
max.discharge.senslope.feb <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$February)
max.discharge.senslope.mar <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$March)
max.discharge.senslope.apr <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$April)
max.discharge.senslope.may <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$May)
max.discharge.senslope.jun <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$June)
max.discharge.senslope.jul <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$July)
max.discharge.senslope.aug <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$August)
max.discharge.senslope.sep <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$September)
max.discharge.senslope.oct <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$October)
max.discharge.senslope.nov <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$November)
max.discharge.senslope.dec <- sens.output(time.step=max.discharge.max.month$year,data=max.discharge.max.month$December)
max.discharge.senslope.month <- rbind(max.discharge.senslope.jan,max.discharge.senslope.feb,max.discharge.senslope.mar,max.discharge.senslope.apr,max.discharge.senslope.may,max.discharge.senslope.jun,max.discharge.senslope.jul,max.discharge.senslope.aug,max.discharge.senslope.sep,max.discharge.senslope.oct,max.discharge.senslope.nov,max.discharge.senslope.dec)
max.discharge.senslope.month$Month <- unique(FallingRock$Month)

max.discharge.max.month.nozero <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    max.discharge.max.month.nozero[i,j] <- max(FallingRock$max.discharge.nozero[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(max.discharge.max.month.nozero) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
max.discharge.max.month.nozero$year <- discharge.year
max.discharge.max.month.nozero$March[35] <- NA
max.discharge.max.month.nozero <- na.omit(max.discharge.max.month.nozero)


max.discharge.senslope.jan.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$January))
max.discharge.senslope.feb.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$February))
max.discharge.senslope.mar.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$March))
max.discharge.senslope.apr.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$April))
max.discharge.senslope.may.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$May))
max.discharge.senslope.jun.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$June))
max.discharge.senslope.jul.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$July))
max.discharge.senslope.aug.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$August))
max.discharge.senslope.sep.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$September))
max.discharge.senslope.oct.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$October))
max.discharge.senslope.nov.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$November))
max.discharge.senslope.dec.nozero <- sens.output(time.step=max.discharge.max.month.nozero$year,data=log(max.discharge.max.month.nozero$December))
max.discharge.senslope.month.nozero <- rbind(max.discharge.senslope.jan.nozero,max.discharge.senslope.feb.nozero,max.discharge.senslope.mar.nozero,max.discharge.senslope.apr.nozero,max.discharge.senslope.may.nozero,max.discharge.senslope.jun.nozero,max.discharge.senslope.jul.nozero,max.discharge.senslope.aug.nozero,max.discharge.senslope.sep.nozero,max.discharge.senslope.oct.nozero,max.discharge.senslope.nov.nozero,max.discharge.senslope.dec.nozero)
max.discharge.senslope.month.nozero$Month <- unique(FallingRock$Month)

ggplot(FallingRock, aes(factor(year), max.discharge.nozero, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.month.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Maximum Monthly Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(FallingRock, aes(factor(year), maxdaily_CFS, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=max.discharge.senslope.month, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Maximum Monthly Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
```

### Section 3.3.1: Maximum Flow Statistical Summary
```{r}
FR.Max.Flow.statistical.summary <- rbind.fill(max.discharge.senslope.halfdec,max.discharge.senslope.year,max.discharge.senslope.wateryear,max.discharge.senslope.climateyear,max.discharge.senslope.season,max.discharge.senslope.month)

FR.Max.Flow.Nozero.statistical.summary <- rbind.fill(max.discharge.senslope.halfdec.nozero,max.discharge.senslope.year.nozero,max.discharge.senslope.wateryear.nozero,max.discharge.senslope.climateyear.nozero,max.discharge.senslope.season.nozero,max.discharge.senslope.month.nozero)
```

##Section 3.4: Minimum Water Temperature
```{r}
FR.Water <- data.frame(matrix(nrow=4109,))
colnames(FR.Water) <- c("number")
FR.Water$number <- 1:4109
FR.Water$min <- FallingRock$tempmin[12148:16256]
FR.Water$mean <- FallingRock$tempmean[12148:16256]
FR.Water$max <- FallingRock$tempmax[12148:16256]
FR.Water$Date <- FallingRock$Date[12148:16256]
FR.Water$year <- FallingRock$year[12148:16256]
FR.Water$season <- FallingRock$season[12148:16256]
FR.Water$Month <- FallingRock$Month[12148:16256]
FR.Water$halfdec <- FallingRock$half.decade[12148:16256]
FR.Water <- na.omit(FR.Water)

#Entire Time Series (Daily)
ggplot(data=FallingRock, aes(x=Date.1, y=tempmin))+
  geom_line()+
  ggtitle("Minimum Daily Water Temperature at Falling Rock")+
  xlab("Date")+
  scale_x_date(limits = as.Date(c("2010-01-01", "2015-12-31")))
  ylab("Water Temperature (F)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
  
#1/2 Decade
watertemp.half.dec <- unique(FallingRock$half.decade)
min.watertemp.half.dec <- data.frame(matrix(nrow=length(watertemp.half.dec),ncol=1))
for(i in 1:length(watertemp.half.dec)){
  min.watertemp.half.dec[i,1] <- min(FallingRock$tempmin[which(FallingRock$half.decade==watertemp.half.dec[i])],na.rm=TRUE)
} 
FallingRock$year <- as.numeric(FallingRock$year)

median.watertemp.min.halfdec <- data.frame(matrix(nrow=length(watertemp.half.dec),ncol=1))
for(i in 1:length(watertemp.half.dec)){
    median.watertemp.min.halfdec[i,1] <- median(FallingRock$tempmin[which(FallingRock$half.decade==watertemp.half.dec[i])],na.rm=TRUE)
}

colnames(median.watertemp.min.halfdec) <- c('median.watertemp')
median.watertemp.min.halfdec$halfdec <- watertemp.half.dec
median.watertemp.min.halfdec <- na.omit(median.watertemp.min.halfdec)
min.watertemp.senslope.halfdec <- sens.output(time.step=median.watertemp.min.halfdec$halfdec,data=median.watertemp.min.halfdec$median.watertemp)
min.watertemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(FR.Water, aes(factor(halfdec), min)) +
  geom_boxplot() +
  geom_abline(data=min.watertemp.senslope.halfdec, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Half-Decade Minimum Water Temperature")+
  xlab("Half Decade")+
  ylab("Water Temperature (F)")

#Yearly
water.temp.year <- unique(FallingRock$year)
min.watertemp.year <- data.frame(matrix(nrow=length(water.temp.year),ncol=1))
for(i in 1:length(water.temp.year)){
  min.watertemp.year[i,1] <- 
    mean(FallingRock$tempmin[which(FallingRock$year==water.temp.year[i])])
} 

median.watertemp.min.year <- data.frame(matrix(nrow=length(water.temp.year),ncol=1))
for(i in 1:length(water.temp.year)){
    median.watertemp.min.year[i,1] <- median(FallingRock$tempmin[which(FallingRock$year==water.temp.year[i])],na.rm=TRUE)
}

colnames(median.watertemp.min.year) <- c('median.watertemp')
median.watertemp.min.year$year <- water.temp.year
median.watertemp.min.year <- na.omit(median.watertemp.min.year)
min.watertemp.senslope.year <- sens.output(time.step=median.watertemp.min.year$year,data=median.watertemp.min.year$median.watertemp)
min.watertemp.senslope.year$year <- "Calendar.Year"

ggplot(FR.Water, aes(factor(year), min)) +
  geom_boxplot() +
  geom_abline(data=min.watertemp.senslope.year, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Minimum Annual Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
watertemp.season <- unique(FallingRock$season)
min.watertemp.season <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(watertemp.season)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(watertemp.season)){
    min.watertemp.season[i,j] <- mean(FallingRock$tempmin[which(FallingRock$year==water.temp.year[i]&FallingRock$season==watertemp.season[j])],na.rm=TRUE)
  }
}

median.watertemp.min.season <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(watertemp.season)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(watertemp.season)){
    median.watertemp.min.season[i,j] <- median(FallingRock$tempmin[which(FallingRock$year==water.temp.year[i]&FallingRock$season==watertemp.season[j])],na.rm=TRUE)
  }
}
colnames(median.watertemp.min.season) <- seasons
median.watertemp.min.season$year <- water.temp.year
median.watertemp.min.season <- na.omit(median.watertemp.min.season)

min.watertemp.senslope.winter <- sens.output(time.step=median.watertemp.min.season$year,data=median.watertemp.min.season$Winter)
min.watertemp.senslope.spring <- sens.output(time.step=median.watertemp.min.season$year,data=median.watertemp.min.season$Spring)
min.watertemp.senslope.summer <- sens.output(time.step=median.watertemp.min.season$year,data=median.watertemp.min.season$Summer)
min.watertemp.senslope.autumn <- sens.output(time.step=median.watertemp.min.season$year,data=median.watertemp.min.season$Autumn)
min.watertemp.senslope.season <- rbind(min.watertemp.senslope.winter,min.watertemp.senslope.spring,min.watertemp.senslope.summer,min.watertemp.senslope.autumn)
min.watertemp.senslope.season$season <- unique(FallingRock$season)

ggplot(FR.Water, aes(factor(year), min, fill=season)) +
  geom_boxplot() +
  geom_abline(data=min.watertemp.senslope.season, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  facet_wrap(~season)+
  ggtitle("Falling Rock Minimum Seasonal Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

#Monthly
water.temp.month <- unique(FallingRock$month)
min.watertemp.month <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(water.temp.month)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(water.temp.month)){
    min.watertemp.month[i,j] <- mean(FallingRock$tempmin[which(FallingRock$year==water.temp.year[i]&FallingRock$month==water.temp.month[j])],na.rm=TRUE)
  }}

median.watertemp.min.month <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(water.temp.month)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(water.temp.month)){
    median.watertemp.min.month[i,j] <- median(FallingRock$tempmin[which(FallingRock$year==water.temp.year[i]&FallingRock$month==water.temp.month[j])],na.rm=TRUE)
  }
}
colnames(median.watertemp.min.month) <- unique(FallingRock$Month)
median.watertemp.min.month$year <- water.temp.year
median.watertemp.min.month <- na.omit(median.watertemp.min.month)

min.watertemp.senslope.jan <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$January)
min.watertemp.senslope.feb <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$February)
min.watertemp.senslope.mar <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$March)
min.watertemp.senslope.apr <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$April)
min.watertemp.senslope.may <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$May)
min.watertemp.senslope.jun <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$June)
min.watertemp.senslope.jul <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$July)
min.watertemp.senslope.aug <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$August)
min.watertemp.senslope.sep <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$September)
min.watertemp.senslope.oct <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$October)
min.watertemp.senslope.nov <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$November)
min.watertemp.senslope.dec <- sens.output(time.step=median.watertemp.min.month$year,data=median.watertemp.min.month$December)
min.watertemp.senslope.month <- rbind(min.watertemp.senslope.jan,min.watertemp.senslope.feb,min.watertemp.senslope.mar,min.watertemp.senslope.apr,min.watertemp.senslope.may,min.watertemp.senslope.jun,min.watertemp.senslope.jul,min.watertemp.senslope.aug,min.watertemp.senslope.sep,min.watertemp.senslope.oct,min.watertemp.senslope.nov,min.watertemp.senslope.dec)
min.watertemp.senslope.month$Month <- unique(FallingRock$Month)

ggplot(FR.Water, aes(factor(year), min, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=min.watertemp.senslope.month, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Minimum Monthly Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

### Section 3.4.1: Minimum Water Temperature Statistical Summary
```{r}
FR.Min.watertemp.statistical.summary <- rbind.fill(min.watertemp.senslope.halfdec,min.watertemp.senslope.year,min.watertemp.senslope.season,min.watertemp.senslope.month)
```


##Section 3.5: Mean Water Temperature
```{r}
#Entire Time Series (Daily)
ggplot(data=FallingRock, aes(x=Date.1, y=meandaily_CFS))+
  geom_line()+
  ggtitle("Mean Daily Water Temperature at Falling Rock")+
  xlab("Date")+
  scale_x_date(limits = as.Date(c("2010-01-01", "2015-12-31")))
  ylab("Water Temperature (F)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
#plotting mean water temperature data over the entire timeseries
  
#1/2 Decade
watertemp.half.dec <- unique(FallingRock$half.decade)
mean.watertemp.half.dec <- data.frame(matrix(nrow=length(watertemp.half.dec),ncol=1))
for(i in 1:length(watertemp.half.dec)){
  mean.watertemp.half.dec[i,1] <- mean(FallingRock$tempmean[which(FallingRock$half.decade==watertemp.half.dec[i])],na.rm=TRUE)
} 

median.watertemp.mean.halfdec <- data.frame(matrix(nrow=length(watertemp.half.dec),ncol=1))
for(i in 1:length(watertemp.half.dec)){
    median.watertemp.mean.halfdec[i,1] <- median(FallingRock$tempmean[which(FallingRock$half.decade==watertemp.half.dec[i])],na.rm=TRUE)
}

colnames(median.watertemp.mean.halfdec) <- c('median.watertemp')
median.watertemp.mean.halfdec$halfdec <- watertemp.half.dec
median.watertemp.mean.halfdec <- na.omit(median.watertemp.mean.halfdec)
mean.watertemp.senslope.halfdec <- sens.output(time.step=median.watertemp.mean.halfdec$halfdec,data=median.watertemp.mean.halfdec$median.watertemp)
mean.watertemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(FR.Water, aes(factor(halfdec), mean)) +
  geom_boxplot() +
  geom_abline(data=mean.watertemp.senslope.halfdec, aes(slope=slope, intercept=15))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Half-Decade Mean Water Temperature")+
  xlab("Half Decade")+
  ylab("Water Temperature (F)")

#Yearly
mean.watertemp.year <- data.frame(matrix(nrow=length(water.temp.year),ncol=1))
for(i in 1:length(water.temp.year)){
  mean.watertemp.year[i,1] <- 
    mean(FallingRock$tempmean[which(FallingRock$year==water.temp.year[i])])
}

median.watertemp.mean.year <- data.frame(matrix(nrow=length(water.temp.year),ncol=1))
for(i in 1:length(water.temp.year)){
    median.watertemp.mean.year[i,1] <- median(FallingRock$tempmean[which(FallingRock$year==water.temp.year[i])],na.rm=TRUE)
}

colnames(median.watertemp.mean.year) <- c('median.watertemp')
median.watertemp.mean.year$year <- water.temp.year
median.watertemp.mean.year <- na.omit(median.watertemp.mean.year)
mean.watertemp.senslope.year <- sens.output(time.step=median.watertemp.mean.year$year,data=median.watertemp.mean.year$median.watertemp)
mean.watertemp.senslope.year$year <- "Calendar.Year"

ggplot(FR.Water, aes(factor(year), mean)) +
  geom_boxplot() +
  geom_abline(data=mean.watertemp.senslope.year, aes(slope=slope, intercept=15))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Mean Annual Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
mean.watertemp.season <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(watertemp.season)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(watertemp.season)){
    mean.watertemp.season[i,j] <- mean(FallingRock$tempmean[which(FallingRock$year==water.temp.year[i]&FallingRock$season==watertemp.season[j])],na.rm=TRUE)
  }
}

median.watertemp.mean.season <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(watertemp.season)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(watertemp.season)){
    median.watertemp.mean.season[i,j] <- median(FallingRock$tempmean[which(FallingRock$year==water.temp.year[i]&FallingRock$season==watertemp.season[j])],na.rm=TRUE)
  }
}
colnames(median.watertemp.mean.season) <- seasons
median.watertemp.mean.season$year <- water.temp.year
median.watertemp.mean.season <- na.omit(median.watertemp.mean.season)

mean.watertemp.senslope.winter <- sens.output(time.step=median.watertemp.mean.season$year,data=median.watertemp.mean.season$Winter)
mean.watertemp.senslope.spring <- sens.output(time.step=median.watertemp.mean.season$year,data=median.watertemp.mean.season$Spring)
mean.watertemp.senslope.summer <- sens.output(time.step=median.watertemp.mean.season$year,data=median.watertemp.mean.season$Summer)
mean.watertemp.senslope.autumn <- sens.output(time.step=median.watertemp.mean.season$year,data=median.watertemp.mean.season$Autumn)
mean.watertemp.senslope.season <- rbind(mean.watertemp.senslope.winter,mean.watertemp.senslope.spring,mean.watertemp.senslope.summer,mean.watertemp.senslope.autumn)
mean.watertemp.senslope.season$season <- unique(FallingRock$season)


ggplot(FR.Water, aes(factor(year), mean, fill=season)) +
  geom_boxplot() +
  geom_abline(data=mean.watertemp.senslope.season, aes(slope=slope, intercept=15))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  facet_wrap(~season)+
  ggtitle("Falling Rock Mean Seasonal Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

#Monthly
mean.watertemp.month <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(water.temp.month)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(water.temp.month)){
    mean.watertemp.month[i,j] <- mean(FallingRock$tempmean[which(FallingRock$year==water.temp.year[i]&FallingRock$month==water.temp.month[j])],na.rm=TRUE)
  }}

median.watertemp.mean.month <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(water.temp.month)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(water.temp.month)){
    median.watertemp.mean.month[i,j] <- median(FallingRock$tempmean[which(FallingRock$year==water.temp.year[i]&FallingRock$month==water.temp.month[j])],na.rm=TRUE)
  }
}
colnames(median.watertemp.mean.month) <- unique(FallingRock$Month)
median.watertemp.mean.month$year <- water.temp.year
median.watertemp.mean.month <- na.omit(median.watertemp.mean.month)

mean.watertemp.senslope.jan <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$January)
mean.watertemp.senslope.feb <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$February)
mean.watertemp.senslope.mar <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$March)
mean.watertemp.senslope.apr <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$April)
mean.watertemp.senslope.may <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$May)
mean.watertemp.senslope.jun <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$June)
mean.watertemp.senslope.jul <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$July)
mean.watertemp.senslope.aug <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$August)
mean.watertemp.senslope.sep <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$September)
mean.watertemp.senslope.oct <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$October)
mean.watertemp.senslope.nov <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$November)
mean.watertemp.senslope.dec <- sens.output(time.step=median.watertemp.mean.month$year,data=median.watertemp.mean.month$December)
mean.watertemp.senslope.month <- rbind(mean.watertemp.senslope.jan,mean.watertemp.senslope.feb,mean.watertemp.senslope.mar,mean.watertemp.senslope.apr,mean.watertemp.senslope.may,mean.watertemp.senslope.jun,mean.watertemp.senslope.jul,mean.watertemp.senslope.aug,mean.watertemp.senslope.sep,mean.watertemp.senslope.oct,mean.watertemp.senslope.nov,mean.watertemp.senslope.dec)
mean.watertemp.senslope.month$Month <- unique(FallingRock$Month)


ggplot(FR.Water, aes(factor(year), mean, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=mean.watertemp.senslope.month, aes(slope=slope, intercept=15))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Mean Monthly Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

### Section 3.5.1: Mean Water Temperature Statistical Summary
```{r}
FR.Mean.watertemp.statistical.summary <- rbind.fill(mean.watertemp.senslope.halfdec,mean.watertemp.senslope.year,mean.watertemp.senslope.season,mean.watertemp.senslope.month)
```

##Section 3.6: Maximum Water Temperature
```{r}
#Entire Time Series(daily)
ggplot(data=FallingRock, aes(x=Date.1, y=tempmax))+
  geom_line()+
  ggtitle("Maximum Daily Water Temperature at Falling Rock")+
  xlab("Date")+
  scale_x_date(limits = as.Date(c("2010-01-01", "2015-12-31")))
  ylab("Water Temperature (F)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
#1/2 Decade
watertemp.half.dec <- unique(FallingRock$half.decade)
max.watertemp.half.dec <- data.frame(matrix(nrow=length(watertemp.half.dec),ncol=1))
for(i in 1:length(watertemp.half.dec)){
  max.watertemp.half.dec[i,1] <- max(FallingRock$tempmax[which(FallingRock$half.decade==watertemp.half.dec[i])],na.rm=TRUE)
} 

median.watertemp.max.halfdec <- data.frame(matrix(nrow=length(watertemp.half.dec),ncol=1))
for(i in 1:length(watertemp.half.dec)){
    median.watertemp.max.halfdec[i,1] <- median(FallingRock$tempmax[which(FallingRock$half.decade==watertemp.half.dec[i])],na.rm=TRUE)
}

colnames(median.watertemp.max.halfdec) <- c('median.watertemp')
median.watertemp.max.halfdec$halfdec <- watertemp.half.dec
median.watertemp.max.halfdec <- na.omit(median.watertemp.max.halfdec)
max.watertemp.senslope.halfdec <- sens.output(time.step=median.watertemp.max.halfdec$halfdec,data=median.watertemp.max.halfdec$median.watertemp)
max.watertemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(FR.Water, aes(factor(halfdec), max)) +
  geom_boxplot() +
  geom_abline(data=max.watertemp.senslope.halfdec, aes(slope=slope, intercept=17))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Falling Rock Half-Decade Maximum Water Temperature")+
  xlab("Half Decade")+
  ylab("Water Temperature (F)")

#Yearly
max.watertemp.year <- data.frame(matrix(nrow=length(water.temp.year),ncol=1))
for(i in 1:length(water.temp.year)){
  max.watertemp.year[i,1] <- 
    mean(FallingRock$tempmax[which(FallingRock$year==water.temp.year[i])])
}

median.watertemp.max.year <- data.frame(matrix(nrow=length(water.temp.year),ncol=1))
for(i in 1:length(water.temp.year)){
    median.watertemp.max.year[i,1] <- median(FallingRock$tempmax[which(FallingRock$year==water.temp.year[i])],na.rm=TRUE)
}

colnames(median.watertemp.max.year) <- c('median.watertemp')
median.watertemp.max.year$year <- water.temp.year
median.watertemp.max.year <- na.omit(median.watertemp.max.year)
max.watertemp.senslope.year <- sens.output(time.step=median.watertemp.max.year$year,data=median.watertemp.max.year$median.watertemp)
max.watertemp.senslope.year$year <- "Calendar.Year"

ggplot(FR.Water, aes(factor(year), max)) +
  geom_boxplot() +
  geom_abline(data=max.watertemp.senslope.year, aes(slope=slope, intercept=17))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ylim(-10,50)+
  ggtitle("Falling Rock Maximum Annual Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
max.watertemp.season <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(watertemp.season)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(watertemp.season)){
    max.watertemp.season[i,j] <- mean(FallingRock$tempmax[which(FallingRock$year==water.temp.year[i]&FallingRock$season==watertemp.season[j])],na.rm=TRUE)
  }
}
median.watertemp.max.season <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(watertemp.season)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(watertemp.season)){
    median.watertemp.max.season[i,j] <- median(FallingRock$tempmax[which(FallingRock$year==water.temp.year[i]&FallingRock$season==watertemp.season[j])],na.rm=TRUE)
  }
}
colnames(median.watertemp.max.season) <- seasons
median.watertemp.max.season$year <- water.temp.year
median.watertemp.max.season <- na.omit(median.watertemp.max.season)

max.watertemp.senslope.winter <- sens.output(time.step=median.watertemp.max.season$year,data=median.watertemp.max.season$Winter)
max.watertemp.senslope.spring <- sens.output(time.step=median.watertemp.max.season$year,data=median.watertemp.max.season$Spring)
max.watertemp.senslope.summer <- sens.output(time.step=median.watertemp.max.season$year,data=median.watertemp.max.season$Summer)
max.watertemp.senslope.autumn <- sens.output(time.step=median.watertemp.max.season$year,data=median.watertemp.max.season$Autumn)
max.watertemp.senslope.season <- rbind(max.watertemp.senslope.winter,max.watertemp.senslope.spring,max.watertemp.senslope.summer,max.watertemp.senslope.autumn)
max.watertemp.senslope.season$season <- unique(FallingRock$season)

ggplot(FR.Water, aes(factor(year), max, fill=season)) +
  geom_boxplot() +
  geom_abline(data=max.watertemp.senslope.season, aes(slope=slope, intercept=17))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  facet_wrap(~season)+
  ggtitle("Falling Rock Maximum Seasonal Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

#Monthly
max.watertemp.month <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(water.temp.month)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(water.temp.month)){
    mean.watertemp.month[i,j] <- mean(FallingRock$tempmax[which(FallingRock$year==water.temp.year[i]&FallingRock$month==water.temp.month[j])],na.rm=TRUE)
  }}

median.watertemp.max.month <- data.frame(matrix(nrow=length(water.temp.year),ncol=length(water.temp.month)))
for(i in 1:length(water.temp.year)){
  for(j in 1:length(water.temp.month)){
    median.watertemp.max.month[i,j] <- median(FallingRock$tempmax[which(FallingRock$year==water.temp.year[i]&FallingRock$month==water.temp.month[j])],na.rm=TRUE)
  }
}
colnames(median.watertemp.max.month) <- unique(FallingRock$Month)
median.watertemp.max.month$year <- water.temp.year
median.watertemp.max.month <- na.omit(median.watertemp.max.month)

max.watertemp.senslope.jan <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$January)
max.watertemp.senslope.feb <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$February)
max.watertemp.senslope.mar <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$March)
max.watertemp.senslope.apr <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$April)
max.watertemp.senslope.may <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$May)
max.watertemp.senslope.jun <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$June)
max.watertemp.senslope.jul <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$July)
max.watertemp.senslope.aug <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$August)
max.watertemp.senslope.sep <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$September)
max.watertemp.senslope.oct <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$October)
max.watertemp.senslope.nov <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$November)
max.watertemp.senslope.dec <- sens.output(time.step=median.watertemp.max.month$year,data=median.watertemp.max.month$December)
max.watertemp.senslope.month <- rbind(max.watertemp.senslope.jan,max.watertemp.senslope.feb,max.watertemp.senslope.mar,max.watertemp.senslope.apr,max.watertemp.senslope.may,max.watertemp.senslope.jun,max.watertemp.senslope.jul,max.watertemp.senslope.aug,max.watertemp.senslope.sep,max.watertemp.senslope.oct,max.watertemp.senslope.nov,max.watertemp.senslope.dec)
max.watertemp.senslope.month$Month <- unique(FallingRock$Month)

ggplot(FR.Water, aes(factor(year), max, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=max.watertemp.senslope.month, aes(slope=slope, intercept=17))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Falling Rock Maximum Monthly Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 4), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

### Section 3.6.1: Maximum Water Temperature Statistical Summary
```{r}
FR.Max.watertemp.statistical.summary <- rbind.fill(max.watertemp.senslope.halfdec,max.watertemp.senslope.year,max.watertemp.senslope.season,max.watertemp.senslope.month)
```

# Section 5: Thresholds of Flow Duration Curves

### Section 5.1: No Flow Days
```{r}
#1/2 Decade
noflow.half.decs <- unique(FallingRock$half.decade)
noflow.half.dec <- data.frame(matrix(nrow=length(noflow.half.decs),ncol=1))

for(i in 1:length(unique(FallingRock$half.decade))){
  Q.half.dec<-FallingRock[which(FallingRock$half.decade==noflow.half.decs[i]),]
  noflow.half.dec[i,1]<-sum(ifelse(na.omit(Q.half.dec$meandaily_CFS)==0,1,0))
  colnames(noflow.half.dec) <- c("No.Flow.Days")
}
noflow.half.dec$half.decade <- noflow.half.decs
nf.senslope.halfdec <- sens.output(time.step=noflow.half.dec$half.decade,data=noflow.half.dec$No.Flow.Days)
nf.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(data=noflow.half.dec, mapping=aes(x=half.decade, y=No.Flow.Days))+
  geom_bar(stat="identity")+
  geom_abline(data=nf.senslope.halfdec, aes(slope=slope, intercept=125))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("Number of No-Flow Days")+
  ggtitle("Falling Rock Half Decadal No-Flow Days")

#Yearly
#Calendar Year
zero.flow.year <- unique(FallingRock$year)

yearly.noflow.days<- data.frame("zero.flow"=matrix(nrow=length(years),ncol=1))
for(i in 1:length(unique(FallingRock$year))){
  Q.year<-FallingRock[which(FallingRock$year==years[i]),]
  yearly.noflow.days[i,1]<-sum(ifelse(na.omit(Q.year$meandaily_CFS)==0,1,0))
}
yearly.noflow.days$year <- years
yearly.noflow.days$year <- as.numeric(yearly.noflow.days$year)
yearly.noflow.days <- na.omit(yearly.noflow.days)
nf.senslope.year <- sens.output(time.step=yearly.noflow.days$year,data=yearly.noflow.days$zero.flow)
nf.senslope.year$year <- "Calendar.Year"

ggplot(yearly.noflow.days, aes(factor(year), zero.flow)) +
  geom_bar(stat="identity")+
  geom_abline(data=nf.senslope.year, aes(slope=slope, intercept=30))+
  scale_x_discrete(breaks=c("1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Falling Rock Yearly No-Flow Days")

#Water Year
zero.flow.wateryear <- unique(FallingRock$Climate_Year)

wateryearly.noflow.days<- data.frame("zero.flow"=matrix(nrow=length(zero.flow.wateryear),ncol=1))
for(i in 1:length(unique(FallingRock$Climate_Year))){
  Q.wateryear<-FallingRock[which(FallingRock$Climate_Year==years[i]),]
  wateryearly.noflow.days[i,1]<-sum(ifelse(na.omit(Q.wateryear$meandaily_CFS)==0,1,0))
}
wateryearly.noflow.days$Climate_Year <- unique(FallingRock$Climate_Year)
wateryearly.noflow.days <- na.omit(wateryearly.noflow.days)
nf.senslope.wateryear <- sens.output(time.step=wateryearly.noflow.days$Climate_Year,data=wateryearly.noflow.days$zero.flow)
nf.senslope.wateryear$year <- "Water.Year"

ggplot(wateryearly.noflow.days, aes(factor(Climate_Year), zero.flow)) +
  geom_bar(stat="identity")+
  geom_abline(data=nf.senslope.wateryear, aes(slope=slope, intercept=30))+
  scale_x_discrete(breaks=c("1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Falling Rock Yearly No-Flow Days Using Water Year")

#Climate Year
zero.flow.climateyear <- unique(FallingRock$Climate_Year)

climateyearly.noflow.days<- data.frame("zero.flow"=matrix(nrow=length(zero.flow.climateyear),ncol=1))
for(i in 1:length(unique(FallingRock$Climate_Year))){
  Q.climateyear<-FallingRock[which(FallingRock$Climate_Year==years[i]),]
  climateyearly.noflow.days[i,1]<-sum(ifelse(na.omit(Q.climateyear$meandaily_CFS)==0,1,0))
}
climateyearly.noflow.days$Climate_Year <- unique(FallingRock$Climate_Year)
climateyearly.noflow.days <- na.omit(climateyearly.noflow.days)
nf.senslope.climateyear <- sens.output(time.step=climateyearly.noflow.days$Climate_Year,data=climateyearly.noflow.days$zero.flow)
nf.senslope.climateyear$year <- "Climate.Year"

ggplot(climateyearly.noflow.days, aes(factor(Climate_Year), zero.flow)) +
  geom_bar(stat="identity")+
  geom_abline(data=nf.senslope.climateyear, aes(slope=slope, intercept=30))+
  scale_x_discrete(breaks=c("1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Falling Rock Yearly No-Flow Days Using Climate Year")

#Seasonal
zero.flow.season <- unique(FallingRock$season)

seasonal.noflow.days <- data.frame(matrix(nrow=length(zero.flow.year),ncol=length(zero.flow.season)))

for(i in 1:length(unique(FallingRock$year))){
  for(j in 1:length(unique(FallingRock$season))){
    Q.year <- FallingRock[which(FallingRock$year==years[i]),]
    Q.season <- FallingRock[which(FallingRock$season==zero.flow.season[j]),]
  seasonal.noflow.days[i,j]<-sum(ifelse(FallingRock$meandaily_CFS[which(FallingRock$year==zero.flow.year[i]&FallingRock$season==zero.flow.season[j])]==0,1,0))}
  colnames(seasonal.noflow.days) <- c("Winter","Spring","Summer","Autumn")
}
seasonal.noflow.days$year <- as.numeric(unique(FallingRock$year))
seasonal.noflow.days <- na.omit(seasonal.noflow.days)

nf.senslope.winter <- sens.output(time.step=seasonal.noflow.days$year,data=seasonal.noflow.days$Winter)
nf.senslope.spring <- sens.output(time.step=seasonal.noflow.days$year,data=seasonal.noflow.days$Spring)
nf.senslope.summer <- sens.output(time.step=seasonal.noflow.days$year,data=seasonal.noflow.days$Summer)
nf.senslope.autumn <- sens.output(time.step=seasonal.noflow.days$year,data=seasonal.noflow.days$Autumn)
nf.senslope.season <- rbind(nf.senslope.winter,nf.senslope.spring,nf.senslope.summer,nf.senslope.autumn)
nf.senslope.season$season <- c("Winter","Spring","Summer","Autumn")

zeroflow.season.long <- gather(seasonal.noflow.days, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
season <- c("Winter","Spring","Summer","Autumn")

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.NF.jpeg", width=750)
ggplot(zeroflow.season.long, aes(factor(year), value)) +
  geom_bar(stat="identity")+
  geom_abline(data=nf.senslope.season, aes(slope=slope, intercept=15))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(season))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Falling Rock Seasonal No-Flow Days")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Monthly
zero.flow.month <- unique(FallingRock$month)

monthly.noflow.days <- data.frame(matrix(nrow=length(zero.flow.year),ncol=length(zero.flow.month)))
for(i in 1:length(unique(FallingRock$year))){
  for(j in 1:length(unique(FallingRock$month))){
    Q.year <- FallingRock[which(FallingRock$year==years[i]),]
    Q.month <- FallingRock[which(FallingRock$month==zero.flow.month[j]),]
  monthly.noflow.days[i,j]<-sum(ifelse(FallingRock$meandaily_CFS[which(FallingRock$year==zero.flow.year[i]&FallingRock$month==zero.flow.month[j])]==0,1,0))}
}
colnames(monthly.noflow.days) <- c("January", "February", "March", "April", "May", "June","July","August","September","October", "November", "December")

monthly.noflow.days$year <- as.numeric(unique(FallingRock$year))
monthly.noflow.days$year <- as.numeric(monthly.noflow.days$year)
monthly.noflow.days <- na.omit(monthly.noflow.days)

nf.senslope.jan <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$January)
nf.senslope.feb <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$February)
nf.senslope.mar <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$March)
nf.senslope.apr <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$April)
nf.senslope.may <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$May)
nf.senslope.jun <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$June)
nf.senslope.jul <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$July)
nf.senslope.aug <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$August)
nf.senslope.sep <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$September)
nf.senslope.oct <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$October)
nf.senslope.nov <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$November)
nf.senslope.dec <- sens.output(time.step=monthly.noflow.days$year,data=monthly.noflow.days$December)
nf.senslope.month <- rbind(nf.senslope.jan,nf.senslope.feb,nf.senslope.mar,nf.senslope.apr,nf.senslope.may,nf.senslope.jun,nf.senslope.jul,nf.senslope.aug,nf.senslope.sep,nf.senslope.oct,nf.senslope.nov,nf.senslope.dec)
nf.senslope.month$Month <- unique(FallingRock$Month)
zeroflow.month.long <- gather(monthly.noflow.days, key="Month", value="value", c("July", "August","September","October","November","December","January","February","March","April","May","June"))
zeroflow.month.long <- na.omit(zeroflow.month.long)

ggplot(zeroflow.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=nf.senslope.month, aes(slope=slope, intercept=5))+
  xlim(1980,2008)+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Falling Rock Monthly No-Flow Days")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
  

```

#### Section 5.1.1: No Flow Days Statistical Summary
```{r}
FR.NFD.statistical.summary <- rbind.fill(nf.senslope.halfdec,nf.senslope.year,nf.senslope.wateryear,nf.senslope.climateyear,nf.senslope.season,nf.senslope.month)
```

## Flow Duration
##Section 5.2: 90% Flow Exceeded

In this section we are finding the number of days that have a minimum flow less than or equal to Q90 (0.01 cfs). This is done by ranking the flow values for the entire time series from high to low and assigning each value a probability from 0%-100%. Afterwards, Q90 is determined by selecting the flow value associated with 90% of flow greater than it. The values that fell below the 90% cutoff were selected and plotted on half-decadal, yearly, seasonal, and monthly scales. 
```{r}
#Timeseries
Rank.flow.min <- data.frame("sort.data"=sort(FallingRock$mindaily_CFS,decreasing = TRUE))
#sorting the data in decreasing order
Rank.flow.min$rank <- 1:length(Rank.flow.min$sort.data)
#adding a rank to the flows in the data frame
Rank.flow.min$probability <- ((Rank.flow.min$rank)/(length(Rank.flow.min$rank)))*100
# adding the probability of the flows
years <- unique(FallingRock$year)
#creating another column for the year
Flow.ninety <- Rank.flow.min$sort.data[which.min(abs(Rank.flow.min$probability-90))]#ranking the data and taking out the data <90% discharge
ten.percent.flow <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
#making a new data frame with the <90% data
percent.below.ten <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
for(i in 1:length(unique(FallingRock$year))){
Q.year<-FallingRock[which(FallingRock$year==years[i]),]
ten.percent.flow[i]<-sum(ifelse(na.omit(Q.year$mindaily_CFS)<=Flow.ninety,1,0))
#Dentoing which flows are <90%
percent.below.ten[i]<-(ten.percent.flow[i]/length(na.omit(Q.year$mindaily_CFS)))*100
}
# establishing the discharge where only 10% of flow exceeds that rate
ten.percent.flow <- data.frame("ten.percent"=ten.percent.flow,"year"=unique(FallingRock$year))
# creating a matrix to report the 5% exceeded values

#Half-Decadal
Half.decade <- unique(FallingRock$half.decade)
# Initialize the number of days with flow less than or equal to the 90% threshold flow
days.exceeding.ninety.decade <- data.frame(matrix(nrow=length(Half.decade),ncol=1))
colnames(days.exceeding.ninety.decade) <- "Number_Days"
rownames(days.exceeding.ninety.decade) <- Half.decade

for (i in 1:length(Half.decade)) {
    
    subset.decades <- FallingRock[which(FallingRock$half.decade==Half.decade[i]),]
    
    days.exceeding.ninety.decade[i,1] <- sum(ifelse(na.omit(subset.decades$mindaily_CFS)<=Flow.ninety,1,0))
}
days.exceeding.ninety.decade$halfdec <- half.decades

ninety.senslope.halfdec <- sens.output(time.step=days.exceeding.ninety.decade$halfdec,data=days.exceeding.ninety.decade$Number_Days)
ninety.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
days.exceeding.ninety.year <- data.frame(matrix(nrow=length(years),ncol=1))
colnames(days.exceeding.ninety.year) <- "Number_Days"

for (i in 1:length(years)) {
    subset.years <- FallingRock[which(FallingRock$year==years[i]),]
    days.exceeding.ninety.year[i,1] <- sum(ifelse(na.omit(subset.years$mindaily_CFS)<=Flow.ninety,1,0))
}
days.exceeding.ninety.year$year <- as.numeric(years)
ninety.senslope.year <- sens.output(time.step=days.exceeding.ninety.year$year,data=days.exceeding.ninety.year$Number_Days)
ninety.senslope.year$year <- "Calendar.Year"

#Water Year
water.years <- unique(FallingRock$Water_Year)
days.exceeding.ninety.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1))
colnames(days.exceeding.ninety.wateryear) <- "Number_Days"

for (i in 1:length(water.years)) {
    subset.years <- FallingRock[which(FallingRock$Water_Year==water.years[i]),]
    days.exceeding.ninety.wateryear[i,1] <- sum(ifelse(na.omit(subset.years$mindaily_CFS)<=Flow.ninety,1,0))
}
days.exceeding.ninety.wateryear$Water_Year <- unique(FallingRock$Water_Year)
ninety.senslope.wateryear <- sens.output(time.step=days.exceeding.ninety.wateryear$Water_Year,data=days.exceeding.ninety.wateryear$Number_Days)
ninety.senslope.wateryear$year <- "Water.Year"

#Climate Year
climate.years <- unique(FallingRock$Climate_Year)
days.exceeding.ninety.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1))
colnames(days.exceeding.ninety.climateyear) <- "Number_Days"

for (i in 1:length(climate.years)) {
    subset.years <- FallingRock[which(FallingRock$Climate_Year==climate.years[i]),]
    days.exceeding.ninety.climateyear[i,1] <- sum(ifelse(na.omit(subset.years$mindaily_CFS)<=Flow.ninety,1,0))
}
days.exceeding.ninety.climateyear$Climate_Year <- unique(FallingRock$Climate_Year)
ninety.senslope.climateyear <- sens.output(time.step=days.exceeding.ninety.climateyear$Climate_Year,data=days.exceeding.ninety.climateyear$Number_Days)
ninety.senslope.climateyear$year <- "Climate.Year"

#Seasonal
days.exceeding.ninety.season <- data.frame(matrix(nrow=length(as.numeric(years)),ncol=length(unique(FallingRock$season))))
colnames(days.exceeding.ninety.season) <- c("Winter","Spring","Summer","Autumn")
seasons <- unique(FallingRock$season)

for (i in 1:length(years)) {
    for (j in 1:length(seasons)){
    days.exceeding.ninety.season[i,j] <- sum(ifelse(FallingRock$mindaily_CFS[which(FallingRock$year==years[i]&FallingRock$season==seasons[j])]<=Flow.ninety,1,0))
    }
}

days.exceeding.ninety.season$year <- years
days.exceeding.ninety.season <- na.omit(days.exceeding.ninety.season)

ninety.senslope.winter <- sens.output(time.step=days.exceeding.ninety.season$year,data=days.exceeding.ninety.season$Winter)
ninety.senslope.spring <- sens.output(time.step=days.exceeding.ninety.season$year,data=days.exceeding.ninety.season$Spring)
ninety.senslope.summer <- sens.output(time.step=days.exceeding.ninety.season$year,data=days.exceeding.ninety.season$Summer)
ninety.senslope.autumn <- sens.output(time.step=days.exceeding.ninety.season$year,data=days.exceeding.ninety.season$Autumn)
ninety.senslope.season <- rbind(ninety.senslope.winter,ninety.senslope.spring,ninety.senslope.summer,ninety.senslope.autumn)
ninety.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
months <- unique(FallingRock$month)
days.exceeding.ninety.month <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$month))))
colnames(days.exceeding.ninety.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(years)) {
    for (j in 1:length(months)){
    days.exceeding.ninety.month[i,j] <- sum(ifelse(FallingRock$mindaily_CFS[which(FallingRock$year==years[i]&FallingRock$month==months[j])]<=Flow.ninety,1,0))
    }
}
days.exceeding.ninety.month$year <- years
days.exceeding.ninety.month <- na.omit(days.exceeding.ninety.month)

ninety.senslope.jan <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$January)
ninety.senslope.feb <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$February)
ninety.senslope.mar <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$March)
ninety.senslope.apr <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$April)
ninety.senslope.may <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$May)
ninety.senslope.jun <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$June)
ninety.senslope.jul <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$July)
ninety.senslope.aug <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$August)
ninety.senslope.sep <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$September)
ninety.senslope.oct <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$October)
ninety.senslope.nov <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$November)
ninety.senslope.dec <- sens.output(time.step=days.exceeding.ninety.month$year,data=days.exceeding.ninety.month$December)
ninety.senslope.month <- rbind(ninety.senslope.jan,ninety.senslope.feb,ninety.senslope.mar,ninety.senslope.apr,ninety.senslope.may,ninety.senslope.jun,ninety.senslope.jul,ninety.senslope.aug,ninety.senslope.sep,ninety.senslope.oct,ninety.senslope.nov,ninety.senslope.dec)
ninety.senslope.month$Month <- unique(FallingRock$Month)

```
####Section 5.2.1: 90% Flow Exceedence Plots
```{r}
#Half-Decadal
ggplot(data=days.exceeding.ninety.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=ninety.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Falling Rock Half-Decadal Days With Flow Less Than Q90")

#yearly
ggplot(data=days.exceeding.ninety.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=ninety.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q90")

ggplot(data=days.exceeding.ninety.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=ninety.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q90 Using Water Year")

ggplot(data=days.exceeding.ninety.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=ninety.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q90 Using Climate Year")
#seasonal
days.exceeding.ninety.season.long <- gather(days.exceeding.ninety.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
days.exceeding.ninety.season.long <- na.omit(days.exceeding.ninety.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR90.cal.jpeg", width=750)
ggplot(days.exceeding.ninety.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=ninety.senslope.season, aes(slope=slope, intercept=10))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Falling Rock Seasonal Days With Flow Less Than Q90")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
days.exceeding.ninety.month.long <- gather(days.exceeding.ninety.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
days.exceeding.ninety.month.long <- na.omit(days.exceeding.ninety.month.long)

ggplot(days.exceeding.ninety.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=ninety.senslope.month, aes(slope=slope, intercept=5))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Falling Rock Monthly Days With Flow Less Than Q90")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

#### Section 5.2.2: 90% Flow Exceeded Statistical Summary
```{r}
FR.ninety.statistical.summary <- rbind.fill(ninety.senslope.halfdec,ninety.senslope.year,ninety.senslope.wateryear,ninety.senslope.climateyear,ninety.senslope.season,ninety.senslope.month)
```


## Section 5.3: 75% Flow

In this section we are finding the number of days that have a minimum flow less than or equal to Q75 (0.03 cfs). This is done by ranking the flow values for the entire time series from high to low and assigning each value a probability from 0%-100%. Afterwards, Q75 is determined by selecting the flow value associated with 75% of flow greater than it. The values that fell below the 75% cutoff were selected and plotted on half-decadal, yearly, seasonal, and monthly scales. 
```{r}
#Timeseries
Flow.seventy.five <- Rank.flow.min$sort.data[which.min(abs(Rank.flow.min$probability-75))]
#ranking the data and taking out the data <75% discharge
twenty.five.percent.flow <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
#making a new data frame with the <750% data
percent.below.twenty.five <- matrix(nrow=length(unique(FallingRock$year)),ncol=1) #adding the years to the data frame
for(i in 1:length(unique(FallingRock$year))){ #running a for loop through the entire series
Q.year<-FallingRock[which(FallingRock$year==years[i]),]
twenty.five.percent.flow[i]<-sum(ifelse(na.omit(Q.year$mindaily_CFS)<=Flow.seventy.five,1,0))
#Dentoing which flows are <75%
percent.below.twenty.five[i]<-(twenty.five.percent.flow[i]/length(na.omit(Q.year$mindaily_CFS)))*100
}
# establishing the discharge where only 25% of flow exceeds that rate
twenty.five.percent.flow <- data.frame("twenty.five.percent"=twenty.five.percent.flow,"year"=unique(FallingRock$year))
#making a data frame with desired flow data and corresponding year

#Half-Decadal
# Initialize the number of days with flow less than or equal to the 75% threshold flow
days.exceeding.seventyfive.decade <- data.frame(matrix(nrow=length(Half.decade),ncol=1))
colnames(days.exceeding.seventyfive.decade) <- "Number_Days"
rownames(days.exceeding.seventyfive.decade) <- Half.decade
for (i in 1:length(Half.decade)) {
    
    subset.decades <- FallingRock[which(FallingRock$half.decade==Half.decade[i]),]
    
    days.exceeding.seventyfive.decade[i,1] <- sum(ifelse(na.omit(subset.decades$mindaily_CFS)<=Flow.seventy.five,1,0))
}
days.exceeding.seventyfive.decade$halfdec <- half.decades

seventyfive.senslope.halfdec <- sens.output(time.step=days.exceeding.seventyfive.decade$halfdec,data=days.exceeding.seventyfive.decade$Number_Days)
seventyfive.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
days.exceeding.seventyfive.year <- data.frame(matrix(nrow=length(years),ncol=1))
colnames(days.exceeding.seventyfive.year) <- "Number_Days"

for (i in 1:length(years)) {
    subset.years <- FallingRock[which(FallingRock$year==years[i]),]
    days.exceeding.seventyfive.year[i,1] <- sum(ifelse(na.omit(subset.years$mindaily_CFS)<=Flow.seventy.five,1,0))
}
days.exceeding.seventyfive.year$year <- as.numeric(years)
seventyfive.senslope.year <- sens.output(time.step=days.exceeding.seventyfive.year$year,data=days.exceeding.seventyfive.year$Number_Days)
seventyfive.senslope.year$year <- "Calendar.Year"

#Water Year
days.exceeding.seventyfive.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1))
colnames(days.exceeding.seventyfive.wateryear) <- "Number_Days"

for (i in 1:length(water.years)) {
    subset.wateryears <- FallingRock[which(FallingRock$Water_Year==water.years[i]),]
    days.exceeding.seventyfive.wateryear[i,1] <- sum(ifelse(na.omit(subset.wateryears$mindaily_CFS)<=Flow.seventy.five,1,0))
}
days.exceeding.seventyfive.wateryear$Water_Year <- water.years
seventyfive.senslope.wateryear <- sens.output(time.step=days.exceeding.seventyfive.wateryear$Water_Year,data=days.exceeding.seventyfive.wateryear$Number_Days)
seventyfive.senslope.wateryear$year <- "Water.Year"

#Climate Year
days.exceeding.seventyfive.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1))
colnames(days.exceeding.seventyfive.climateyear) <- "Number_Days"

for (i in 1:length(climate.years)) {
    subset.climateyears <- FallingRock[which(FallingRock$Climate_Year==climate.years[i]),]
    days.exceeding.seventyfive.climateyear[i,1] <- sum(ifelse(na.omit(subset.climateyears$mindaily_CFS)<=Flow.seventy.five,1,0))
}
days.exceeding.seventyfive.climateyear$Climate_Year <- climate.years
seventyfive.senslope.climateyear <- sens.output(time.step=days.exceeding.seventyfive.climateyear$Climate_Year,data=days.exceeding.seventyfive.climateyear$Number_Days)
seventyfive.senslope.climateyear$year <- "Climate.Year"

#Seasonal
days.exceeding.seventyfive.season <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$season))))
colnames(days.exceeding.seventyfive.season) <- c("Summer","Autumn","Winter","Spring")
seasons <- unique(FallingRock$season)

for (i in 1:length(years)) {
    for (j in 1:length(seasons)){
    days.exceeding.seventyfive.season[i,j]<-sum(ifelse(FallingRock$mindaily_CFS[which(FallingRock$year==years[i]&FallingRock$season==seasons[j])]>=Flow.seventy.five,1,0))
    }
}
days.exceeding.seventyfive.season$year <- years
days.exceeding.seventyfive.season <- na.omit(days.exceeding.seventyfive.season)

seventyfive.senslope.winter <- sens.output(time.step=days.exceeding.seventyfive.season$year,data=days.exceeding.seventyfive.season$Winter)
seventyfive.senslope.spring <- sens.output(time.step=days.exceeding.seventyfive.season$year,data=days.exceeding.seventyfive.season$Spring)
seventyfive.senslope.summer <- sens.output(time.step=days.exceeding.seventyfive.season$year,data=days.exceeding.seventyfive.season$Summer)
seventyfive.senslope.autumn <- sens.output(time.step=days.exceeding.seventyfive.season$year,data=days.exceeding.seventyfive.season$Autumn)
seventyfive.senslope.season <- rbind(seventyfive.senslope.winter,seventyfive.senslope.spring,seventyfive.senslope.summer,seventyfive.senslope.autumn)
seventyfive.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
months <- unique(FallingRock$month)
days.exceeding.seventyfive.month <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$month))))
colnames(days.exceeding.seventyfive.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(years)) {
    for (j in 1:length(months)){
    days.exceeding.seventyfive.month[i,j] <- sum(ifelse(FallingRock$mindaily_CFS[which(FallingRock$year==years[i]&FallingRock$month==months[j])]<=Flow.seventy.five,1,0))
    }
}
days.exceeding.seventyfive.month$year <- as.numeric(years)
days.exceeding.seventyfive.month <- na.omit(days.exceeding.seventyfive.month)

seventyfive.senslope.jan <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$January)
seventyfive.senslope.feb <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$February)
seventyfive.senslope.mar <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$March)
seventyfive.senslope.apr <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$April)
seventyfive.senslope.may <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$May)
seventyfive.senslope.jun <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$June)
seventyfive.senslope.jul <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$July)
seventyfive.senslope.aug <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$August)
seventyfive.senslope.sep <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$September)
seventyfive.senslope.oct <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$October)
seventyfive.senslope.nov <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$November)
seventyfive.senslope.dec <- sens.output(time.step=days.exceeding.seventyfive.month$year,data=days.exceeding.seventyfive.month$December)
seventyfive.senslope.month <- rbind(seventyfive.senslope.jan,seventyfive.senslope.feb,seventyfive.senslope.mar,seventyfive.senslope.apr,seventyfive.senslope.may,seventyfive.senslope.jun,seventyfive.senslope.jul,seventyfive.senslope.aug,seventyfive.senslope.sep,seventyfive.senslope.oct,seventyfive.senslope.nov,seventyfive.senslope.dec)
seventyfive.senslope.month$Month <- unique(FallingRock$Month)

```

#### Section 5.3.1: 75% Flow Exceedence Plots
```{r}
#Half-Decadal
ggplot(data=days.exceeding.seventyfive.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=seventyfive.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Falling Rock Half-Decadal Days With Flow Less Than Q75")

#yearly
ggplot(data=days.exceeding.seventyfive.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=seventyfive.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q75")

#Water Year
ggplot(data=days.exceeding.seventyfive.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=seventyfive.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q75 Using Water Year")

#Climate Year
ggplot(data=days.exceeding.seventyfive.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=seventyfive.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Climate Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q75 Using Climate Year")

#seasonal
days.exceeding.seventyfive.season.long <- gather(days.exceeding.seventyfive.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
days.exceeding.seventyfive.season.long <- na.omit(days.exceeding.seventyfive.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR75.cal.jpeg", width=750)
ggplot(days.exceeding.seventyfive.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=seventyfive.senslope.season, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Falling Rock Seasonal Days With Flow Less Than Q75")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
days.exceeding.seventyfive.month.long <- gather(days.exceeding.seventyfive.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
days.exceeding.seventyfive.month.long <- na.omit(days.exceeding.seventyfive.month.long)

ggplot(days.exceeding.seventyfive.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=seventyfive.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Falling Rock Monthly Days With Flow Less Than Q75")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```
#### Section 5.3.2: 75% Flow Exceeded Statistical Summary
```{r}
FR.seventyfive.statistical.summary <- rbind.fill(seventyfive.senslope.halfdec,seventyfive.senslope.year,seventyfive.senslope.wateryear,seventyfive.senslope.climateyear,seventyfive.senslope.season,seventyfive.senslope.month)
```

## Section 5.4: 50% exceeded

In this section we are finding the number of days that have a mean flow less than or equal to Q50 (0.24 cfs). This is done by ranking the flow values for the entire time series from high to low and assigning each value a probability from 0%-100%. Afterwards, Q50 is determined by selecting the flow value associated with 50% of flow greater than it. The values that fell below the 50% cutoff were selected and plotted on half-decadal, yearly, seasonal, and monthly scales. 
```{r}
#Timeseries (Daily)
Rank.flow.mean <- data.frame("sort.data"=sort(FallingRock$meandaily_CFS,decreasing = TRUE))
#sorting the data in decreasing order
Rank.flow.mean$rank <- 1:length(Rank.flow.mean$sort.data)
#adding a rank to the flows in the data frame
Rank.flow.mean$probability <- ((Rank.flow.mean$rank)/(length(Rank.flow.mean$rank)))*100
# adding the probability of the flows
Flow.fifty <- Rank.flow.mean$sort.data[which.min(abs(Rank.flow.mean$probability-50))]
#ranking the data and taking out the data <50% discharge
fifty.percent.flow <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
#making a new data frame with the <50% data
percent.below.fifty <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
for(i in 1:length(unique(FallingRock$year))){
Q.year<-FallingRock[which(FallingRock$year==years[i]),]
fifty.percent.flow[i]<-sum(ifelse(na.omit(Q.year$meandaily_CFS)<=Flow.fifty,1,0))
#Dentoing which flows are <50%
percent.below.fifty[i]<-(fifty.percent.flow[i]/length(na.omit(Q.year$meandaily_CFS)))*100
}
# establishing the discharge where only 50% of flow exceeds that rate
fifty.percent.flow <- data.frame("fifty.percent"=fifty.percent.flow,"year"=unique(FallingRock$year))
#making a data frame with desired flow data and corresponding year

#Half-Decadal
# Initialize the number of days with flow less than or equal to the 50% threshold flow
days.exceeding.fifty.decade <- data.frame(matrix(nrow=length(Half.decade),ncol=1))
colnames(days.exceeding.fifty.decade) <- "Number_Days"
rownames(days.exceeding.fifty.decade) <- Half.decade
for (i in 1:length(Half.decade)) {
    
    subset.decades <- FallingRock[which(FallingRock$half.decade==Half.decade[i]),]
    
    days.exceeding.fifty.decade[i,1] <- sum(ifelse(na.omit(subset.decades$meandaily_CFS)<=Flow.fifty,1,0))
}
days.exceeding.fifty.decade$halfdec <- half.decades

fifty.senslope.halfdec <- sens.output(time.step=days.exceeding.fifty.decade$halfdec,data=days.exceeding.fifty.decade$Number_Days)
fifty.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
days.exceeding.fifty.year <- data.frame(matrix(nrow=length(years),ncol=1))
colnames(days.exceeding.fifty.year) <- "Number_Days"

for (i in 1:length(years)) {
    subset.years <- FallingRock[which(FallingRock$year==years[i]),]
    days.exceeding.fifty.year[i,1] <- sum(ifelse(na.omit(subset.years$meandaily_CFS)<=Flow.fifty,1,0))
}
days.exceeding.fifty.year$year <- years
fifty.senslope.year <- sens.output(time.step=days.exceeding.fifty.year$year,data=days.exceeding.fifty.year$Number_Days)
fifty.senslope.year$year <- "Calendar.Year"

#Water Year
days.exceeding.fifty.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1))
colnames(days.exceeding.fifty.wateryear) <- "Number_Days"

for (i in 1:length(water.years)) {
    subset.wateryears <- FallingRock[which(FallingRock$Water_Year==water.years[i]),]
    days.exceeding.fifty.wateryear[i,1] <- sum(ifelse(na.omit(subset.wateryears$meandaily_CFS)<=Flow.fifty,1,0))
}
days.exceeding.fifty.wateryear$Water_Year <- water.years
fifty.senslope.wateryear <- sens.output(time.step=days.exceeding.fifty.wateryear$Water_Year,data=days.exceeding.fifty.wateryear$Number_Days)
fifty.senslope.wateryear$year <- "Water.year"

#Climate Year
days.exceeding.fifty.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1))
colnames(days.exceeding.fifty.climateyear) <- "Number_Days"

for (i in 1:length(climate.years)) {
    subset.climateyears <- FallingRock[which(FallingRock$Climate_Year==climate.years[i]),]
    days.exceeding.fifty.climateyear[i,1] <- sum(ifelse(na.omit(subset.climateyears$meandaily_CFS)<=Flow.fifty,1,0))
}
days.exceeding.fifty.climateyear$Climate_Year <- climate.years
fifty.senslope.climateyear <- sens.output(time.step=days.exceeding.fifty.climateyear$Climate_Year,data=days.exceeding.fifty.climateyear$Number_Days)
fifty.senslope.climateyear$year <- "Climate.Year"

#Seasonal
days.exceeding.fifty.season <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$season))))
colnames(days.exceeding.fifty.season) <- c("Winter","Spring","Summer","Autumn")
seasons <- unique(FallingRock$season)

for (i in 1:length(years)) {
    for (j in 1:length(seasons)){
    days.exceeding.fifty.season[i,j]<-sum(ifelse(FallingRock$meandaily_CFS[which(FallingRock$year==years[i]&FallingRock$season==seasons[j])]<=Flow.fifty,1,0))
    }
}
days.exceeding.fifty.season$year <- years
days.exceeding.fifty.season <- na.omit(days.exceeding.fifty.season)

fifty.senslope.winter <- sens.output(time.step=days.exceeding.fifty.season$year,data=days.exceeding.fifty.season$Winter)
fifty.senslope.spring <- sens.output(time.step=days.exceeding.fifty.season$year,data=days.exceeding.fifty.season$Spring)
fifty.senslope.summer <- sens.output(time.step=days.exceeding.fifty.season$year,data=days.exceeding.fifty.season$Summer)
fifty.senslope.autumn <- sens.output(time.step=days.exceeding.fifty.season$year,data=days.exceeding.fifty.season$Autumn)
fifty.senslope.season <- rbind(fifty.senslope.winter,fifty.senslope.spring,fifty.senslope.summer,fifty.senslope.autumn)
fifty.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
months <- unique(FallingRock$month)
days.exceeding.fifty.month <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$month))))
colnames(days.exceeding.fifty.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(years)) {
    for (j in 1:length(months)){
    days.exceeding.fifty.month[i,j] <- sum(ifelse(FallingRock$meandaily_CFS[which(FallingRock$year==years[i]&FallingRock$month==months[j])]<=Flow.fifty,1,0))
    }
}
days.exceeding.fifty.month$year <- years
days.exceeding.fifty.month <- na.omit(days.exceeding.fifty.month)

fifty.senslope.jan <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$January)
fifty.senslope.feb <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$February)
fifty.senslope.mar <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$March)
fifty.senslope.apr <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$April)
fifty.senslope.may <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$May)
fifty.senslope.jun <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$June)
fifty.senslope.jul <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$July)
fifty.senslope.aug <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$August)
fifty.senslope.sep <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$September)
fifty.senslope.oct <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$October)
fifty.senslope.nov <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$November)
fifty.senslope.dec <- sens.output(time.step=days.exceeding.fifty.month$year,data=days.exceeding.fifty.month$December)
fifty.senslope.month <- rbind(fifty.senslope.jan,fifty.senslope.feb,fifty.senslope.mar,fifty.senslope.apr,fifty.senslope.may,fifty.senslope.jun,fifty.senslope.jul,fifty.senslope.aug,fifty.senslope.sep,fifty.senslope.oct,fifty.senslope.nov,fifty.senslope.dec)
fifty.senslope.month$Month <- unique(FallingRock$Month)
```

####Section 5.4.1: 50% Exceedence Plots
```{r}
#Half-Decadal
ggplot(data=days.exceeding.fifty.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=fifty.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Falling Rock Half-Decadal Days With Flow Less Than Q50")

#yearly
ggplot(data=days.exceeding.fifty.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=fifty.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q50")

#Water Year
ggplot(data=days.exceeding.fifty.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=fifty.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q50 Using Water Year")

#Climate Year
ggplot(data=days.exceeding.fifty.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=fifty.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Falling Rock Yearly Days With Flow Less Than Q50 Using Climate Year")

#seasonal
days.exceeding.fifty.season.long <- gather(days.exceeding.fifty.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
days.exceeding.fifty.season.long <- na.omit(days.exceeding.fifty.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR50.cal.jpeg", width=750)
ggplot(days.exceeding.fifty.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=fifty.senslope.season, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Falling Rock Seasonal Days With Flow Less Than Q50")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
days.exceeding.fifty.month.long <- gather(days.exceeding.fifty.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December",))
days.exceeding.fifty.month.long <- na.omit(days.exceeding.fifty.month.long)

ggplot(days.exceeding.fifty.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=fifty.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Falling Rock Monthly Days With Flow Less Than Q50")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

#### Section 5.4.1: 50% Flow Exceeded Statistical Summary
```{r}
FR.fifty.statistical.summary <- rbind.fill(fifty.senslope.halfdec,fifty.senslope.year,fifty.senslope.wateryear,fifty.senslope.climateyear,fifty.senslope.season,fifty.senslope.month)
```


##Section 5.5: 25% exceded

In this section we are finding the number of days that have a maximum flow greater than or equal to Q25 (0.87 cfs). This is done by ranking the flow values for the entire time series from high to low and assigning each value a probability from 0%-100%. Afterwards, Q25 is determined by selecting the flow value associated with 25% of flow greater than it. The values that fell above the 25% cutoff were selected and plotted on half-decadal, yearly, seasonal, and monthly scales. 
```{r}
#Timeseries (Daily)
Rank.flow.max <- data.frame("sort.data"=sort(FallingRock$maxdaily_CFS,decreasing = TRUE))
#sorting the data in decreasing order
Rank.flow.max$rank <- 1:length(Rank.flow.max$sort.data)
#adding a rank to the flows in the data frame
Rank.flow.max$probability <- ((Rank.flow.max$rank)/(length(Rank.flow.max$rank)))*100
# adding the probability of the flows
Flow.twenty.five <-
  Rank.flow.max$sort.data[which.min(abs(Rank.flow.max$probability - 25))]
#ranking the data and taking out the data <25% discharge
seventy.five.percent.flow <-
  matrix(nrow = length(unique(FallingRock$year)), ncol = 1)
#making a new data frame with the <25% data
percent.below.seventy.five <-
  matrix(nrow = length(unique(FallingRock$year)), ncol = 1)
for (i in 1:length(unique(FallingRock$year))) {
  Q.year <- FallingRock[which(FallingRock$year == years[i]), ]
  seventy.five.percent.flow[i] <-
    sum(ifelse(na.omit(Q.year$maxdaily_CFS) >= Flow.twenty.five, 1, 0))
#Dentoing which flows are >25%
  percent.below.seventy.five[i] <-
    (seventy.five.percent.flow[i] / length(na.omit(Q.year$maxdaily_CFS))) *
    100
}
# establishing the discharge where only 75% of flow exceeds that rate
seventy.five.percent.flow <-
  data.frame("seventy.five.percent" = seventy.five.percent.flow,
             "year" = unique(FallingRock$year))
#making a data frame with desired flow data and corresponding year

#Half-Decadal
# Initialize the number of days with flow greater than or equal to the 25% threshold flow
days.exceeding.twentyfive.decade <- data.frame(matrix(nrow=length(Half.decade),ncol=1))
colnames(days.exceeding.twentyfive.decade) <- "Number_Days"
rownames(days.exceeding.twentyfive.decade) <- Half.decade
for (i in 1:length(Half.decade)) {
    
    subset.decades <- FallingRock[which(FallingRock$half.decade==Half.decade[i]),]
    
    days.exceeding.twentyfive.decade[i,1] <- sum(ifelse(na.omit(subset.decades$maxdaily_CFS)>=Flow.twenty.five,1,0))
}
days.exceeding.twentyfive.decade$halfdec <- half.decades
twentyfive.senslope.halfdec <- sens.output(time.step=days.exceeding.twentyfive.decade$halfdec,data=days.exceeding.twentyfive.decade$Number_Days)
twentyfive.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
days.exceeding.twentyfive.year <- data.frame(matrix(nrow=length(years),ncol=1))
colnames(days.exceeding.twentyfive.year) <- "Number_Days"

for (i in 1:length(years)) {
    subset.years <- FallingRock[which(FallingRock$year==years[i]),]
    days.exceeding.twentyfive.year[i,1] <- sum(ifelse(na.omit(subset.years$maxdaily_CFS)>=Flow.twenty.five,1,0))
}
days.exceeding.twentyfive.year$year <- years
twentyfive.senslope.year <- sens.output(time.step=days.exceeding.twentyfive.year$year,data=days.exceeding.twentyfive.year$Number_Days)
twentyfive.senslope.year$year <- "Calendar.Year"

#Water Year
days.exceeding.twentyfive.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1))
colnames(days.exceeding.twentyfive.wateryear) <- "Number_Days"

for (i in 1:length(water.years)) {
    subset.wateryears <- FallingRock[which(FallingRock$Water_Year==water.years[i]),]
    days.exceeding.twentyfive.wateryear[i,1] <- sum(ifelse(na.omit(subset.wateryears$maxdaily_CFS)>=Flow.twenty.five,1,0))
}
days.exceeding.twentyfive.wateryear$Water_Year <- water.years
twentyfive.senslope.wateryear <- sens.output(time.step=days.exceeding.twentyfive.wateryear$Water_Year,data=days.exceeding.twentyfive.wateryear$Number_Days)
twentyfive.senslope.wateryear$year <- "Water.Year"

#Climate Year
days.exceeding.twentyfive.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1))
colnames(days.exceeding.twentyfive.climateyear) <- "Number_Days"

for (i in 1:length(climate.years)) {
    subset.climateyears <- FallingRock[which(FallingRock$Climate_Year==climate.years[i]),]
    days.exceeding.twentyfive.climateyear[i,1] <- sum(ifelse(na.omit(subset.climateyears$maxdaily_CFS)>=Flow.twenty.five,1,0))
}
days.exceeding.twentyfive.climateyear$Climate_Year <- climate.years
twentyfive.senslope.climateyear <- sens.output(time.step=days.exceeding.twentyfive.climateyear$Climate_Year,data=days.exceeding.twentyfive.climateyear$Number_Days)
twentyfive.senslope.climateyear$year <- "Climate.Year"

#Seasonal
days.exceeding.twentyfive.season <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$season))))
colnames(days.exceeding.twentyfive.season) <- c("Winter","Spring","Summer","Autumn")
seasons <- unique(FallingRock$season)

for (i in 1:length(years)) {
    for (j in 1:length(seasons)){
    days.exceeding.twentyfive.season[i,j]<-sum(ifelse(FallingRock$maxdaily_CFS[which(FallingRock$year==years[i]&FallingRock$season==seasons[j])]>=Flow.twenty.five,1,0))
    }
}
days.exceeding.twentyfive.season$year <- years
days.exceeding.twentyfive.season <- na.omit(days.exceeding.twentyfive.season)

twentyfive.senslope.winter <- sens.output(time.step=days.exceeding.twentyfive.season$year,data=days.exceeding.twentyfive.season$Winter)
twentyfive.senslope.spring <- sens.output(time.step=days.exceeding.twentyfive.season$year,data=days.exceeding.twentyfive.season$Spring)
twentyfive.senslope.summer <- sens.output(time.step=days.exceeding.twentyfive.season$year,data=days.exceeding.twentyfive.season$Summer)
twentyfive.senslope.autumn <- sens.output(time.step=days.exceeding.twentyfive.season$year,data=days.exceeding.twentyfive.season$Autumn)
twentyfive.senslope.season <- rbind(twentyfive.senslope.winter,twentyfive.senslope.spring,twentyfive.senslope.summer,twentyfive.senslope.autumn)
twentyfive.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")
#Monthly
months <- unique(FallingRock$month)
days.exceeding.twentyfive.month <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$month))))
colnames(days.exceeding.twentyfive.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(years)) {
    for (j in 1:length(months)){
    days.exceeding.twentyfive.month[i,j] <- sum(ifelse(FallingRock$maxdaily_CFS[which(FallingRock$year==years[i]&FallingRock$month==months[j])]>=Flow.twenty.five,1,0))
    }
}
days.exceeding.twentyfive.month$year <- years
days.exceeding.twentyfive.month <- na.omit(days.exceeding.twentyfive.month)

twentyfive.senslope.jan <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$January)
twentyfive.senslope.feb <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$February)
twentyfive.senslope.mar <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$March)
twentyfive.senslope.apr <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$April)
twentyfive.senslope.may <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$May)
twentyfive.senslope.jun <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$June)
twentyfive.senslope.jul <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$July)
twentyfive.senslope.aug <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$August)
twentyfive.senslope.sep <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$September)
twentyfive.senslope.oct <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$October)
twentyfive.senslope.nov <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$November)
twentyfive.senslope.dec <- sens.output(time.step=days.exceeding.twentyfive.month$year,data=days.exceeding.twentyfive.month$December)
twentyfive.senslope.month <- rbind(twentyfive.senslope.jan,twentyfive.senslope.feb,twentyfive.senslope.mar,twentyfive.senslope.apr,twentyfive.senslope.may,twentyfive.senslope.jun,twentyfive.senslope.jul,twentyfive.senslope.aug,twentyfive.senslope.sep,twentyfive.senslope.oct,twentyfive.senslope.nov,twentyfive.senslope.dec)
twentyfive.senslope.month$Month <- unique(FallingRock$Month)
```

####Section 5.5.1: 25% Exceedence Plots
```{r}
#Half-Decadal
ggplot(data=days.exceeding.twentyfive.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=twentyfive.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Falling Rock Half-Decadal Days With Flow Exceeding Q25")

#yearly
ggplot(data=days.exceeding.twentyfive.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=twentyfive.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q25")

#Water Year
ggplot(data=days.exceeding.twentyfive.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=twentyfive.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q25 Using Water Year")

#Climate Year
ggplot(data=days.exceeding.twentyfive.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=twentyfive.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q25 Using Climate Year")

#seasonal
days.exceeding.twentyfive.season.long <- gather(days.exceeding.twentyfive.season, key="season", value="value", c("Summer", "Autumn", "Winter", "Spring"))
days.exceeding.twentyfive.season.long <- na.omit(days.exceeding.twentyfive.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR25.cal.jpeg", width=750)
ggplot(days.exceeding.twentyfive.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=twentyfive.senslope.season, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Falling Rock Seasonal Days With Flow Exceeding Q25")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
days.exceeding.twentyfive.month.long <- gather(days.exceeding.twentyfive.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
days.exceeding.twentyfive.month.long <- na.omit(days.exceeding.twentyfive.month.long)

ggplot(days.exceeding.twentyfive.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=twentyfive.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Falling Rock Monthly Days With Flow Exceeding Q25")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

####Section 5.5.2: 25% Exceeded Statistical Summary
```{r}
FR.twentyfive.statistical.summary <- rbind.fill(twentyfive.senslope.halfdec,twentyfive.senslope.year,twentyfive.senslope.wateryear,twentyfive.senslope.climateyear,twentyfive.senslope.season,twentyfive.senslope.month)
```


## Section 5.6: 5% exceded

In this section we are finding the number of days that have a maximum flow greater than or equal to Q5 (4.01 cfs). This is done by ranking the flow values for the entire time series from high to low and assigning each value a probability from 0%-100%. Afterwards, Q5 is determined by selecting the flow value associated with 5% of flow greater than it. The values that fell above the 5% cutoff were selected and plotted on half-decadal, yearly, seasonal, and monthly scales. 
```{r}
#Timeseries (daily)
Flow.five <- Rank.flow.max$sort.data[which.min(abs(Rank.flow.max$probability-5))]
#ranking the data and taking out the data <5% discharge
ninety.five.percent.flow <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
#making a new data frame with the <5% data
percent.below.ninety.five <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
for(i in 1:length(unique(FallingRock$year))){
Q.year<-FallingRock[which(FallingRock$year==years[i]),]
ninety.five.percent.flow[i]<-sum(ifelse(na.omit(Q.year$maxdaily_CFS)>=Flow.five,1,0))
#Dentoing which flows are <5%
percent.below.ninety.five[i]<-(ninety.five.percent.flow[i]/length(na.omit(Q.year$maxdaily_CFS)))*100
}
# establishing the discharge where only 95% of flow exceeds that rate
ninety.five.percent.flow <- data.frame("ninety.five.percent"=ninety.five.percent.flow,"year"=unique(FallingRock$year))
#making a data frame with desired flow data and corresponding year

#Half-Decadal
# Initialize the number of days with flow greater than or equal to the 25% threshold flow
days.exceeding.five.decade <- data.frame(matrix(nrow=length(Half.decade),ncol=1))
colnames(days.exceeding.five.decade) <- "Number_Days"
rownames(days.exceeding.five.decade) <- Half.decade
for (i in 1:length(Half.decade)) {
    
    subset.decades <- FallingRock[which(FallingRock$half.decade==Half.decade[i]),]
    
    days.exceeding.five.decade[i,1] <- sum(ifelse(na.omit(subset.decades$maxdaily_CFS)>=Flow.five,1,0))
}
days.exceeding.five.decade$halfdec <- half.decades

five.senslope.halfdec <- sens.output(time.step=days.exceeding.five.decade$halfdec,data=days.exceeding.five.decade$Number_Days)
five.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
days.exceeding.five.year <- data.frame(matrix(nrow=length(years),ncol=1))
colnames(days.exceeding.five.year) <- "Number_Days"

for (i in 1:length(years)) {
    subset.years <- FallingRock[which(FallingRock$year==years[i]),]
    days.exceeding.five.year[i,1] <- sum(ifelse(na.omit(subset.years$maxdaily_CFS)>=Flow.five,1,0))
}
days.exceeding.five.year$year <- years
five.senslope.year <- sens.output(time.step=days.exceeding.five.year$year,data=days.exceeding.five.year$Number_Days)
five.senslope.year$year <- "Calendar.Year"

#Water Year
days.exceeding.five.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1))
colnames(days.exceeding.five.wateryear) <- "Number_Days"

for (i in 1:length(water.years)) {
    subset.wateryears <- FallingRock[which(FallingRock$Water_Year==water.years[i]),]
    days.exceeding.five.wateryear[i,1] <- sum(ifelse(na.omit(subset.wateryears$maxdaily_CFS)>=Flow.five,1,0))
}
days.exceeding.five.wateryear$Water_Year <- water.years
five.senslope.wateryear <- sens.output(time.step=days.exceeding.five.wateryear$Water_Year,data=days.exceeding.five.wateryear$Number_Days)
five.senslope.wateryear$year <- "Water.Year"

#Climate Year
days.exceeding.five.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1))
colnames(days.exceeding.five.climateyear) <- "Number_Days"

for (i in 1:length(climate.years)) {
    subset.climateyears <- FallingRock[which(FallingRock$Climate_Year==climate.years[i]),]
    days.exceeding.five.climateyear[i,1] <- sum(ifelse(na.omit(subset.climateyears$maxdaily_CFS)>=Flow.five,1,0))
}
days.exceeding.five.climateyear$Climate_Year <- climate.years
five.senslope.climateyear <- sens.output(time.step=days.exceeding.five.climateyear$Climate_Year,data=days.exceeding.five.climateyear$Number_Days)
five.senslope.climateyear$year <- "Climate.Year"

#Seasonal
days.exceeding.five.season <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$season))))
colnames(days.exceeding.five.season) <- c("Winter","Spring","Summer","Autumn")
seasons <- unique(FallingRock$season)

for (i in 1:length(years)) {
    for (j in 1:length(seasons)){
    days.exceeding.five.season[i,j]<-sum(ifelse(FallingRock$maxdaily_CFS[which(FallingRock$year==years[i]&FallingRock$season==seasons[j])]>=Flow.five,1,0))
    }
}
days.exceeding.five.season$year <- years
days.exceeding.five.season <- na.omit(days.exceeding.five.season)

five.senslope.winter <- sens.output(time.step=days.exceeding.five.season$year,data=days.exceeding.five.season$Winter)
five.senslope.spring <- sens.output(time.step=days.exceeding.five.season$year,data=days.exceeding.five.season$Spring)
five.senslope.summer <- sens.output(time.step=days.exceeding.five.season$year,data=days.exceeding.five.season$Summer)
five.senslope.autumn <- sens.output(time.step=days.exceeding.five.season$year,data=days.exceeding.five.season$Autumn)
five.senslope.season <- rbind(five.senslope.winter,five.senslope.spring,five.senslope.summer,five.senslope.autumn)
five.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")
#Monthly
months <- unique(FallingRock$month)
days.exceeding.five.month <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$month))))
colnames(days.exceeding.five.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(years)) {
    for (j in 1:length(months)){
    days.exceeding.five.month[i,j] <- sum(ifelse(FallingRock$maxdaily_CFS[which(FallingRock$year==years[i]&FallingRock$month==months[j])]>=Flow.five,1,0))
    }
}
days.exceeding.five.month$year <- years
days.exceeding.five.month <- na.omit(days.exceeding.five.month)

five.senslope.jan <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$January)
five.senslope.feb <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$February)
five.senslope.mar <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$March)
five.senslope.apr <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$April)
five.senslope.may <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$May)
five.senslope.jun <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$June)
five.senslope.jul <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$July)
five.senslope.aug <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$August)
five.senslope.sep <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$September)
five.senslope.oct <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$October)
five.senslope.nov <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$November)
five.senslope.dec <- sens.output(time.step=days.exceeding.five.month$year,data=days.exceeding.five.month$December)
five.senslope.month <- rbind(five.senslope.jan,five.senslope.feb,five.senslope.mar,five.senslope.apr,five.senslope.may,five.senslope.jun,five.senslope.jul,five.senslope.aug,five.senslope.sep,five.senslope.oct,five.senslope.nov,five.senslope.dec)
five.senslope.month$Month <- unique(FallingRock$Month)
```

#### Section 5.6.1: 5% Exceedence Plots
```{r}
#Half-Decadal
ggplot(data=days.exceeding.five.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=five.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Falling Rock Half-Decadal Days With Flow Exceeding Q5")

#yearly
ggplot(data=days.exceeding.five.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=five.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q5")

#Water Year
ggplot(data=days.exceeding.five.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=five.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q5 Using Water Year")

#Climate Year
ggplot(data=days.exceeding.five.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=five.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q5 Using Climate Year")
#seasonal
days.exceeding.five.season.long <- gather(days.exceeding.five.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
days.exceeding.five.season.long <- na.omit(days.exceeding.five.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR5.cal.jpeg", width=750)
ggplot(days.exceeding.five.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=five.senslope.season, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Falling Rock Seasonal Days With Flow Exceeding Q5")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
days.exceeding.five.month.long <- gather(days.exceeding.five.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
days.exceeding.five.month.long <- na.omit(days.exceeding.five.month.long)

ggplot(days.exceeding.five.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=five.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Falling Rock Monthly Days With Flow Exceeding Q5")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

#### Section 5.5.2: 5% Exceeded Statistical Summary
```{r}
FR.five.statistical.summary <- rbind.fill(five.senslope.halfdec,five.senslope.year,five.senslope.wateryear,five.senslope.climateyear,five.senslope.season,five.senslope.month)
```

## Section 5.6: 1% Exceeded

In this section we are finding the number of days that have a maximum flow greater than or equal to Q1 (18.2 cfs). This is done by ranking the flow values for the entire time series from high to low and assigning each value a probability from 0%-100%. Afterwards, Q1 is determined by selecting the flow value associated with 1% of flow greater than it. The values that fell above the 1% cutoff were selected and plotted on half-decadal, yearly, seasonal, and monthly scales. 
```{r}
Flow.one <- Rank.flow.max$sort.data[which.min(abs(Rank.flow.max$probability-1))]#ranking the data and taking out the data <99% discharge
one.percent.flow <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
#making a new data frame with the <99% data
percent.below.one <- matrix(nrow=length(unique(FallingRock$year)),ncol=1)
for(i in 1:length(unique(FallingRock$year))){
Q.year<-FallingRock[which(FallingRock$year==years[i]),]
one.percent.flow[i]<-sum(ifelse(na.omit(Q.year$maxdaily_CFS)>=Flow.one,1,0))
#Dentoing which flows are <99%
percent.below.one[i]<-(one.percent.flow[i]/length(na.omit(Q.year$maxdaily_CFS)))*100
}
# establishing the discharge where only 1% of flow exceeds that rate
one.percent.flow <- data.frame("one.percent"=one.percent.flow,"year"=unique(FallingRock$year))
# creating a matrix to report the 1% exceeded values

#Half-Decadal
Half.decade <- unique(FallingRock$half.decade)
# Initialize the number of days with flow less than or equal to the 90% threshold flow
days.exceeding.one.decade <- data.frame(matrix(nrow=length(Half.decade),ncol=1))
colnames(days.exceeding.one.decade) <- "Number_Days"
rownames(days.exceeding.one.decade) <- Half.decade
for (i in 1:length(Half.decade)) {
    
    subset.decades <- FallingRock[which(FallingRock$half.decade==Half.decade[i]),]
    
    days.exceeding.one.decade[i,1] <- sum(ifelse(na.omit(subset.decades$maxdaily_CFS)>=Flow.one,1,0))
}
half.decades <- Half.decade
days.exceeding.one.decade$halfdec <- half.decades
one.senslope.halfdec <- sens.output(time.step=days.exceeding.one.decade$halfdec,data=days.exceeding.one.decade$Number_Days)
one.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
days.exceeding.one.year <- data.frame(matrix(nrow=length(years),ncol=1))
colnames(days.exceeding.one.year) <- "Number_Days"

for (i in 1:length(years)) {
    subset.years <- FallingRock[which(FallingRock$year==years[i]),]
    days.exceeding.one.year[i,1] <- sum(ifelse(na.omit(subset.years$maxdaily_CFS)>=Flow.one,1,0))
}
days.exceeding.one.year$year <- years
one.senslope.year <- sens.output(time.step=days.exceeding.one.year$year,data=days.exceeding.one.year$Number_Days)
one.senslope.year$year <- "Calendar.Year"

#Water Year
days.exceeding.one.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1))
colnames(days.exceeding.one.wateryear) <- "Number_Days"

for (i in 1:length(water.years)) {
    subset.wateryears <- FallingRock[which(FallingRock$Water_Year==water.years[i]),]
    days.exceeding.one.wateryear[i,1] <- sum(ifelse(na.omit(subset.wateryears$maxdaily_CFS)>=Flow.one,1,0))
}
days.exceeding.one.wateryear$Water_Year <- water.years
one.senslope.wateryear <- sens.output(time.step=days.exceeding.one.wateryear$Water_Year,data=days.exceeding.one.wateryear$Number_Days)
one.senslope.wateryear$year <- "Water.Year"

#Climate Year
days.exceeding.one.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1))
colnames(days.exceeding.one.climateyear) <- "Number_Days"

for (i in 1:length(climate.years)) {
    subset.climateyears <- FallingRock[which(FallingRock$Climate_Year==climate.years[i]),]
    days.exceeding.one.climateyear[i,1] <- sum(ifelse(na.omit(subset.climateyears$maxdaily_CFS)>=Flow.one,1,0))
}
days.exceeding.one.climateyear$Climate_Year <- climate.years
one.senslope.climateyear <- sens.output(time.step=days.exceeding.one.climateyear$Climate_Year,data=days.exceeding.one.climateyear$Number_Days)
one.senslope.climateyear$year <- "Climate.Year"

#Seasonal
season <- c("winter","spring","summer","autumm")
days.exceeding.one.season <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$season))))
colnames(days.exceeding.one.season) <- c("Winter","Spring","Summer","Autumn")

for (i in 1:length(years)) {
    for (j in 1:length(seasons)){
    days.exceeding.one.season[i,j]<-sum(ifelse(FallingRock$maxdaily_CFS[which(FallingRock$year==years[i]&FallingRock$season==season[j])]>=Flow.one,1,0))
    }
}
days.exceeding.one.season$year <- years
days.exceeding.one.season <- na.omit(days.exceeding.one.season)

one.senslope.winter <- sens.output(time.step=days.exceeding.one.season$year,data=days.exceeding.one.season$Winter)
one.senslope.spring <- sens.output(time.step=days.exceeding.one.season$year,data=days.exceeding.one.season$Spring)
one.senslope.summer <- sens.output(time.step=days.exceeding.one.season$year,data=days.exceeding.one.season$Summer)
one.senslope.autumn <- sens.output(time.step=days.exceeding.one.season$year,data=days.exceeding.one.season$Autumn)
one.senslope.season <- rbind(one.senslope.winter,one.senslope.spring,one.senslope.summer,one.senslope.autumn)
one.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")
#Monthly
months <- unique(FallingRock$month)
days.exceeding.one.month <- data.frame(matrix(nrow=length(years),ncol=length(unique(FallingRock$month))))
colnames(days.exceeding.one.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(years)) {
    for (j in 1:length(months)){
    days.exceeding.one.month[i,j] <- sum(ifelse(FallingRock$maxdaily_CFS[which(FallingRock$year==years[i]&FallingRock$month==months[j])]>=Flow.one,1,0))
    }
}
days.exceeding.one.month$year <- years
days.exceeding.one.month <- na.omit(days.exceeding.one.month)

one.senslope.jan <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$January)
one.senslope.feb <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$February)
one.senslope.mar <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$March)
one.senslope.apr <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$April)
one.senslope.may <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$May)
one.senslope.jun <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$June)
one.senslope.jul <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$July)
one.senslope.aug <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$August)
one.senslope.sep <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$September)
one.senslope.oct <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$October)
one.senslope.nov <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$November)
one.senslope.dec <- sens.output(time.step=days.exceeding.one.month$year,data=days.exceeding.one.month$December)
one.senslope.month <- rbind(one.senslope.jan,one.senslope.feb,one.senslope.mar,one.senslope.apr,one.senslope.may,one.senslope.jun,one.senslope.jul,one.senslope.aug,one.senslope.sep,one.senslope.oct,one.senslope.nov,one.senslope.dec)
one.senslope.month$Month <- unique(FallingRock$Month)
```
### Section 5.6.1: 1% Exceeded Plots
```{r}
#Half-Decadal
ggplot(data=days.exceeding.one.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=one.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Falling Rock Half-Decadal Days With Flow Exceeding Q1")

#yearly
ggplot(data=days.exceeding.one.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=one.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q1")

#Water Year
ggplot(data=days.exceeding.one.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=one.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q1 Using Water Year")

#Climate Year
ggplot(data=days.exceeding.one.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=one.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Falling Rock Yearly Days With Flow Exceeding Q1 Using CLimate Year")

#seasonal
days.exceeding.one.season.long <- gather(days.exceeding.one.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
days.exceeding.one.season.long <- na.omit(days.exceeding.one.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR1.cal.jpeg", width=750)
ggplot(days.exceeding.one.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(season))+
  geom_abline(data=one.senslope.season, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Falling Rock Seasonal Days With Flow Exceeding Q1")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
days.exceeding.one.month.long <- gather(days.exceeding.one.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
days.exceeding.one.month.long <- na.omit(days.exceeding.one.month.long)

ggplot(days.exceeding.one.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=one.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Falling Rock Monthly Days With Flow Exceeding Q1")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

### Section 5.6.2: 1% Exceeded Statistical Summary
```{r}
FR.one.statistical.summary <- rbind.fill(one.senslope.halfdec,one.senslope.year,one.senslope.wateryear,one.senslope.climateyear,one.senslope.season,one.senslope.month)
```

##Section 5.7: Yearly Flow duration curve

```{r}
#Calendar Year
FDC_year=list()#creating a new list for the flow duration curves
years <- unique(FallingRock$year)
for(i in 1:(length(unique(FallingRock$year))-3))#running a for loop on all the years with 90% of data
  {
  FDC_year[[i]] <- data.frame("sort.data"=sort(na.omit(FallingRock$meandaily_CFS[which(FallingRock$year==years[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
FDC_year[[i]]$rank <- 1:length(FDC_year[[i]]$sort.data)#adding a rank column where highest flow is 1
FDC_year[[i]]$probability<-((FDC_year[[i]]$rank)/(length(FDC_year[[i]]$rank)+1))*100
} #finding the probability of each event
for(i in 1:length(FDC_year)){
  plot(x=FDC_year[[i]]$probability,y=FDC_year[[i]]$sort.data+0.001,log='y')
}
#plotting the flow duration curve for each year
```

#Section 6: Timing- First No Flow Day
```{r}
#yearly
first.nf.date <- data.frame(matrix(nrow=length(years),ncol=1))
for(i in 1:length(years)){
  min.year <- data.frame(min.Q=FallingRock$meandaily_CFS[which(FallingRock$year==unique(years)[i])])
  min.year$date <- FallingRock$Date.1[which(FallingRock$year==unique(years)[i])]
  new.noflow <- ifelse(length(which(min.year$min.Q==0))==0,NA,which(min.year$min.Q==0))
  first.noflow <- min(new.noflow)
  first.noflow.date <- min.year$date[first.noflow]
  first.nf.date[i,1] <- first.noflow.date
}
colnames(first.nf.date) <- c("First.no.flow")
first.nf.date$year <- NA
first.nf.date$year <- as.numeric(years)
first.nf.date$First.no.flow <- as.Date(first.nf.date$First.no.flow)
first.nf.date$day.of.year <- strftime(first.nf.date$First.no.flow, format="%j")
first.nf.date$day.of.year <- as.numeric(first.nf.date$day.of.year)

first.nf.date <- na.omit(first.nf.date)
first.nfdate.senslope <- sens.output(time.step=first.nf.date$year,data=first.nf.date$day.of.year)
first.nfdate.senslope$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_firstnf.cal.jpeg", width=1000)
ggplot(data=first.nf.date, aes(x=year, y=day.of.year))+
  geom_bar(stat="identity")+
  geom_abline(data=first.nfdate.senslope, aes(slope=slope, intercept=intercept))+
  ylim(0,365)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Day of Year")+
  ggtitle("Falling Rock Yearly First No-Flow Day")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
first.nf.date.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1))
for(i in 1:length(water.years)){
  min.wateryear <- data.frame(min.Q=FallingRock$meandaily_CFS[which(FallingRock$Water_Year==unique(water.years)[i])])
  min.wateryear$date <- FallingRock$Date.1[which(FallingRock$Water_Year==unique(water.years)[i])]
  new.noflow.wateryear <- ifelse(length(which(min.wateryear$min.Q==0))==0,NA,which(min.wateryear$min.Q==0))
  first.noflow.wateryear <- min(new.noflow.wateryear)
  first.noflow.date.wateryear <- min.wateryear$date[first.noflow.wateryear]
  first.nf.date.wateryear[i,1] <- first.noflow.date.wateryear
}
colnames(first.nf.date.wateryear) <- c("First.no.flow")
first.nf.date.wateryear$Water_Year <- water.years
first.nf.date.wateryear$First.no.flow <- as.Date(first.nf.date.wateryear$First.no.flow)
first.nf.date.wateryear$day.of.year <- strftime(first.nf.date.wateryear$First.no.flow, format="%j")
first.nf.date.wateryear$day.of.year <- as.numeric(first.nf.date.wateryear$day.of.year)

first.nf.date.wateryear <- na.omit(first.nf.date.wateryear)
first.nfdate.wateryear.senslope <- sens.output(time.step=first.nf.date.wateryear$Water_Year,data=first.nf.date.wateryear$day.of.year)
first.nfdate.wateryear.senslope$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_firstnf.water.jpeg", width=1000)
ggplot(data=first.nf.date.wateryear, aes(x=Water_Year, y=day.of.year))+
  geom_bar(stat="identity")+
  geom_abline(data=first.nfdate.wateryear.senslope, aes(slope=slope, intercept=intercept))+
  ylim(0,365)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Day of Year")+
  ggtitle("Falling Rock Yearly First No-Flow Day Using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
first.nf.date.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1))
for(i in 1:length(climate.years)){
  min.climateyear <- data.frame(min.Q=FallingRock$meandaily_CFS[which(FallingRock$Climate_Year==unique(climate.years)[i])])
  min.climateyear$date <- FallingRock$Date.1[which(FallingRock$Climate_Year==unique(climate.years)[i])]
  new.noflow.climateyear <- ifelse(length(which(min.climateyear$min.Q==0))==0,NA,which(min.climateyear$min.Q==0))
  first.noflow.climateyear <- min(new.noflow.climateyear)
  first.noflow.date.climateyear <- min.climateyear$date[first.noflow.climateyear]
  first.nf.date.climateyear[i,1] <- first.noflow.date.climateyear
}
colnames(first.nf.date.climateyear) <- c("First.no.flow")
first.nf.date.climateyear$Climate_Year <- climate.years
first.nf.date.climateyear$First.no.flow <- as.Date(first.nf.date.climateyear$First.no.flow)
first.nf.date.climateyear$day.of.year <- strftime(first.nf.date.climateyear$First.no.flow, format="%j")
first.nf.date.climateyear$day.of.year <- as.numeric(first.nf.date.climateyear$day.of.year)

first.nf.date.climateyear <- na.omit(first.nf.date.climateyear)
first.nfdate.climateyear.senslope <- sens.output(time.step=first.nf.date.climateyear$Climate_Year,data=first.nf.date.climateyear$day.of.year)
first.nfdate.climateyear.senslope$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_firstnf.clim.jpeg", width=1000)
ggplot(data=first.nf.date.climateyear, aes(x=Climate_Year, y=day.of.year))+
  geom_bar(stat="identity")+
  geom_abline(data=first.nfdate.climateyear.senslope, aes(slope=slope, intercept=intercept))+
  ylim(0,365)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Day of Year")+
  ggtitle("Falling Rock Yearly First No-Flow Day Using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()
```

## Section 6.1: First No-Flow Day Statistical Summary
```{r}
FR.first.nfdate.statistical.summary <- rbind.fill(first.nfdate.senslope,first.nfdate.wateryear.senslope,first.nfdate.climateyear.senslope)
```


#Section 7: Duration- Longest Consecutive no flow period
```{r}
#1/2 Decadal
max.flow.duration.halfdec <- data.frame(matrix(nrow=length(half.decades),ncol=1))
rownames(max.flow.duration.halfdec) <- half.decades
colnames(max.flow.duration.halfdec) <- c("Number_Days")

for (i in 1:length(half.decades)) {
    if (length(FallingRock[which(FallingRock$half.decade == half.decades[i]),8])!=0) {
      subset.halfdec <-FallingRock[which(FallingRock$half.decade==half.decades[i]),]
      subset.halfdec$consec.days <- NA
      subset.halfdec$Flow.state.ID<-ifelse(is.na(subset.halfdec$Flow.state.ID),1,subset.halfdec$Flow.state.ID)
   
    for (j in 1:length(subset.halfdec$Date)) {
      if (j == 1 & subset.halfdec$Flow.state.ID[j] == 1) {
        subset.halfdec$consec.days[j] <- 1
      } else if (j > 1 & subset.halfdec$Flow.state.ID[j] == 1) {
        subset.halfdec$consec.days[j] <-
          subset.halfdec$Flow.state.ID[j] + subset.halfdec$consec.days[j - 1]
      } else {
        subset.halfdec$consec.days[j] <- 0
      }
     
    }
    max.flow.duration.halfdec[i,1] <- max(subset.halfdec$consec.days)
    }else {NA}
   
}

max.noflow.duration.halfdec <- data.frame(matrix(nrow=length(half.decades),ncol=1))
colnames(max.noflow.duration.halfdec) <- c("Number_Days")
max.noflow.duration.halfdec$halfdec <- half.decades

for (i in 1:length(half.decades)) {
    if (length(FallingRock[which(FallingRock$half.decade == half.decades[i]),8])!=0) {
      subset.halfdec <-FallingRock[which(FallingRock$half.decade==half.decades[i]),]
      subset.halfdec$consec.nf.days <- NA
      subset.halfdec$Flow.state.ID<-ifelse(is.na(subset.halfdec$Flow.state.ID),1,subset.halfdec$Flow.state.ID)
   
    for (j in 1:length(subset.halfdec$Date)) {
      if (j == 1 & subset.halfdec$Flow.state.ID[j] == 0) {
        subset.halfdec$consec.nf.days[j] <- 1
      } else if (j > 1 & subset.halfdec$Flow.state.ID[j] == 0) {
        subset.halfdec$consec.nf.days[j] <-
          subset.halfdec$Flow.state.ID[j] + 1 + subset.halfdec$consec.nf.days[j - 1]
      } else {
        subset.halfdec$consec.nf.days[j] <- 0
      }
     
    }
    max.noflow.duration.halfdec[i,1] <- max(subset.halfdec$consec.nf.days)
    }else {NA}
   
}

max.nf.senslope.halfdec <- sens.output(time.step=max.noflow.duration.halfdec$halfdec,data=max.noflow.duration.halfdec$Number_Days)
max.nf.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(data=max.noflow.duration.halfdec, aes(x=halfdec, y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=max.nf.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Falling Rock Half-Decadal Maximum No-Flow Duration")

#yearly
max.flow.duration.year <- matrix(nrow=length(years),ncol=1) 
max.flow.duration.year <- data.frame(max.flow.duration.year)
rownames(max.flow.duration.year) <- years
colnames(max.flow.duration.year) <- c("Number_Days")

for (i in 1:length(years)) {
    if (length(FallingRock[which(FallingRock$year == years[i]),8])!=0) {
      subset.year <-FallingRock[which(FallingRock$year==years[i]),]
      subset.year$consec.days <- NA
      subset.year$Flow.state.ID<-ifelse(is.na(subset.year$Flow.state.ID),1,subset.year$Flow.state.ID)
   
    for (j in 1:length(subset.year$Date)) {
      if (j == 1 & subset.year$Flow.state.ID[j] == 1) {
        subset.year$consec.days[j] <- 1
      } else if (j > 1 & subset.year$Flow.state.ID[j] == 1) {
        subset.year$consec.days[j] <-
          subset.year$Flow.state.ID[j] + subset.year$consec.days[j - 1]
      } else {
        subset.year$consec.days[j] <- 0
      }
     
    }
    max.flow.duration.year[i,1] <- max(subset.year$consec.days)
    }else {NA}
   
}

max.noflow.duration.year <- data.frame(matrix(nrow=length(years),ncol=1))
colnames(max.noflow.duration.year) <- c("Number_Days")
max.noflow.duration.year$year <- years

for (i in 1:length(years)) {
    if (length(FallingRock[which(FallingRock$year == years[i]),8])!=0) {
      subset.year <-FallingRock[which(FallingRock$year==years[i]),]
      subset.year$consec.nf.days <- NA
      subset.year$Flow.state.ID<-ifelse(is.na(subset.year$Flow.state.ID),1,subset.year$Flow.state.ID)
  for (j in 1:length(subset.year$Date)) {
      if (j == 1 & subset.year$Flow.state.ID[j] == 0) {
        subset.year$consec.nf.days[j] <- 1
      } else if (j > 1 & subset.year$Flow.state.ID[j] == 0) {
        subset.year$consec.nf.days[j] <-
          subset.year$Flow.state.ID[j]+ 1 + + subset.year$consec.nf.days[j - 1]
      } else {
        subset.year$consec.nf.days[j] <- 0
      }
     
    }
    max.noflow.duration.year[i,1] <- max(subset.year$consec.nf.days)
    } else {NA}
   
}
max.nf.senslope.year <- sens.output(time.step=max.noflow.duration.year$year,data=max.noflow.duration.year$Number_Days)
max.nf.senslope.year$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_longestnf.cal.jpeg", width=1000)
ggplot(data=max.noflow.duration.year, aes(x=year, y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=max.nf.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Falling Rock Yearly Maximum No-Flow Duration")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
max.flow.duration.climateyear <- matrix(nrow=length(climate.years),ncol=1) 
max.flow.duration.climateyear <- data.frame(max.flow.duration.climateyear)
rownames(max.flow.duration.climateyear) <- climate.years
colnames(max.flow.duration.climateyear) <- c("Number_Days")

for (i in 1:length(climate.years)) {
    if (length(FallingRock[which(FallingRock$Climate_Year == climate.years[i]),8])!=0) {
      subset.climateyear <-FallingRock[which(FallingRock$Climate_Year==climate.years[i]),]
      subset.climateyear$consec.days <- NA
      subset.climateyear$Flow.state.ID<-ifelse(is.na(subset.climateyear$Flow.state.ID),1,subset.climateyear$Flow.state.ID)
   
    for (j in 1:length(subset.climateyear$Date)) {
      if (j == 1 & subset.climateyear$Flow.state.ID[j] == 1) {
        subset.climateyear$consec.days[j] <- 1
      } else if (j > 1 & subset.climateyear$Flow.state.ID[j] == 1) {
        subset.climateyear$consec.days[j] <-
          subset.climateyear$Flow.state.ID[j] + subset.climateyear$consec.days[j - 1]
      } else {
        subset.climateyear$consec.days[j] <- 0
      }
     
    }
    max.flow.duration.climateyear[i,1] <- max(subset.climateyear$consec.days)
    }else {NA}
   
}

max.noflow.duration.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1))
colnames(max.noflow.duration.climateyear) <- c("Number_Days")
max.noflow.duration.climateyear$Climate_Year <- climate.years

for (i in 1:length(climate.years)) {
    if (length(FallingRock[which(FallingRock$Climate_Year == climate.years[i]),8])!=0) {
      subset.climateyear <-FallingRock[which(FallingRock$Climate_Year==climate.years[i]),]
      subset.climateyear$consec.nf.days <- NA
      subset.climateyear$Flow.state.ID<-ifelse(is.na(subset.climateyear$Flow.state.ID),1,subset.climateyear$Flow.state.ID)
  for (j in 1:length(subset.climateyear$Date)) {
      if (j == 1 & subset.climateyear$Flow.state.ID[j] == 0) {
        subset.climateyear$consec.nf.days[j] <- 1
      } else if (j > 1 & subset.climateyear$Flow.state.ID[j] == 0) {
        subset.climateyear$consec.nf.days[j] <-
          subset.climateyear$Flow.state.ID[j]+ 1 + + subset.climateyear$consec.nf.days[j - 1]
      } else {
        subset.climateyear$consec.nf.days[j] <- 0
      }
     
    }
    max.noflow.duration.climateyear[i,1] <- max(subset.climateyear$consec.nf.days)
    } else {NA}
   
}
max.nf.senslope.climateyear <- sens.output(time.step=max.noflow.duration.climateyear$Climate_Year,data=max.noflow.duration.climateyear$Number_Days)
max.nf.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_longestnf.clim.jpeg", width=1000)
ggplot(data=max.noflow.duration.climateyear, aes(x=Climate_Year, y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=max.nf.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Falling Rock Yearly Maximum No-Flow Duration Using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
max.flow.duration.wateryear <- matrix(nrow=length(water.years),ncol=1) 
max.flow.duration.wateryear <- data.frame(max.flow.duration.wateryear)
rownames(max.flow.duration.wateryear) <- water.years
colnames(max.flow.duration.wateryear) <- c("Number_Days")

for (i in 1:length(water.years)) {
    if (length(FallingRock[which(FallingRock$Water_Year == water.years[i]),8])!=0) {
      subset.wateryear <-FallingRock[which(FallingRock$Water_Year==water.years[i]),]
      subset.wateryear$consec.days <- NA
      subset.wateryear$Flow.state.ID<-ifelse(is.na(subset.wateryear$Flow.state.ID),1,subset.wateryear$Flow.state.ID)
   
    for (j in 1:length(subset.wateryear$Date)) {
      if (j == 1 & subset.wateryear$Flow.state.ID[j] == 1) {
        subset.wateryear$consec.days[j] <- 1
      } else if (j > 1 & subset.wateryear$Flow.state.ID[j] == 1) {
        subset.wateryear$consec.days[j] <-
          subset.wateryear$Flow.state.ID[j] + subset.wateryear$consec.days[j - 1]
      } else {
        subset.wateryear$consec.days[j] <- 0
      }
     
    }
    max.flow.duration.wateryear[i,1] <- max(subset.wateryear$consec.days)
    }else {NA}
   
}

max.noflow.duration.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1))
colnames(max.noflow.duration.wateryear) <- c("Number_Days")
max.noflow.duration.wateryear$Water_Year <- water.years

for (i in 1:length(water.years)) {
    if (length(FallingRock[which(FallingRock$Water_Year == water.years[i]),8])!=0) {
      subset.wateryear <-FallingRock[which(FallingRock$Water_Year==water.years[i]),]
      subset.wateryear$consec.nf.days <- NA
      subset.wateryear$Flow.state.ID<-ifelse(is.na(subset.wateryear$Flow.state.ID),1,subset.wateryear$Flow.state.ID)
  for (j in 1:length(subset.wateryear$Date)) {
      if (j == 1 & subset.wateryear$Flow.state.ID[j] == 0) {
        subset.wateryear$consec.nf.days[j] <- 1
      } else if (j > 1 & subset.wateryear$Flow.state.ID[j] == 0) {
        subset.wateryear$consec.nf.days[j] <-
          subset.wateryear$Flow.state.ID[j]+ 1 + + subset.wateryear$consec.nf.days[j - 1]
      } else {
        subset.wateryear$consec.nf.days[j] <- 0
      }
     
    }
    max.noflow.duration.wateryear[i,1] <- max(subset.wateryear$consec.nf.days)
    } else {NA}
   
}
max.nf.senslope.wateryear <- sens.output(time.step=max.noflow.duration.wateryear$Water_Year,data=max.noflow.duration.wateryear$Number_Days)
max.nf.senslope.wateryear$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_longestnf.water.jpeg", width=1000)
ggplot(data=max.noflow.duration.wateryear, aes(x=Water_Year, y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=max.nf.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Falling Rock Yearly Maximum No-Flow Duration Using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#seasonal
max.flow.duration.season <- data.frame(matrix(nrow=length(years),ncol=length(seasons)))
colnames(max.flow.duration.season) <- seasons
max.flow.duration.season$year <- years

for (i in 1:length(years)) {
  for (k in 1:length(seasons)) {
    if (length(FallingRock[which(FallingRock$year == years[i] & FallingRock$season == seasons[k]),8])!=0) {
      subset.season <-FallingRock[which(FallingRock$year==years[i]&FallingRock$season==seasons[k]),]
    subset.season$consec.days <- NA
    subset.season$Flow.state.ID <- ifelse(is.na(subset.season$Flow.state.ID),1,subset.season$Flow.state.ID)
   
    for (j in 1:length(subset.season$Date)) {
      if (j == 1 & subset.season$Flow.state.ID[j] == 1) {
        subset.season$consec.days[j] <- 1
      } else if (j > 1 & subset.season$Flow.state.ID[j] == 1) {
        subset.season$consec.days[j] <-
          subset.season$Flow.state.ID[j] + subset.season$consec.days[j - 1]
      } else {
        subset.season$consec.days[j] <- 0
      }
     
    }
    max.flow.duration.season[i, k] <- max(subset.season$consec.days)
    } else {NA}
   
  }
}

max.noflow.duration.season <- data.frame(matrix(nrow=length(years),ncol=length(seasons)))
colnames(max.noflow.duration.season) <- seasons
max.noflow.duration.season$year <- years

for (i in 1:length(years)) {
  for (k in 1:length(seasons)) {
    if (length(FallingRock[which(FallingRock$year == years[i] & FallingRock$season == seasons[k]),8])!=0) {
    subset.season <-FallingRock[which(FallingRock$year==years[i]&FallingRock$season==seasons[k]),]
    subset.season$consec.nf.days <- NA
    subset.season$Flow.state.ID <- ifelse(is.na(subset.season$Flow.state.ID),1,subset.season$Flow.state.ID)
   
    for (j in 1:length(subset.season$Date)) {
      if (j == 1 & subset.season$Flow.state.ID[j] == 0) {
        subset.season$consec.nf.days[j] <- 1
      } else if (j > 1 & subset.season$Flow.state.ID[j] == 0) {
        subset.season$consec.nf.days[j] <-
          subset.season$Flow.state.ID[j] + 1 + subset.season$consec.nf.days[j - 1]
      } else {
        subset.season$consec.nf.days[j] <- 0
      }
     
    }
    max.noflow.duration.season[i, k] <- max(subset.season$consec.nf.days)
    } else {NA}
   
  }
}

max.noflow.duration.season$year <- as.numeric(years)

max.nf.senslope.winter <- sens.output(time.step=max.noflow.duration.season$year,data=max.noflow.duration.season$winter)
max.nf.senslope.spring <- sens.output(time.step=max.noflow.duration.season$year,data=max.noflow.duration.season$spring)
max.nf.senslope.summer <- sens.output(time.step=max.noflow.duration.season$year,data=max.noflow.duration.season$summer)
max.nf.senslope.autumn <- sens.output(time.step=max.noflow.duration.season$year,data=max.noflow.duration.season$autumm)
max.nf.senslope.seasons <- rbind(max.nf.senslope.winter,max.nf.senslope.spring,max.nf.senslope.summer,max.nf.senslope.autumn)
max.nf.senslope.seasons$season <- seasons

max.noflow.duration.season.long <- gather(max.noflow.duration.season, key="season", value="value", c("winter","spring","summer","autumm",))

ggplot(max.noflow.duration.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=max.nf.senslope.seasons, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Falling Rock Seasonal Maximum No-Flow Duration")

#monthly
max.flow.duration.month <- data.frame(matrix(nrow=length(years),ncol=length(months))) 
colnames(max.flow.duration.month) <- months
max.flow.duration.month$year <- years

for (i in 1:length(years)) {
  for (k in 1:length(months)) {
    if (length(FallingRock[which(FallingRock$year == years[i] & FallingRock$month == months[k]),8])!=0) {
      subset.month <-FallingRock[which(FallingRock$year==years[i]&FallingRock$month==months[k]),]
    subset.month$consec.days <- NA
    subset.month$Flow.state.ID <- ifelse(is.na(subset.month$Flow.state.ID),1,subset.month$Flow.state.ID)
   
    for (j in 1:length(subset.month$Date)) {
      if (j == 1 & subset.month$Flow.state.ID[j] == 1) {
        subset.month$consec.days[j] <- 1
      } else if (j > 1 & subset.month$Flow.state.ID[j] == 1) {
        subset.month$consec.days[j] <-
          subset.month$Flow.state.ID[j] + subset.month$consec.days[j - 1]
      } else {
        subset.month$consec.days[j] <- 0
      }
     
    }
    max.flow.duration.month[i, k] <- max(subset.month$consec.days)
    } else {NA}
   
  }
}

max.noflow.duration.month <- data.frame(matrix(nrow=length(years),ncol=length(months)))
colnames(max.noflow.duration.month) <- months
max.noflow.duration.month$year <- years

for (i in 1:length(years)) {
  for (k in 1:length(months)) {
    if (length(FallingRock[which(FallingRock$year == years[i] & FallingRock$month == months[k]),8])!=0) {
      subset.month <-FallingRock[which(FallingRock$year==years[i]&FallingRock$month==months[k]),]
    subset.month$consec.nf.days <- NA
    subset.month$Flow.state.ID <- ifelse(is.na(subset.month$Flow.state.ID),1,subset.month$Flow.state.ID)
   
    for (j in 1:length(subset.month$Date)) {
      if (j == 1 & subset.month$Flow.state.ID[j] == 0) {
        subset.month$consec.nf.days[j] <- 1
      } else if (j > 1 & subset.month$Flow.state.ID[j] == 0) {
        subset.month$consec.nf.days[j] <-
          subset.month$Flow.state.ID[j] + 1 + subset.month$consec.nf.days[j - 1]
      } else {
        subset.month$consec.nf.days[j] <- 0
      }
     
    }
    max.noflow.duration.month[i, k] <- max(subset.month$consec.nf.days)
    } else {NA}
   
  }
}
colnames(max.noflow.duration.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
max.noflow.duration.month$year <- years
max.nf.senslope.jan <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$January)
max.nf.senslope.feb <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$February)
max.nf.senslope.mar <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$March)
max.nf.senslope.apr <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$April)
max.nf.senslope.may <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$May)
max.nf.senslope.jun <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$June)
max.nf.senslope.jul <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$July)
max.nf.senslope.aug <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$August)
max.nf.senslope.sep <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$September)
max.nf.senslope.oct <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$October)
max.nf.senslope.nov <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$November)
max.nf.senslope.dec <- sens.output(time.step=max.noflow.duration.month$year,data=max.noflow.duration.month$December)
max.nf.senslope.month <- rbind(max.nf.senslope.jan,max.nf.senslope.feb,max.nf.senslope.mar,max.nf.senslope.apr,max.nf.senslope.may,max.nf.senslope.jun,max.nf.senslope.jul,max.nf.senslope.aug,max.nf.senslope.sep,max.nf.senslope.oct,max.nf.senslope.nov,max.nf.senslope.dec)
max.nf.senslope.month$Month <- unique(FallingRock$Month)
max.noflow.duration.month.long <- gather(max.noflow.duration.month, key="Month", value="value", c("January","February","March","April","May","June","July","August","September","October","November","December"))

ggplot(max.noflow.duration.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=max.nf.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Falling Rock Monthly Maximum No-Flow Duration")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

## Section 7.1: Longest Consecutive No-Flow Statistical Summary
```{r}
FR.longest.nf.statistical.summary <- rbind.fill(max.nf.senslope.halfdec,max.nf.senslope.year,max.nf.senslope.wateryear,max.nf.senslope.climateyear,max.nf.senslope.seasons,max.nf.senslope.month)
```


#Section 8: Magnitude
##Section 8.1: Peak Flows
```{r}
#1/2 Decade
max.discharge.halfdec <- data.frame(matrix(nrow=length(half.decades)))
for(i in 1:length(discharge.half.dec)){
  max.discharge.halfdec[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$half.decade==half.decades[i])])
}
colnames(max.discharge.halfdec) <- c("Peak_Flow")
max.discharge.halfdec$halfdec <- half.decades
max.discharge.halfdec <- na.omit(max.discharge.halfdec)
max.flow.senslope.halfdec <- sens.output(time.step=max.discharge.halfdec$halfdec,data=max.discharge.halfdec$Peak_Flow)
max.flow.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(data=max.discharge.halfdec, aes(halfdec,Peak_Flow))+
  geom_bar(stat="identity")+
  geom_abline(data=max.flow.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("Discharge (cfs)")+
  ggtitle("Falling Rock Maximum Half-Decadal Discharge")
  
#Yearly
max.discharge.per.year <- data.frame(matrix(nrow=length(discharge.year)-2))
for(i in 1:length(discharge.year)){
  max.discharge.per.year[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$year==discharge.year[i])])
}
colnames(max.discharge.per.year) <- c("Peak_Flow")
max.discharge.per.year$year <- years
max.discharge.per.year <- na.omit(max.discharge.per.year)

max.flow.senslope.year <- sens.output(time.step=max.discharge.per.year$year,data=max.discharge.per.year$Peak_Flow)
max.flow.senslope.year$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_peak.cal.jpeg", width=1000)
ggplot(data=max.discharge.per.year, aes(year,Peak_Flow))+
  geom_bar(stat="identity")+
  geom_abline(data=max.flow.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("year")+
  ylab("Discharge (cfs)")+
  ggtitle("Falling Rock Maximum Yearly Discharge")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
max.discharge.per.wateryear <- data.frame(matrix(nrow=length(water.years)))
for(i in 1:length(water.years)){
  max.discharge.per.wateryear[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$Water_Year==water.years[i])])
}
colnames(max.discharge.per.wateryear) <- c("Peak_Flow")
max.discharge.per.wateryear$Water_Year <- water.years
max.discharge.per.wateryear <- na.omit(max.discharge.per.wateryear)

max.flow.senslope.wateryear <- sens.output(time.step=max.discharge.per.wateryear$Water_Year,data=max.discharge.per.wateryear$Peak_Flow)
max.flow.senslope.wateryear$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_peak.water.jpeg", width=1000)
ggplot(data=max.discharge.per.wateryear, aes(Water_Year,Peak_Flow))+
  geom_bar(stat="identity")+
  geom_abline(data=max.flow.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("year")+
  ylab("Discharge (cfs)")+
  ggtitle("Falling Rock Maximum Yearly Discharge Using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
max.discharge.per.climateyear <- data.frame(matrix(nrow=length(climate.years)))
for(i in 1:length(climate.years)){
  max.discharge.per.climateyear[i,1] <- max(FallingRock$maxdaily_CFS[which(FallingRock$Climate_Year==climate.years[i])])
}
colnames(max.discharge.per.climateyear) <- c("Peak_Flow")
max.discharge.per.climateyear$Climate_year <- climate.years
max.discharge.per.climateyear <- na.omit(max.discharge.per.climateyear)

max.flow.senslope.climateyear <- sens.output(time.step=max.discharge.per.climateyear$Climate_year,data=max.discharge.per.climateyear$Peak_Flow)
max.flow.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_peak.clim.jpeg", width=1000)
ggplot(data=max.discharge.per.climateyear, aes(Climate_year,Peak_Flow))+
  geom_bar(stat="identity")+
  geom_abline(data=max.flow.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("year")+
  ylab("Discharge (cfs)")+
  ggtitle("Falling Rock Maximum Yearly Discharge Using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Seasonal
max.discharge.per.season <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.season)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.season)){
    max.discharge.per.season[i,j] <- max(FallingRock$maxdaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$season==discharge.season[j])])
  }
}
colnames(max.discharge.per.season) <- c("Winter","Spring","Summer","Autumn")
max.discharge.per.season$year <- years
max.discharge.per.season <- na.omit(max.discharge.per.season)
max.discharge.per.season.long <- gather(max.discharge.per.season, key="season", value="value", c("Summer", "Autumn","Winter", "Spring"))

max.flow.senslope.winter <- sens.output(time.step=max.discharge.per.season$year,data=max.discharge.per.season$Winter)
max.flow.senslope.spring <- sens.output(time.step=max.discharge.per.season$year,data=max.discharge.per.season$Spring)
max.flow.senslope.summer <- sens.output(time.step=max.discharge.per.season$year,data=max.discharge.per.season$Summer)
max.flow.senslope.autumn <- sens.output(time.step=max.discharge.per.season$year,data=max.discharge.per.season$Autumn)
max.flow.senslope.season <- rbind(max.flow.senslope.winter,max.flow.senslope.spring,max.flow.senslope.summer,max.flow.senslope.autumn)
max.flow.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

ggplot(max.discharge.per.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=max.flow.senslope.season, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  ggtitle("Falling Rock Maximum Seasonal Discharge")

#Monthly
max.discharge.per.month <- data.frame(matrix(nrow=length(discharge.year),ncol=length(discharge.month)))
for(i in 1:length(discharge.year)){
  for(j in 1:length(discharge.month)){
    max.discharge.per.month[i,j] <- max(FallingRock$maxdaily_CFS[which(FallingRock$year==discharge.year[i]&FallingRock$month==discharge.month[j])])
  }}
colnames(max.discharge.per.month) <- c("January","February","March","April","May","June","July", "August","September","October","November","December")
max.discharge.per.month$year <- as.numeric(years)
max.discharge.per.month.long <- gather(max.discharge.per.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
max.discharge.per.month <- na.omit(max.discharge.per.month)
max.flow.senslope.jan <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$January)
max.flow.senslope.feb <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$February)
max.flow.senslope.mar <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$March)
max.flow.senslope.apr <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$April)
max.flow.senslope.may <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$May)
max.flow.senslope.jun <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$June)
max.flow.senslope.jul <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$July)
max.flow.senslope.aug <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$August)
max.flow.senslope.sep <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$September)
max.flow.senslope.oct <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$October)
max.flow.senslope.nov <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$November)
max.flow.senslope.dec <- sens.output(time.step=max.discharge.per.month$year,data=max.discharge.per.month$December)
max.flow.senslope.month <- rbind(max.flow.senslope.jan,max.flow.senslope.feb,max.flow.senslope.mar,max.flow.senslope.apr,max.flow.senslope.may,max.flow.senslope.jun,max.flow.senslope.jul,max.flow.senslope.aug,max.flow.senslope.sep,max.flow.senslope.oct,max.flow.senslope.nov,max.flow.senslope.dec)
max.flow.senslope.month$Month <- unique(FallingRock$Month)

ggplot(max.discharge.per.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=max.flow.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  ggtitle("Falling Rock Maximum Monthly Discharge")

```
### Section 8.1.1: Peak Flow Statistical Summary
```{r}
FR.PeakFlow.statistical.summary <- rbind.fill(max.flow.senslope.halfdec,max.flow.senslope.year,max.flow.senslope.wateryear,max.flow.senslope.climateyear,max.flow.senslope.season,max.flow.senslope.month)
```

## Section 8.2: Finding the Slope of the Flow Duration Curves
```{r}
#Timeseries
fdc <- data.frame("sort.data"=sort(FallingRock$meandaily_CFS,decreasing = TRUE))
#sorting the data in decreasing order
fdc$rank <- 1:length(fdc$sort.data)
#adding a rank to the flows in the data frame
fdc$probability <- ((fdc$rank)/(1+length(fdc$rank)))*100
# adding the probability of the flows
fdc.20 <- fdc$sort.data[which.min(abs(fdc$probability-20))]
fdc.70 <- fdc$sort.data[which.min(abs(fdc$probability-70))]
fdc.slope <- (fdc.20-fdc.70)/50
print(fdc.slope)

#1/2 Decade
FDC_halfdec=list()#creating a new list for the flow duration curves
half.decades <- unique(FallingRock$half.decade)
for(i in 1:(length(half.decades))) {
  FDC_halfdec[[i]] <- data.frame("sort.data"=sort(na.omit(FallingRock$meandaily_CFS[which(FallingRock$half.decade==half.decades[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
  FDC_halfdec[[i]]$rank <- 1:length(FDC_halfdec[[i]]$sort.data)#adding a rank column where highest flow is 1
  FDC_halfdec[[i]]$probability<-((FDC_halfdec[[i]]$rank)/(length(FDC_halfdec[[i]]$rank)+1))*100
}
#finding the probability of each event
FDC_halfdec_stats <- data.frame(matrix(nrow=length(half.decades),ncol=1))
colnames(FDC_halfdec_stats) <- c("halfdec")
FDC_halfdec_stats$halfdec <- half.decades
for(i in 1:length(half.decades)){
  FDC_halfdec_stats$twenty[i] <- FDC_halfdec[[i]]$sort.data[which.min(abs((FDC_halfdec[[i]]$probability)-20))]
  FDC_halfdec_stats$seventy[i] <- FDC_halfdec[[i]]$sort.data[which.min(abs((FDC_halfdec[[i]]$probability)-70))]
} #finding the probability of each event
FDC_halfdec_stats$slope <- ((FDC_halfdec_stats$twenty)-(FDC_halfdec_stats$seventy))/50
fdc.slope.senslope.halfdec <- sens.output(time.step=FDC_halfdec_stats$halfdec,data=FDC_halfdec_stats$slope)
fdc.slope.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(data=FDC_halfdec_stats, aes(x=halfdec,y=slope))+
  geom_bar(stat="identity")+
  geom_abline(data=fdc.slope.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("Slope")+
  ggtitle("Falling Rock Half-Decadal Slope of Midpoint of FDC")

#Yearly
FDC_years=list()#creating a new list for the flow duration curves
years <- unique(FallingRock$year)
for(i in 1:(length(unique(FallingRock$year))-3))#running a for loop on all the years with 90% of data
  {
  FDC_years[[i]] <- data.frame("sort.data"=sort(na.omit(FallingRock$meandaily_CFS[which(FallingRock$year==years[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
FDC_years[[i]]$rank <- 1:length(FDC_years[[i]]$sort.data)#adding a rank column where highest flow is 1
FDC_years[[i]]$probability<-((FDC_years[[i]]$rank)/(length(FDC_years[[i]]$rank)+1))*100
} #finding the probability of each event


FDC_year_stats <- data.frame(matrix(nrow=(length(FDC_years)),ncol=1))
colnames(FDC_year_stats) <- c("year")
FDC_year_stats$year <- c(1980:2012)
for(i in 1:length(unique(FDC_year_stats$year))){
  FDC_year_stats$twenty[i] <- FDC_years[[i]]$sort.data[which.min(abs((FDC_years[[i]]$probability)-20))]
  FDC_year_stats$seventy[i] <- FDC_years[[i]]$sort.data[which.min(abs((FDC_years[[i]]$probability)-70))]
} #finding the probability of each event
FDC_year_stats$slope <- ((FDC_year_stats$twenty)-(FDC_year_stats$seventy))/50
FDC.slope.senslope.year <- sens.output(time.step=FDC_year_stats$year,data=FDC_year_stats$slope)
FDC.slope.senslope.year$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_slopefdc.cal.jpeg", width=1000)
ggplot(data=FDC_year_stats, aes(x=year, y=slope))+
  geom_bar(stat="identity")+
  geom_abline(data=FDC.slope.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Falling Rock Yearly Slope of Midpoint of FDC")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
FDC_wateryears=list()#creating a new list for the flow duration curves
for(i in 1:(length(unique(FallingRock$Water_Year))))
  {
  FDC_wateryears[[i]] <- data.frame("sort.data"=sort(na.omit(FallingRock$meandaily_CFS[which(FallingRock$Water_Year==water.years[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
FDC_wateryears[[i]]$rank <- 1:length(FDC_wateryears[[i]]$sort.data)#adding a rank column where highest flow is 1
FDC_wateryears[[i]]$probability<-((FDC_wateryears[[i]]$rank)/(length(FDC_wateryears[[i]]$rank)+1))*100
} #finding the probability of each event

FDC_wateryear_stats <- data.frame(matrix(nrow=(length(FDC_wateryears)),ncol=1))
colnames(FDC_wateryear_stats) <- c("year")
FDC_wateryear_stats$Water_Year <- water.years
for(i in 1:length(unique(FDC_wateryear_stats$Water_Year))){
  FDC_wateryear_stats$twenty[i] <- FDC_wateryears[[i]]$sort.data[which.min(abs((FDC_wateryears[[i]]$probability)-20))]
  FDC_wateryear_stats$seventy[i] <- FDC_wateryears[[i]]$sort.data[which.min(abs((FDC_wateryears[[i]]$probability)-70))]
} #finding the probability of each event
FDC_wateryear_stats$slope <- ((FDC_wateryear_stats$twenty)-(FDC_wateryear_stats$seventy))/50
FDC.slope.senslope.wateryear <- sens.output(time.step=FDC_wateryear_stats$Water_Year,data=FDC_wateryear_stats$slope)
FDC.slope.senslope.wateryear$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_slopefdc.water.jpeg", width=1000)
ggplot(data=FDC_wateryear_stats, aes(x=Water_Year, y=slope))+
  geom_bar(stat="identity")+
  geom_abline(data=FDC.slope.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Falling Rock Yearly Slope of Midpoint of FDC using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
FDC_climateyears=list()#creating a new list for the flow duration curves
for(i in 1:(length(unique(FallingRock$Climate_Year))))
  {
  FDC_climateyears[[i]] <- data.frame("sort.data"=sort(na.omit(FallingRock$meandaily_CFS[which(FallingRock$Climate_Year==climate.years[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
FDC_climateyears[[i]]$rank <- 1:length(FDC_climateyears[[i]]$sort.data)#adding a rank column where highest flow is 1
FDC_climateyears[[i]]$probability<-((FDC_climateyears[[i]]$rank)/(length(FDC_climateyears[[i]]$rank)+1))*100
} #finding the probability of each event

FDC_climateyear_stats <- data.frame(matrix(nrow=(length(FDC_climateyears)),ncol=1))
colnames(FDC_climateyear_stats) <- c("year")
FDC_climateyear_stats$Climate_Year <- climate.years
for(i in 1:length(unique(FDC_climateyear_stats$Climate_Year))){
  FDC_climateyear_stats$twenty[i] <- FDC_climateyears[[i]]$sort.data[which.min(abs((FDC_climateyears[[i]]$probability)-20))]
  FDC_climateyear_stats$seventy[i] <- FDC_climateyears[[i]]$sort.data[which.min(abs((FDC_climateyears[[i]]$probability)-70))]
} #finding the probability of each event
FDC_climateyear_stats$slope <- ((FDC_climateyear_stats$twenty)-(FDC_climateyear_stats$seventy))/50
FDC.slope.senslope.climateyear <- sens.output(time.step=FDC_climateyear_stats$Climate_Year,data=FDC_climateyear_stats$slope)
FDC.slope.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_slopefdc.clim.jpeg", width=1000)
ggplot(data=FDC_climateyear_stats, aes(x=Climate_Year, y=slope))+
  geom_bar(stat="identity")+
  geom_abline(data=FDC.slope.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Falling Rock Yearly Slope of Midpoint of FDC using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Seasonal
slope.seasonal <- data.frame(matrix(ncol=length(seasons),nrow=length(years)))
seasonal.flow.twenty <-  data.frame(matrix(ncol=length(seasons),nrow=length(years)))
seasonal.flow.seventy <-  data.frame(matrix(ncol=length(seasons),nrow=length(years)))


for(i in 1:length(years)){
  for(j in 1:length(seasons)){
    subset.flow.season <- data.frame(FallingRock[which(FallingRock$year==years[i]&FallingRock$season==seasons[j]),])
    if(length(subset.flow.season$Date)>0&sum(is.na(subset.flow.season$meandaily_CFS))<length(subset.flow.season$Date)){
      sort.flow.season <- data.frame(sort(subset.flow.season$meandaily_CFS,decreasing=TRUE))
      colnames(sort.flow.season) <- c("Flow")
      sort.flow.season$rank <- 1:length(sort.flow.season$Flow)
      sort.flow.season$probability <- (sort.flow.season$rank/(1+length(sort.flow.season$rank)))*100
      seasonal.flow.twenty[i,j]<-sort.flow.season$Flow[which.min(abs(sort.flow.season$probability-20))]
      seasonal.flow.seventy[i,j]<-sort.flow.season$Flow[which.min(abs(sort.flow.season$probability-70))]
      slope.seasonal[i,j] <- (seasonal.flow.twenty[i,j]-seasonal.flow.seventy[i,j])/50
    }
    else{
      seasonal.flow.twenty[i,j] <- NA
      seasonal.flow.seventy[i,j] <- NA
      slope.seasonal[i,j] <- NA
    }
  }
}
colnames(slope.seasonal) <- c("Winter","Spring","Summer","Autumn")
slope.seasonal$year <- years

slope.seasonal.long <- gather(slope.seasonal, key="season", value="value", c("Winter","Spring","Summer","Autumn"))
FDC.slope.senslope.winter <- sens.output(time.step=slope.seasonal$year,data=slope.seasonal$Winter)
FDC.slope.senslope.spring <- sens.output(time.step=slope.seasonal$year,data=slope.seasonal$Spring)
FDC.slope.senslope.summer <- sens.output(time.step=slope.seasonal$year,data=slope.seasonal$Summer)
FDC.slope.senslope.autumn <- sens.output(time.step=slope.seasonal$year,data=slope.seasonal$Autumn)
FDC.slope.senslope.season <- rbind(FDC.slope.senslope.winter,FDC.slope.senslope.spring,FDC.slope.senslope.summer,FDC.slope.senslope.autumn)
FDC.slope.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

ggplot(slope.seasonal.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=FDC.slope.senslope.season, aes(slope=slope, intercept=intercept))+
  facet_wrap(~season)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Falling Rock Seasonal Slope of Midpoint of FDC")

#monthly
slope.monthly <- data.frame(matrix(ncol=length(months),nrow=length(years)))
monthly.flow.twenty <-  data.frame(matrix(ncol=length(months),nrow=length(years)))
monthly.flow.seventy <-  data.frame(matrix(ncol=length(months),nrow=length(years)))


for(i in 1:length(years)){
  for(j in 1:length(months)){
    subset.flow.month <- data.frame(FallingRock[which(FallingRock$year==years[i]&FallingRock$month==months[j]),])
    if(length(subset.flow.month$Date)>0&sum(is.na(subset.flow.month$meandaily_CFS))<length(subset.flow.month$Date)){
      sort.flow.month <- data.frame(sort(subset.flow.month$meandaily_CFS,decreasing=TRUE))
      colnames(sort.flow.month) <- c("Flow")
      sort.flow.month$rank <- 1:length(sort.flow.month$Flow)
      sort.flow.month$probability <- (sort.flow.month$rank/(1+length(sort.flow.month$rank)))*100
      monthly.flow.twenty[i,j]<-sort.flow.month$Flow[which.min(abs(sort.flow.month$probability-20))]
      monthly.flow.seventy[i,j]<-sort.flow.month$Flow[which.min(abs(sort.flow.month$probability-70))]
      slope.monthly[i,j] <- (monthly.flow.twenty[i,j]-monthly.flow.seventy[i,j])/50
    }
    else{
      monthly.flow.twenty[i,j] <- NA
      monthly.flow.seventy[i,j] <- NA
      slope.monthly[i,j] <- NA
    }
  }
}

colnames(slope.monthly) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
slope.monthly$year <- unique(FallingRock$year)

slope.monthly.long <- gather(slope.monthly, key="Month", value="value", c("January","February","March","April","May","June","July","August","September","October","November","December"))
slope.monthly.long <- na.omit(slope.monthly.long)
slope.monthly <- na.omit(slope.monthly)
FDC.slope.senslope.jan <- sens.output(time.step=slope.monthly$year,data=slope.monthly$January)
FDC.slope.senslope.feb <- sens.output(time.step=slope.monthly$year,data=slope.monthly$February)
FDC.slope.senslope.mar <- sens.output(time.step=slope.monthly$year,data=slope.monthly$March)
FDC.slope.senslope.apr <- sens.output(time.step=slope.monthly$year,data=slope.monthly$April)
FDC.slope.senslope.may <- sens.output(time.step=slope.monthly$year,data=slope.monthly$May)
FDC.slope.senslope.jun <- sens.output(time.step=slope.monthly$year,data=slope.monthly$June)
FDC.slope.senslope.jul <- sens.output(time.step=slope.monthly$year,data=slope.monthly$July)
FDC.slope.senslope.aug <- sens.output(time.step=slope.monthly$year,data=slope.monthly$August)
FDC.slope.senslope.sep <- sens.output(time.step=slope.monthly$year,data=slope.monthly$September)
FDC.slope.senslope.oct <- sens.output(time.step=slope.monthly$year,data=slope.monthly$October)
FDC.slope.senslope.nov <- sens.output(time.step=slope.monthly$year,data=slope.monthly$November)
FDC.slope.senslope.dec <- sens.output(time.step=slope.monthly$year,data=slope.monthly$December)
FDC.slope.senslope.month <- rbind(FDC.slope.senslope.jan,FDC.slope.senslope.feb,FDC.slope.senslope.mar,FDC.slope.senslope.apr,FDC.slope.senslope.may,FDC.slope.senslope.jun,FDC.slope.senslope.jul,FDC.slope.senslope.aug,FDC.slope.senslope.sep,FDC.slope.senslope.oct,FDC.slope.senslope.nov,FDC.slope.senslope.dec)
FDC.slope.senslope.month$Month <- unique(FallingRock$Month)

ggplot(slope.monthly.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=FDC.slope.senslope.month, aes(slope=slope, intercept=intercept))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Falling Rock Monthly Slope of Midpoint of FDC")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

```
### Section 8.2.1: Slope of FDC Statistical Summary
```{r}
FR.FDCslope.statistical.summary <- rbind.fill(fdc.slope.senslope.halfdec,FDC.slope.senslope.year,FDC.slope.senslope.wateryear,FDC.slope.senslope.climateyear,FDC.slope.senslope.season,FDC.slope.senslope.month)
```

##Section 8.3: Water Budget
```{r}

FallingRock$FlowVolume <- FallingRock$meandaily_CFS*86400
#1/2 Decade

vol.precip.halfdec <- data.frame(matrix(nrow=length(half.decades),ncol=1)) #creating a matrix to sum the precipitation in each year 
precip.half.dec <- unique(FallingRock.precip.data$half.decade)

sum.flow.halfdec <- data.frame(matrix(nrow=length(half.decades),ncol=1)) 
for(i in 1:length(precip.half.dec)){ #running a for loop through each year in precip data
  vol.precip.halfdec[i,1] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$half.decade==precip.half.dec[i])],na.rm=TRUE)*(1/25.4)*(1/12)*9472240
  sum.flow.halfdec[i,1] <- median(FallingRock$mindaily_CFS[which(FallingRock$half.decade==precip.half.dec[i])],na.rm=TRUE)*(86400)*365*5
  
  #assigning a new variable for the sum of each years precip data
}

Water.budget.halfdec <- sum.flow.halfdec/vol.precip.halfdec
colnames(Water.budget.halfdec) <- c("Water_Budget")
Water.budget.halfdec$halfdec <- half.decades
Water.budget.halfdec <- na.omit(Water.budget.halfdec)
water.budget.halfdec.senslope <- sens.output(time.step=Water.budget.halfdec$halfdec,data=Water.budget.halfdec$Water_Budget)
water.budget.halfdec.senslope$half.decade <- "Half.Decade"


ggplot(data=Water.budget.halfdec, aes(x=halfdec, y=Water_Budget))+
  geom_bar(stat="identity")+
  geom_abline(data=water.budget.halfdec.senslope, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("Water Budget")+
  ggtitle("Falling Rock Half-Decadal Water Budget")

#Yearly
FallingRock.precip.data$year <- Falling.rock.precip$year
precip.year <- unique(FallingRock.precip.data$year)
vol.precip.year <- data.frame(matrix(nrow=length(precip.year),ncol=1)) #creating a matrix to sum the precipitation in each year 
sum.flow.year <- data.frame(matrix(nrow=length(precip.year),ncol=1)) 
for(i in 1:length(precip.year)){ #running a for loop through each year in precip data
  vol.precip.year[i,1] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$year==precip.year[i])]*(1/25.4)*(1/12)*9472240,na.rm=TRUE)
  sum.flow.year[i,1] <- median(FallingRock$mindaily_CFS[which(FallingRock$year==precip.year[i])],na.rm=TRUE)*(86400)*365
  #assigning a new variable for the sum of each years precip data
}

Water.budget.year <- sum.flow.year/vol.precip.year
colnames(Water.budget.year) <- c("Water_Budget")
Water.budget.year$year <- precip.year
Water.budget.year <- na.omit(Water.budget.year)
water.budget.year.senslope <- sens.output(time.step=Water.budget.year$year,data=Water.budget.year$Water_Budget)
water.budget.year.senslope$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_wb.cal.jpeg", width=1000)
ggplot(data=Water.budget.year, aes(x=year, y=Water_Budget))+
  geom_bar(stat="identity")+
  geom_abline(data=water.budget.year.senslope, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Falling Rock Yearly Water Budget")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
vol.precip.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1)) #creating a matrix to sum the precipitation in each year 
sum.flow.wateryear <- data.frame(matrix(nrow=length(water.years),ncol=1)) 
for(i in 1:length(water.years)){ #running a for loop through each year in precip data
  vol.precip.wateryear[i,1] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$Water_Year==water.years[i])]*(1/25.4)*(1/12)*9472240,na.rm=TRUE)
  sum.flow.wateryear[i,1] <- median(FallingRock$mindaily_CFS[which(FallingRock$Water_Year==water.years[i])],na.rm=TRUE)*(86400)*365
  #assigning a new variable for the sum of each years precip data
}

Water.budget.wateryear <- sum.flow.wateryear/vol.precip.wateryear
colnames(Water.budget.wateryear) <- c("Water_Budget")
Water.budget.wateryear$Water_Year <- water.years
Water.budget.wateryear <- na.omit(Water.budget.wateryear)
water.budget.wateryear.senslope <- sens.output(time.step=Water.budget.wateryear$Water_Year,data=Water.budget.wateryear$Water_Budget)
water.budget.wateryear.senslope$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_wb.water.jpeg", width=1000)
ggplot(data=Water.budget.wateryear, aes(x=Water_Year, y=Water_Budget))+
  geom_bar(stat="identity")+
  geom_abline(data=water.budget.wateryear.senslope, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Falling Rock Yearly Water Budget Using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
vol.precip.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1)) #creating a matrix to sum the precipitation in each year 
sum.flow.climateyear <- data.frame(matrix(nrow=length(climate.years),ncol=1)) 
for(i in 1:length(climate.years)){ #running a for loop through each year in precip data
  vol.precip.climateyear[i,1] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$Climate_Year==climate.years[i])]*(1/25.4)*(1/12)*9472240,na.rm=TRUE)
  sum.flow.climateyear[i,1] <- median(FallingRock$mindaily_CFS[which(FallingRock$Climate_Year==climate.years[i])],na.rm=TRUE)*(86400)*365
  #assigning a new variable for the sum of each years precip data
}

Water.budget.climateyear <- sum.flow.climateyear/vol.precip.climateyear
colnames(Water.budget.climateyear) <- c("Water_Budget")
Water.budget.climateyear$Climate_Year <- climate.years
Water.budget.climateyear <- na.omit(Water.budget.climateyear)
Water.budget.climateyear <- Water.budget.climateyear[-1,]
water.budget.climateyear.senslope <- sens.output(time.step=Water.budget.climateyear$Climate_Year,data=Water.budget.climateyear$Water_Budget)
water.budget.climateyear.senslope$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR_wb.clim.jpeg", width=1000)
ggplot(data=Water.budget.climateyear, aes(x=Climate_Year, y=Water_Budget))+
  geom_bar(stat="identity")+
  geom_abline(data=water.budget.climateyear.senslope, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Falling Rock Yearly Water Budget Using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Seasonal
precip.season <- c("winter","spring","summer","autumm")
vol.precip.season <- data.frame(matrix(nrow=length(precip.year),ncol=length(precip.season))) #creating a matrix to sum the precipitation in each year 
sum.flow.season <- data.frame(matrix(nrow=length(precip.year),ncol=length(precip.season))) 
for(i in 1:length(precip.year)){
  for(j in 1:length(precip.season)){#running a for loop through each year in precip data
  vol.precip.season[i,j] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$year==precip.year[i]&FallingRock.precip.data$season==precip.season[j])],na.rm=TRUE)*0.0394*(1/12)*9472240
  sum.flow.season[i,j] <- median(FallingRock$mindaily_CFS[which(FallingRock$year==precip.year[i]&FallingRock$season==precip.season[j])],na.rm=TRUE)*86400*365*0.25
  }
  #assigning a new variable for the sum of each years precip data
}
colnames(sum.flow.season) <- c("Winter","Spring","Summer","Autumn")
colnames(vol.precip.season) <- c("Winter","Spring","Summer","Autumn")

Water.budget.season <- data.frame(matrix(ncol=5, nrow=length(sum.flow.season$Winter)))
colnames(Water.budget.season) <- c("Winter","Spring","Summer","Autumn","Year")

Water.budget.season$Winter <- sum.flow.season$Winter/vol.precip.season$Winter
Water.budget.season$Spring <- sum.flow.season$Spring/vol.precip.season$Spring
Water.budget.season$Summer <- sum.flow.season$Summer/vol.precip.season$Summer
Water.budget.season$Autumn <- sum.flow.season$Autumn/vol.precip.season$Autumn
Water.budget.season$year <- as.numeric(precip.year)
Water.budget.season.long <- gather(Water.budget.season, key="season", value="value", c("Summer","Autumn","Winter","Spring"))

water.budget.winter.senslope <- sens.output(time.step=Water.budget.season$year,data=Water.budget.season$Winter)
water.budget.spring.senslope <- sens.output(time.step=Water.budget.season$year,data=Water.budget.season$Spring)
water.budget.summer.senslope <- sens.output(time.step=Water.budget.season$year,data=Water.budget.season$Summer)
water.budget.autumn.senslope <- sens.output(time.step=Water.budget.season$year,data=Water.budget.season$Autumn)
water.budget.season.senslope <- rbind(water.budget.winter.senslope,water.budget.spring.senslope,water.budget.summer.senslope,water.budget.autumn.senslope)
water.budget.season.senslope$season <- c("Winter","Spring","Summer","Autumn")

ggplot(Water.budget.season.long, aes(x=year, y=value))+
  geom_abline(data=water.budget.season.senslope, aes(slope=slope, intercept=intercept))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Falling Rock Seasonal Water Budget")



#Monthly
precip.month <- unique(FallingRock.precip.data$month)
vol.precip.month <- data.frame(matrix(nrow=length(precip.year),ncol=length(precip.month))) #creating a matrix to sum the precipitation in each year 
sum.flow.month <- data.frame(matrix(nrow=length(precip.year),ncol=length(precip.month))) 
for(i in 1:length(precip.year)){
  for(j in 1:length(precip.month)){#running a for loop through each year in precip data
  vol.precip.month[i,j] <- sum(FallingRock.precip.data$Precip_mm[which(FallingRock.precip.data$year==precip.year[i]&FallingRock.precip.data$month==precip.month[j])],na.rm=TRUE)*0.0394*(1/12)*9472240
  sum.flow.month[i,j] <- median(FallingRock$mindaily_CFS[which(FallingRock$year==precip.year[i]&FallingRock$month==precip.month[j])],na.rm=TRUE)*86400*365*(1/12)
  }
  #assigning a new variable for the sum of each years precip data
}

Water.budget.month <- sum.flow.month/vol.precip.month
colnames(Water.budget.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
Water.budget.month$year <- precip.year
Water.budget.month.long <- gather(Water.budget.month, key="Month", value="value", c("January","February","March","April","May","June","July","August","September","October","November","December"))
Water.budget.month.long <- na.omit(Water.budget.month.long)
Water.budget.month <- na.omit(Water.budget.month)

water.budget.jan.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$January)
water.budget.feb.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$February)
water.budget.mar.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$March)
water.budget.apr.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$April)
water.budget.may.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$May)
water.budget.jun.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$June)
water.budget.jul.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$July)
water.budget.aug.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$August)
water.budget.sep.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$September)
water.budget.oct.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$October)
water.budget.nov.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$November)
water.budget.dec.senslope <- sens.output(time.step=Water.budget.month$year,data=Water.budget.month$December)
water.budget.month.senslope <- rbind(water.budget.jan.senslope,water.budget.feb.senslope,water.budget.mar.senslope,water.budget.apr.senslope,water.budget.may.senslope,water.budget.jun.senslope,water.budget.jul.senslope,water.budget.aug.senslope,water.budget.sep.senslope,water.budget.oct.senslope,water.budget.nov.senslope,water.budget.dec.senslope)
water.budget.month.senslope$Month <- c("January","February","March","April","May","June","July","August","September","October","November","December")

ggplot(Water.budget.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=water.budget.month.senslope, aes(slope=slope, intercept=intercept))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Falling Rock Monthly Water Budget")

```

### Section 8.3.1: Water Budget Statistical Summary
```{r}
FR.Waterbudget.statistical.summary <- rbind.fill(water.budget.halfdec.senslope,water.budget.year.senslope,water.budget.wateryear.senslope,water.budget.climateyear.senslope,water.budget.season.senslope,water.budget.month.senslope)
```

# Section 9: Printing to PDF
```{r}
pdf("FR.waterbudget.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Waterbudget.statistical.summary)

write.csv(FR.Waterbudget.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.waterbudget.statsum.csv", row.names=FALSE)

pdf("FR.FDCslope.statsum.pdf", width=10)       # Export PDF
grid.table(FR.FDCslope.statistical.summary)

write.csv(FR.FDCslope.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.FDCslope.statsum.csv", row.names=FALSE)

pdf("FR.peakflow.statsum.pdf", width=10)       # Export PDF
grid.table(FR.PeakFlow.statistical.summary)

write.csv(FR.PeakFlow.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.peakflow.statsum.csv", row.names=FALSE)

pdf("FR.longestnf.statsum.pdf", width=10)       # Export PDF
grid.table(FR.longest.nf.statistical.summary)

write.csv(FR.longest.nf.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.longestnf.statsum.csv", row.names=FALSE)

pdf("FR.firstnf.statsum.pdf", width=10)       # Export PDF
grid.table(FR.first.nfdate.statistical.summary)

write.csv(FR.first.nfdate.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.firstnf.statsum.csv", row.names=FALSE)

pdf("FR.one.statsum.pdf", width=10)       # Export PDF
grid.table(FR.one.statistical.summary)

write.csv(FR.one.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.one.statsum.csv", row.names=FALSE)

pdf("FRfive.statsum.pdf", width=10)       # Export PDF
grid.table(FR.five.statistical.summary)

write.csv(FR.five.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.five.statsum.csv", row.names=FALSE)

pdf("FR.twentyfive.statsum.pdf", width=10)       # Export PDF
grid.table(FR.twentyfive.statistical.summary)

write.csv(FR.twentyfive.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.twentyfive.statsum.csv", row.names=FALSE)

pdf("FR.fifty.statsum.pdf", width=10)       # Export PDF
grid.table(FR.fifty.statistical.summary)

write.csv(FR.fifty.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.fifty.statsum.csv", row.names=FALSE)

pdf("FR.seventyfive.statsum.pdf", width=10)       # Export PDF
grid.table(FR.seventyfive.statistical.summary)

write.csv(FR.seventyfive.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.seventyfive.statsum.csv", row.names=FALSE)

pdf("FR.ninety.statsum.pdf", width=10)       # Export PDF
grid.table(FR.ninety.statistical.summary)

write.csv(FR.ninety.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.ninety.statsum.csv", row.names=FALSE)

pdf("FR.minwatertemp.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Min.watertemp.statistical.summary)

write.csv(FR.Min.watertemp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.minwatertemp.statsum.csv", row.names=FALSE)

pdf("FR.meanwatertemp.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Mean.watertemp.statistical.summary)

write.csv(FR.Mean.watertemp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.meanwatertemp.statsum.csv", row.names=FALSE)

pdf("FR.maxwatertemp.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Max.watertemp.statistical.summary)

write.csv(FR.Max.watertemp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.maxwatertemp.statsum.csv", row.names=FALSE)

pdf("FR.maxflownozero.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Max.Flow.Nozero.statistical.summary)

write.csv(FR.Max.Flow.Nozero.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.maxflownozero.statsum.csv", row.names=FALSE)

pdf("FR.max.flow.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Max.Flow.statistical.summary)

write.csv(FR.Max.Flow.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.max.flow.statsum.csv", row.names=FALSE)

pdf("FR.meanflownozero.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Mean.Flow.Nozero.statistical.summary)

write.csv(FR.Mean.Flow.Nozero.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.meanflownozero.statsum.csv", row.names=FALSE)

pdf("FR.meanflow.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Mean.Flow.statistical.summary)

write.csv(FR.Mean.Flow.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.meanflow.statsum.csv", row.names=FALSE)

pdf("FR.minflownozero.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Min.Flow.Nozero.statistical.summary)

write.csv(FR.Min.Flow.Nozero.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.minflownozero.statsum.csv", row.names=FALSE)

pdf("FR.minflow.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Min.Flow.statistical.summary)

write.csv(FR.Min.Flow.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.maxflow.statsum.csv", row.names=FALSE)

pdf("FR.maxair.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Max.Air.Temp.statistical.summary)

write.csv(FR.Max.Air.Temp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.maxair.statsum.csv", row.names=FALSE)

pdf("FR.meanair.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Mean.Air.Temp.statistical.summary)

write.csv(FR.Mean.Air.Temp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.meanair.statsum.csv", row.names=FALSE)

pdf("FR.minair.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Min.Air.Temp.statistical.summary)

write.csv(FR.Min.Air.Temp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.minair.statsum.csv", row.names=FALSE)

pdf("FR.Precip.statsum.pdf", width=10)       # Export PDF
grid.table(FR.Precip.statistical.summary)

write.csv(FR.Precip.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.Precip.statsum.csv", row.names=FALSE)

pdf("FR.noflow.statsum.pdf", width=10)
grid.table(FR.NFD.statistical.summary)

write.csv(FR.NFD.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/FR_Statistical_Summaries/FR.noflow.statsum.csv", row.names=FALSE)
```


