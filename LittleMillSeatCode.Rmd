---
title: "LittleMillseatCode"
output: html_notebook
---

# Section 1: Pre-processing

The process began by downloading all data sets from  as a .csv file to a designated desktop folder. For this code, the Falling Rock flow data, air temperature data, and precipitation data were all downloaded. After opening Rstudio, the read.csv function was then used to import all of the data. 

```{r}
LittleMillseat<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/LM_Data/Table_5_LM.csv") #reading in the Little Millseat flow data
LM.precip.data<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/LM_Data/Table_5_LM_B_Precip.csv")
#reading in the Little Millseat precipitation data
Camp.precip.data <- read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/Table_2_CAMP_precip.csv")
Camp.precip.data.new <- read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/CWS_precip_tyler.csv")
LM.15 <- read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/LM_Data/LM_Qobs1971_1999.csv")
```

After the raw data sets were imported, the different libraries necessary for data analysis were installed and loaded into Rstudio. For this project, the ggplot2 package, hydroTSM package, trend package, lubridate package, and dplyr package were all necessary. 
```{r}
library(ggplot2) #loading in ggplot2 package
library(hydroTSM) #loading in hydroTSM package
library(trend) #loading in trend package
library(lubridate)#loading in lubridate package
library(plyr)
library(dplyr) #loading in dplyr package
library(scales) #loading in scales package
library(TTR) #loading in TTR package
library(tidyquant) #loading in tidyquant
library(tidyr) #loading in tidyr
library(ggridges) #loading in ggridges
library(robslopes) #loading in robslopes
library(Kendall) #loading in Kendall package
library(zyp) #loading in zyp
library(gridExtra)
```

Every Function in use
```{r}
sens.output <- function(time.step,data,conf.level=0.95) {
  thiel.sen.output <- TheilSen(time.step,data)
  slope <- thiel.sen.output$slope
  intercept <- thiel.sen.output$intercept
  p.value <- sens.slope(data,conf.level)$p.value
  p.2 <- zyp.zhang(y=data,x=time.step)[6]

 
  output.sens <- data.frame('slope'=slope,'intercept'=intercept,'p.value'=p.value,'p.zyp'=p.2)
  return(output.sens)
}
```


```{r}
LittleMillseat$Date.1 <- mdy(LittleMillseat$Date) #transforming the date class into mdy from string
LittleMillseat$month <- substr(x=LittleMillseat$Date.1,6,7)
#creates a column for the month
substrRight <- function(x, n){
  substr(x, nchar(x)-n+1, nchar(x))
}
LM.precip.data$Year <- substrRight(x=LM.precip.data$Date,n=4) #creates a new column for LM.precip.data
LM.precip.data$Date.1 <- mdy(LM.precip.data$Date)
#creates a new date column in the mdy from string
LM.precip.data$month <- substr(x=LM.precip.data$Date.1,6,7)
#creates a new column designating which month the point falls in
Camp.precip.data$Year <- substrRight(x=Camp.precip.data$Date,n=4)
#creates a new column for the Year
Camp.precip.data$Date.1 <- mdy(Camp.precip.data$Date)
#creates a new date column in mdy from strings
Camp.precip.data$month <- substr(x=Camp.precip.data$Date.1,6,7)
#creates a new column designating which month the point falls in
Camp.precip.data.new$Year <- substrRight(x=Camp.precip.data.new$date,n=4)
#creates a new column for the Year
Camp.precip.data.new$Date.1 <- mdy(Camp.precip.data.new$date)
#creates a new date column in mdy from strings
Camp.precip.data.new$month <- substr(x=Camp.precip.data.new$Date.1,6,7)
#creates a new column designating which month the point falls in
Camp.precip.data.new$precip_mm <- Camp.precip.data.new$precip_in*25.4
LittleMillseat$half.decade <- NA
LittleMillseat$half.decade <- ifelse(LittleMillseat$Year>=1971 & LittleMillseat$Year<=1975,1,
                                   ifelse(LittleMillseat$Year>=1976 & LittleMillseat$Year<=1980,2,
                                          ifelse(LittleMillseat$Year>=1981 & LittleMillseat$Year<=1985,3,
                                                 ifelse(LittleMillseat$Year>=1986 & LittleMillseat$Year<=1990,4,
                                                        ifelse(LittleMillseat$Year>=1991 & LittleMillseat$Year<=1995,5,
                                                               ifelse(LittleMillseat$Year>=1996 & LittleMillseat$Year<=2000,6,
                                                                      ifelse(LittleMillseat$Year>=2001 & LittleMillseat$Year<=2005,7,
                                                                             ifelse(LittleMillseat$Year>=2006 & LittleMillseat$Year<=2010,8,
                                                                                    ifelse(LittleMillseat$Year>=2011 & LittleMillseat$Year<=2015,9,
                                                                                    ifelse(LittleMillseat$Year>=2016 & LittleMillseat$Year<=2020,10,NA
                                          ))))))))))
#creating a list of 1/2 decades to split the data into
LM.half.decades <- unique(LittleMillseat$half.decade)
LittleMillseat$Flow.state.ID <- ifelse(LittleMillseat$mindaily_CFS>0,1,0)
```

The final part of pre-processing is ensuring each Year has a complete or nearly complete data set. Any Year that has less than 90% of data must be discarded. 
```{r}
Q.Threshold.LM <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=4) #creating a matrix to determine if 90% of data is available for each unique Year
Q.Threshold.LM <- data.frame(Q.Threshold.LM) #turning the matrix into a data frame
colnames(Q.Threshold.LM) <- c("Year","number_days_with_data","Total_number_of_days","ratio")#assigning column names
Years <- unique(LittleMillseat$Year) #assigning Years to each unique LM Year
for(i in 1:length(unique(LittleMillseat$Year))){ #running a for loop through the length of LM Years
  x <- length(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==Years[i])]) #counting the total number of days (NA included) in LM
  y <- length(na.omit(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==Years[i])])) #counting the number of days with data in LM
  ratio <- y/x #getting the ratio of days w data to total days
  Q.Threshold.LM$Year[i] <- Years[i] #assigning the Years to a column
  Q.Threshold.LM$number_days_with_data[i] <- y #assigning the days with data to a column
  Q.Threshold.LM$Total_number_of_days[i] <- x #assigning the total number of days to a column
  Q.Threshold.LM$ratio[i] <- ratio #assigning the ratio to a column
}
LM.years <- unique(LittleMillseat$Year)
#missing data from 1994-1999, 2010, 2014

Precip.Threshold.LM <- matrix(nrow=length(unique(LM.precip.data$Year)),ncol=4) #creating a matrix to determine if 90% of data is available for each unique Year
Precip.Threshold.LM <- data.frame(Precip.Threshold.LM)#turning the matrix into a data frame
colnames(Precip.Threshold.LM) <- c("Year","number_days_with_data","Total_number_of_days","ratio")#assigning column names
Years <- unique(LM.precip.data$Year)#assigning Years to each unique LM precip data Year
for(i in 1:length(unique(LM.precip.data$Year))){#running a for loop through the length of LM Years
  x <- length(LM.precip.data$Precip_mm[which(LM.precip.data$Year==Years[i])])#counting the total number of days (NA included) in LM
  y <- length(na.omit(LM.precip.data$Precip_mm[which(LM.precip.data$Year==Years[i])]))#counting the number of days with data in LM
  ratio <- y/x #getting the ratio of days w data to total days
  Precip.Threshold.LM$Year[i] <- Years[i] #assigning the Years to a column
  Precip.Threshold.LM$number_days_with_data[i] <- y#assigning the days with data to a column
  Precip.Threshold.LM$Total_number_of_days[i] <- x #assigning the total number of days to a column
  Precip.Threshold.LM$ratio[i] <- ratio #assigning the ratio to a column
}

#Missing data from 2001, 2004, 2005, 2006, 2008, 2009, 2015

Air.Threshold.LM <- data.frame(matrix(nrow=length(unique(LittleMillseat$Year)),ncol=4)) #creating a matrix to determine if 90% of data is available for each unique Year
colnames(Air.Threshold.LM) <- c("Year","number_days_with_data","Total_number_of_days","ratio")#assigning column names
Years <- unique(LittleMillseat$Year) #assigning Years to each unique LM Year
for(i in 1:length(unique(LittleMillseat$Year))){ #running a for loop through the length of LM Years
  x <- length(LittleMillseat$tempmin[which(LittleMillseat$Year==Years[i])]) #counting the total number of days (NA included) in LM
  y <- length(na.omit(LittleMillseat$tempmin[which(LittleMillseat$Year==Years[i])])) #counting the number of days with data in LM
  air.ratio <- y/x #getting the ratio of days w data to total days
  Air.Threshold.LM$Year[i] <- Years[i] #assigning the Years to a column
  Air.Threshold.LM$number_days_with_data[i] <- y #assigning the days with data to a column
  Air.Threshold.LM$Total_number_of_days[i] <- x #assigning the total number of days to a column
  Air.Threshold.LM$ratio[i] <- air.ratio #assigning the ratio to a column
}


#years with data- 2011-2018

```

# Section 2: Climate Variable Plots
```{r}
LM.Precip <- data.frame(LM.precip.data$Date.1,LM.precip.data$Year,LM.precip.data$Precip_mm) #creating a data frame for precipitation data

CWS.Precip.data <- data.frame(Camp.precip.data$Date.1,Camp.precip.data$Year,Camp.precip.data$Precip_mm,Camp.precip.data$Precip_mm) #creating a data frame for CWS precip data

LM.watertemp.data <- data.frame(LittleMillseat$Date.1,LittleMillseat$Year,LittleMillseat$half.decade,LittleMillseat$tempmean,LittleMillseat$tempmin,LittleMillseat$tempmax) #creating a data frame for water temperature data

LM.discharge.data <- data.frame(LittleMillseat$Date.1,LittleMillseat$Year,LittleMillseat$meandaily_CFS,LittleMillseat$mindaily_CFS,LittleMillseat$maxdaily_CFS) #creating a data frame for discharge data
```

# Section 2.1: Precipitation 
```{r}
LM.M.precip.data<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/LM_Data/Table_6_LM_M_precip.csv")
LM.M.precip.data.new <- data.frame((LM.M.precip.data$Date))
LM.M.precip.data.new$Mid <- LM.M.precip.data$Precip_mm
colnames(LM.M.precip.data.new) <- c("Date","Mid")
precip.data.camp<-read.csv("C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/Table_2_CAMP_precip.csv")
precip.data.camp.new <- data.frame(precip.data.camp$Date)
precip.data.camp.new$Camp <- precip.data.camp$Precip_mm
colnames(precip.data.camp.new) <- c("Date","Camp")
LM.precip.clean <- data.frame(matrix(nrow=length(LM.precip.data$Precip_mm),ncol=2))
colnames(LM.precip.clean) <- c('Date','Base')
LM.precip.clean$Date <- LM.precip.data$Date
LM.precip.clean$Base <- LM.precip.data$Precip_mm
LM.precip <- LM.precip.clean %>% left_join(LM.M.precip.data.new,by= 'Date')
LM.precip <- LM.precip %>% left_join(precip.data.camp.new,by= 'Date')
LM.precip$clean <- ifelse(!is.na(LM.precip$Base),LM.precip$Base,ifelse(!is.na(LM.precip$Mid),LM.precip$Mid,ifelse(!is.na(LM.precip$Camp),LM.precip$Camp,NA)))


LM.precip$year <- substrRight(x=LM.precip$Date, n=4) #creates a new column for LittleMillseat.precip
LM.precip$year <- as.numeric(LM.precip$year)
LM.clean.Threshold <- matrix(nrow=length(unique(LM.precip$year)),ncol=4) #creating a matrix to determine if 90% of data is available for each unique year
LM.clean.Threshold <- data.frame(LM.clean.Threshold)#turning the matrix into a data frame
colnames(LM.clean.Threshold) <- c("Year","number_days_with_data","Total_number_of_days","ratio")#assigning column names
for(i in 1:length(unique(LM.precip$year))){#running a for loop through the length of LM years
  x <- length(LM.precip$clean[which(LM.precip$year==LM.years[i])])#counting the total number of days (NA included) in LM
  y <- length(na.omit(LM.precip$clean[which(LM.precip$year==LM.years[i])]))#counting the number of days with data in LM
  ratio <- y/x #getting the ratio of days w data to total days
  LM.clean.Threshold$year[i] <- LM.years[i] #assigning the years to a column
  LM.clean.Threshold$number_days_with_data[i] <- y#assigning the days with data to a column
  LM.clean.Threshold$Total_number_of_days[i] <- x #assigning the total number of days to a column
  LM.clean.Threshold$ratio[i] <- ratio #assigning the ratio to a column
}

```

Cutting the data to include 1980-2018
```{r}
LittleMillseat <- LittleMillseat[(3107:17352),]
LittleMillseat <- LittleMillseat[-(5115:7306),]
LM.precip <- LM.precip[2954:17198,]
LM.watertemp.data <- LM.watertemp.data[(14431:17352),]
```

## Section 2.1.1: Precipitation Plots
```{r}
LittleMillseat.precip <- data.frame(matrix(ncol=6, nrow=length(LM.precip$Date)))
colnames(LittleMillseat.precip) <- c("Date","Precip_mm","half.decade","year","season","month")
LittleMillseat.precip$Date <- mdy(LM.precip$Date)
LittleMillseat.precip$Precip_mm <- LM.precip$clean
LittleMillseat.precip$year <- LittleMillseat$Year[1:14245]
LittleMillseat.precip$month <- as.numeric(substr(x=LittleMillseat.precip$Date,6,7))
LittleMillseat.precip$Water_Year <- LittleMillseat$Water_Year[1:14245]
LittleMillseat.precip$Climate_Year <- LittleMillseat$Climate_Year[1:14245]

#Entire Time Series Daily
ggplot(data=LittleMillseat.precip, aes(x=Date, y=Precip_mm))+
  geom_line()+
  ggtitle("Little Millseat Daily Precipitation Data")+
  xlab("Year")+
  ylab("Precipitation (mm)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

# 1/2 Decade
LittleMillseat.precip$half.decade <- ifelse(LittleMillseat.precip$year>=1971 & LittleMillseat.precip$year<=1975,1,
                                   ifelse(LittleMillseat.precip$year>=1976 & LittleMillseat.precip$year<=1980,2,
                                          ifelse(LittleMillseat.precip$year>=1981 & LittleMillseat.precip$year<=1985,3,
                                                 ifelse(LittleMillseat.precip$year>=1986 & LittleMillseat.precip$year<=1990,4,
                                                        ifelse(LittleMillseat.precip$year>=1991 & LittleMillseat.precip$year<=1995,5,
                                                               ifelse(LittleMillseat.precip$year>=1996 & LittleMillseat.precip$year<=2000,6,
                                                                      ifelse(LittleMillseat.precip$year>=2001 & LittleMillseat.precip$year<=2005,7,
                                                                             ifelse(LittleMillseat.precip$year>=2006 & LittleMillseat.precip$year<=2010,8,
                                                                                    ifelse(LittleMillseat.precip$year>=2011 & LittleMillseat.precip$year<=2015,9,
                                                                                    ifelse(LittleMillseat.precip$year>=2016 & LittleMillseat.precip$year<=2020,10,NA
                                          ))))))))))

LM.precip.half.dec <- 3:10
LM.sum.precip.half.dec <- data.frame(matrix(nrow=8)) #creating a matrix to sum the precipitation in each year
for(i in 1:length(LM.precip.half.dec)){ #running a for loop through each year in precip data
  LM.sum.precip.half.dec[i,1] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$half.decade==LM.precip.half.dec[i])],na.rm=TRUE) #assigning a new variable for the sum of each years precip data
  colnames(LM.sum.precip.half.dec)[1]="Precip.sum.mm"
  LM.sum.precip.half.dec$half.decade <- LM.precip.half.dec
}

LM.sum.precip.half.dec <- na.omit(LM.sum.precip.half.dec)
LM.half.decades <- unique(LittleMillseat$half.decade)
LM.sum.precip.half.dec$halfdec <- LM.precip.half.dec
LM.sum.precip.half.dec <- na.omit(LM.sum.precip.half.dec)
LM.sum.precip.halfdec.senslope <-sens.output(time.step=LM.sum.precip.half.dec$halfdec,data=LM.sum.precip.half.dec$Precip.sum.mm)
LM.sum.precip.halfdec.senslope <- data.frame(LM.sum.precip.halfdec.senslope)
LM.sum.precip.halfdec.senslope$half.decade <- "Half.Decade"

ggplot(data=LM.sum.precip.half.dec, aes(half.decade, Precip.sum.mm))+
  geom_col()+
  geom_abline(data=LM.sum.precip.halfdec.senslope,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Half-Decadal Precipitation Data")+
  xlab("Half-Decade")+
  ylab("Precipitation (mm)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
  
#yearly
#calendar year
LM.precip.year <- unique(LittleMillseat.precip$year)
sum.LM.precip.year <- data.frame(matrix(nrow=length(LM.precip.year))) #creating a matrix to sum the precipitation in each year
for(i in 1:length(LM.precip.year)){ #running a for loop through each year in precip data
  sum.LM.precip.year[i,1] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$year==LM.precip.year[i])],na.rm=TRUE) #assigning a new variable for the sum of each years precip data
  colnames(sum.LM.precip.year)[1] <- "Precip.sum.mm"
  sum.LM.precip.year$year <- LM.precip.year
}
sum.LM.precip.year$year <- sum.LM.precip.year$year
sum.LM.precip.year <- na.omit(sum.LM.precip.year)
sum.LM.precip.year.senslope <- sens.output(time.step=sum.LM.precip.year$year,data=sum.LM.precip.year$Precip.sum.mm)
sum.LM.precip.year.senslope$year <- "Calendar.Year"

#Water Year
LM.precip.wateryear <- unique(LittleMillseat.precip$Water_Year)
sum.LM.precip.wateryear <- data.frame(matrix(nrow=length(LM.precip.wateryear))) #creating a matrix to sum the precipitation in each year
for(i in 1:length(LM.precip.wateryear)){ #running a for loop through each year in precip data
  sum.LM.precip.wateryear[i,1] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$Water_Year==LM.precip.wateryear[i])],na.rm=TRUE) #assigning a new variable for the sum of each years precip data
  colnames(sum.LM.precip.wateryear)[1] <- "Precip.sum.mm"
  sum.LM.precip.wateryear$Water_Year <- LM.precip.wateryear
}
sum.LM.precip.wateryear <- na.omit(sum.LM.precip.wateryear)
sum.LM.precip.wateryear.senslope <- sens.output(time.step=sum.LM.precip.wateryear$Water_Year,data=sum.LM.precip.wateryear$Precip.sum.mm)
sum.LM.precip.wateryear.senslope$year <- "Water.Year"

#Climate Year
LM.precip.climateyear <- unique(LittleMillseat.precip$Climate_Year)
sum.LM.precip.climateyear <- data.frame(matrix(nrow=length(LM.precip.climateyear))) #creating a matrix to sum the precipitation in each year
for(i in 1:length(LM.precip.climateyear)){ #running a for loop through each year in precip data
  sum.LM.precip.climateyear[i,1] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$Climate_Year==LM.precip.climateyear[i])],na.rm=TRUE) #assigning a new variable for the sum of each years precip data
  colnames(sum.LM.precip.climateyear)[1] <- "Precip.sum.mm"
  sum.LM.precip.climateyear$Climate_Year <- LM.precip.climateyear
}
sum.LM.precip.climateyear <- na.omit(sum.LM.precip.climateyear)
sum.LM.precip.climateyear.senslope <- sens.output(time.step=sum.LM.precip.climateyear$Climate_Year,data=sum.LM.precip.climateyear$Precip.sum.mm)
sum.LM.precip.climateyear.senslope$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LMprecip.cal.jpeg", width=850)
ggplot(data=sum.LM.precip.year, aes(x=year, y=Precip.sum.mm))+
  geom_col()+
  geom_abline(data=sum.LM.precip.year.senslope,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Yearly Precipitation Data")+
  xlab("Year")+
  ylab("Precipitation (mm)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LMprecip.water.jpeg", width=850)
ggplot(data=sum.LM.precip.wateryear, aes(Water_Year, Precip.sum.mm))+
  geom_col()+
  geom_abline(data=sum.LM.precip.climateyear.senslope,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Yearly Precipitation Data Using Water Year")+
  xlab("Water Year")+
  ylab("Precipitation (mm)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LMprecip.clim.jpeg", width=850)
ggplot(data=sum.LM.precip.climateyear, aes(Climate_Year, Precip.sum.mm))+
  geom_col()+
  geom_abline(data=sum.LM.precip.climateyear.senslope,aes(slope=slope,intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Yearly Precipitation Data Using Climate Year")+
  xlab("Climate Year")+
  ylab("Precipitation (mm)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()
  

#seasonal
LittleMillseat.precip$season <- time2season(LittleMillseat.precip$Date,out.fmt="seasons")
LM.precip.season <- unique(LittleMillseat.precip$season)
sum.LM.precip.season <- data.frame(matrix(nrow=length(LM.precip.year),ncol=length(LM.precip.season)))
for(i in 1:length(LM.precip.year)){
  for(j in 1:length(LM.precip.season)){
    sum.LM.precip.season[i,j] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$year==LM.precip.year[i]&LittleMillseat.precip$season==LM.precip.season[j])],na.rm=TRUE)
  }
  colnames(sum.LM.precip.season) <- c("Winter","Spring","Summer","Autumn")

}
seasons <- c("Winter","Spring","Summer","Autumn")
sum.LM.precip.season$year <- LM.precip.year
sum.LM.precip.season$year <- as.numeric(sum.LM.precip.season$year)
LM.sum.precip.senslope.winter <- sens.output(time.step=sum.LM.precip.season$year,data=sum.LM.precip.season$Winter)
LM.sum.precip.senslope.spring <- sens.output(time.step=sum.LM.precip.season$year,data=sum.LM.precip.season$Spring)
LM.sum.precip.senslope.summer <- sens.output(time.step=sum.LM.precip.season$year,data=sum.LM.precip.season$Summer)
LM.sum.precip.senslope.autumn <- sens.output(time.step=sum.LM.precip.season$year,data=sum.LM.precip.season$Autumn)
LM.sum.precip.senslope.season <- rbind(LM.sum.precip.senslope.winter,LM.sum.precip.senslope.spring,LM.sum.precip.senslope.summer,LM.sum.precip.senslope.autumn)
LM.sum.precip.senslope.season$season <- seasons


LM.precipdata.season.long <- gather(sum.LM.precip.season, key="season", value="value", c("Winter","Spring","Summer", "Autumn"))
LM.precipdata.season.long <- na.omit(LM.precipdata.season.long)

ggplot(LM.precipdata.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=LM.sum.precip.senslope.season, aes(slope=slope,intercept=intercept))+
  facet_wrap(~season)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Seasonal Precipiation Data")+
  xlab("Year")+
  ylab("Total Seasonal Precipitation (mm)")


#monthly
LM.precip.month <- unique(LittleMillseat.precip$month) #assigning a variable to the unique months in precip data
sum.LM.precip.month <- data.frame(matrix(nrow=length(LM.precip.year),ncol=length(LM.precip.month))) #creating a matrix for the sum of precip each month
for(i in 1:length(LM.precip.year)){ #running a for loop to go through each year
  for(j in 1:length(LM.precip.month)){ #running a nested for loop to go through the unique months in each year
    sum.LM.precip.month[i,j] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$year==LM.precip.year[i]&LittleMillseat.precip$month==LM.precip.month[j])],na.rm=TRUE) #assigning a new variable for the sum of each months precip data
  }
  colnames(sum.LM.precip.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
}
sum.LM.precip.month$year <- LM.precip.year
sum.LM.precip.month$year <- as.numeric(sum.LM.precip.month$year)

LM.sum.precip.senslope.jan <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$January)
LM.sum.precip.senslope.feb <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$February)
LM.sum.precip.senslope.mar <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$March)
LM.sum.precip.senslope.apr <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$April)
LM.sum.precip.senslope.may <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$May)
LM.sum.precip.senslope.jun <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$June)
LM.sum.precip.senslope.jul <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$July)
LM.sum.precip.senslope.aug <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$August)
LM.sum.precip.senslope.sep <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$September)
LM.sum.precip.senslope.oct <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$October)
LM.sum.precip.senslope.nov <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$November)
LM.sum.precip.senslope.dec <- sens.output(time.step=sum.LM.precip.month$year,data=sum.LM.precip.month$December)
LM.sum.precip.senslope.monthly <- rbind(LM.sum.precip.senslope.jan,LM.sum.precip.senslope.feb,LM.sum.precip.senslope.mar,LM.sum.precip.senslope.apr,LM.sum.precip.senslope.may,LM.sum.precip.senslope.jun,LM.sum.precip.senslope.jul,LM.sum.precip.senslope.aug,LM.sum.precip.senslope.sep,LM.sum.precip.senslope.oct,LM.sum.precip.senslope.nov,LM.sum.precip.senslope.dec)
LittleMillseat$month <- as.numeric(LittleMillseat$month)
months.name <- c("January", "February", "March", "April", "May", "June","July", "August", "September", "October", "November", "December")
LittleMillseat$Month <- months.name[LittleMillseat$month]
LM.sum.precip.senslope.monthly$Month <- unique(LittleMillseat$Month)

LM.precipdata.month.long <- gather(sum.LM.precip.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
LM.precipdata.month.long <- na.omit(LM.precipdata.month.long)

ggplot(LM.precipdata.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=LM.sum.precip.senslope.monthly, aes(slope=slope,intercept=intercept))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Monthly Precipiation Data")+
  xlab("Year")+
  ylab("Total Monthly Precipitation (mm)")
```
## Section 2.1.2: Precipitation Statistical Summary
```{r}
LM.Precip.statistical.summary <- rbind.fill(LM.sum.precip.halfdec.senslope,sum.LM.precip.year.senslope,sum.LM.precip.wateryear.senslope,sum.LM.precip.climateyear.senslope,LM.sum.precip.senslope.season,LM.sum.precip.senslope.monthly)
```


#Section 2.2: Air Temp

Same as Falling Rock

#Section 3: Stream Variables

## Section 3.1: Minimum Flow
```{r}
#Entire Time Series (Daily)
LittleMillseat$min.discharge.nozero <- LittleMillseat$mindaily_CFS+0.0001

ggplot(data=LittleMillseat, aes(x=Date, y=min.discharge.nozero))+
  geom_line()+
  scale_y_log10()+
  ggtitle("Little Millseat Minimum Daily Discharge at Little Millseat (Log Scale)")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(data=LittleMillseat, aes(x=Date, y=mindaily_CFS))+
  geom_line()+
  ggtitle("Little Millseat Minimum Daily Discharge at Little Millseat")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#1/2 Decade
LM.discharge.half.dec <- unique(LittleMillseat$half.decade)
LM.min.discharge.half.dec <- data.frame(matrix(nrow=length(LM.discharge.half.dec),ncol=3))
for(i in 1:length(LM.discharge.half.dec)){
  LM.min.discharge.half.dec[i,1] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$half.decade==LM.discharge.half.dec[i])],na.rm=TRUE)
}

colnames(LM.min.discharge.half.dec) <- c("mindaily_CFS","halfdec","no.zero")
LM.min.discharge.half.dec$halfdec <- unique(LittleMillseat$half.decade)
LM.min.discharge.half.dec$no.zero <- LM.min.discharge.half.dec$mindaily_CFS+0.0001

LM.min.discharge.min.halfdec <- data.frame(matrix(nrow=length(unique(LittleMillseat$half.decade)),ncol=1))
for(i in 1:length(unique(LittleMillseat$half.decade))){
    LM.min.discharge.min.halfdec[i,1] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$half.decade==LM.discharge.half.dec[i])],na.rm=TRUE)
}

colnames(LM.min.discharge.min.halfdec) <- c('min.discharge.min')
LM.min.discharge.min.halfdec$halfdec <- LM.discharge.half.dec
LM.min.discharge.min.halfdec <- na.omit(LM.min.discharge.min.halfdec)
LM.min.discharge.senslope.halfdec <- sens.output(time.step=LM.min.discharge.min.halfdec$halfdec,data=LM.min.discharge.min.halfdec$min.discharge.min)
LM.min.discharge.senslope.halfdec$half.decade <- "Half.Decade"

LM.min.discharge.min.halfdec.nozero <- data.frame(matrix(nrow=length(unique(LittleMillseat$half.decade)),ncol=1))
for(i in 1:length(unique(LittleMillseat$half.decade))){
    LM.min.discharge.min.halfdec.nozero[i,1] <- min(LittleMillseat$min.discharge.nozero[which(LittleMillseat$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(LM.min.discharge.min.halfdec.nozero) <- c('min.discharge.min')
LM.min.discharge.min.halfdec.nozero$halfdec <- LM.discharge.half.dec
LM.min.discharge.nozero.senslope.halfdec <- sens.output(time.step=LM.min.discharge.min.halfdec.nozero$halfdec,data=log(LM.min.discharge.min.halfdec.nozero$min.discharge.min))
LM.min.discharge.nozero.senslope.halfdec$half.decade <- "Half.Decade"


ggplot(LittleMillseat, aes(factor(half.decade), min.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.nozero.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_y_log10()+
  ggtitle("Little Millseat Minimum Half-Decadal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))


ggplot(LittleMillseat, aes(factor(half.decade), mindaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Minimum Half-Decadal Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Yearly
#Calendar Year
LM.discharge.year <- unique(LittleMillseat$Year)
LM.min.discharge.year <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=1))
for(i in 1:length(LM.discharge.year)){
  LM.min.discharge.year[i,1] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}

LM.min.discharge.year$year <- unique(LittleMillseat$Year)
LM.min.discharge.min.year <- data.frame(matrix((nrow=length(LM.discharge.year)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Year))){
    LM.min.discharge.min.year[i,1] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}
colnames(LM.min.discharge.min.year) <- c('min.discharge.min')
LM.min.discharge.min.year$year <- LM.discharge.year
LM.min.discharge.min.year <- na.omit(LM.min.discharge.min.year)
LM.min.discharge.senslope.year <- sens.output(time.step=LM.min.discharge.min.year$year,data=LM.min.discharge.min.year$min.discharge.min)
LM.min.discharge.senslope.year$year <- "Calendar.Year"

LM.min.discharge.min.year.nozero <- data.frame(matrix((nrow=length(LM.discharge.year)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Year))){
    LM.min.discharge.min.year.nozero[i,1] <- min(LittleMillseat$min.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}

colnames(LM.min.discharge.min.year.nozero) <- c('min.discharge.min')
LM.min.discharge.min.year.nozero$year <- LM.discharge.year
LM.min.discharge.min.year.nozero <- na.omit(LM.min.discharge.min.year.nozero)
LM.min.discharge.senslope.year.nozero <- sens.output(time.step=LM.min.discharge.min.year.nozero$year,data=log(LM.min.discharge.min.year.nozero$min.discharge.min))
LM.min.discharge.senslope.year.nozero$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_minflow.cal.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Year), min.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.year.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Minimum Annual Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Year), mindaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.year,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Minimum Annual Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Water Year
LM.discharge.wateryear <- unique(LittleMillseat$Water_Year)
LM.min.discharge.wateryear <- data.frame(matrix(nrow=length(LM.discharge.wateryear),ncol=1))
for(i in 1:length(LM.discharge.wateryear)){
  LM.min.discharge.wateryear[i,1] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

LM.min.discharge.wateryear$Water_Year <- unique(LittleMillseat$Water_Year)
LM.min.discharge.min.wateryear <- data.frame(matrix((nrow=length(LM.min.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Water_Year))){
    LM.min.discharge.min.wateryear[i,1] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

colnames(LM.min.discharge.min.wateryear) <- c('min.discharge.min')
LM.min.discharge.min.wateryear$Water_Year <- LM.discharge.wateryear
LM.min.discharge.min.wateryear <- na.omit(LM.min.discharge.min.wateryear)
LM.min.discharge.senslope.wateryear <- sens.output(time.step=LM.min.discharge.min.wateryear$Water_Year,data=LM.min.discharge.min.wateryear$min.discharge.min)
LM.min.discharge.senslope.wateryear$year <- "Water.Year"

LM.min.discharge.min.wateryear.nozero <- data.frame(matrix((nrow=length(LM.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Water_Year))){
    LM.min.discharge.min.wateryear.nozero[i,1] <- min(LittleMillseat$min.discharge.nozero[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

colnames(LM.min.discharge.min.wateryear.nozero) <- c('min.discharge.min')
LM.min.discharge.senslope.wateryear.nozero$year <- "Water.Year"
LM.min.discharge.min.wateryear.nozero$Water_Year <- LM.discharge.wateryear
LM.min.discharge.min.wateryear.nozero <- na.omit(LM.min.discharge.min.wateryear.nozero)
LM.min.discharge.senslope.wateryear.nozero <- sens.output(time.step=LM.min.discharge.min.wateryear.nozero$Water_Year,data=log(LM.min.discharge.min.wateryear.nozero$min.discharge.min))

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_minflow.water.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Water_Year), min.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Minimum Annual Discharge (Log Scale) Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Water_Year), mindaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.wateryear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Minimum Annual Discharge Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Climate Year

LM.discharge.climateyear <- unique(LittleMillseat$Climate_Year)
LM.min.discharge.climateyear <- data.frame(matrix(nrow=length(LM.discharge.climateyear),ncol=1))
for(i in 1:length(LM.discharge.climateyear)){
  LM.min.discharge.climateyear[i,1] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

LM.min.discharge.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.min.discharge.min.climateyear <- data.frame(matrix((nrow=length(LM.min.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Climate_Year))){
    LM.min.discharge.min.climateyear[i,1] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

colnames(LM.min.discharge.min.climateyear) <- c('min.discharge.min')
LM.min.discharge.min.climateyear$Climate_Year <- LM.discharge.climateyear
LM.min.discharge.min.climateyear <- na.omit(LM.min.discharge.min.climateyear)
LM.min.discharge.senslope.climateyear <- sens.output(time.step=LM.min.discharge.min.climateyear$Climate_Year,data=LM.min.discharge.min.climateyear$min.discharge.min)
LM.min.discharge.senslope.climateyear$year <- "Cliamte.Year"

LM.min.discharge.min.climateyear.nozero <- data.frame(matrix((nrow=length(LM.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Climate_Year))){
    LM.min.discharge.min.climateyear.nozero[i,1] <- min(LittleMillseat$min.discharge.nozero[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

colnames(LM.min.discharge.min.climateyear.nozero) <- c('min.discharge.min')
LM.min.discharge.min.climateyear.nozero$Climate_Year <- LM.discharge.climateyear
LM.min.discharge.min.climateyear.nozero <- na.omit(LM.min.discharge.min.climateyear.nozero)
LM.min.discharge.senslope.climateyear.nozero <- sens.output(time.step=LM.min.discharge.min.climateyear.nozero$Climate_Year,data=log(LM.min.discharge.min.climateyear.nozero$min.discharge.min))
LM.min.discharge.senslope.climateyear.nozero$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_minflow.clim.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Climate_Year), min.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Minimum Annual Discharge (Log Scale) Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Climate_Year), mindaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.climateyear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Minimum Annual Discharge Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
LittleMillseat$season <- time2season(LittleMillseat$Date.1,out.fmt="seasons")
LM.discharge.season <- unique(LittleMillseat$season)
LM.min.discharge.season <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.min.discharge.season[i,j] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
  colnames(LM.min.discharge.season) <- c("Summer","Autumn","Winter","Spring")
}
LM.min.discharge.season$year <- unique(LittleMillseat$Year)
LM.season <- unique(LittleMillseat$season)

LM.min.discharge.min.season <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.min.discharge.min.season[i,j] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
}
LM.season <- c("Winter","Spring","Summer","Autumn")
colnames(LM.min.discharge.min.season) <- LM.season
LM.min.discharge.min.season$year <- LM.discharge.year
LM.min.discharge.min.season <- na.omit(LM.min.discharge.min.season)
LM.min.discharge.senslope.winter <- sens.output(time.step=LM.min.discharge.min.season$year,data=LM.min.discharge.min.season$Winter)
LM.min.discharge.senslope.spring <- sens.output(time.step=LM.min.discharge.min.season$year,data=LM.min.discharge.min.season$Spring)
LM.min.discharge.senslope.summer <- sens.output(time.step=LM.min.discharge.min.season$year,data=LM.min.discharge.min.season$Summer)
LM.min.discharge.senslope.autumn <- sens.output(time.step=LM.min.discharge.min.season$year,data=LM.min.discharge.min.season$Autumn)
LM.min.discharge.senslope.season <- rbind(LM.min.discharge.senslope.winter,LM.min.discharge.senslope.spring,LM.min.discharge.senslope.summer,LM.min.discharge.senslope.autumn)
LM.min.discharge.senslope.season$season <- unique(LittleMillseat$season)

LM.min.discharge.min.season.nozero <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.min.discharge.min.season.nozero[i,j] <- min(LittleMillseat$min.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
}
colnames(LM.min.discharge.min.season.nozero) <- LM.season
LM.min.discharge.min.season.nozero$year <- LM.discharge.year
LM.min.discharge.min.season.nozero <- na.omit(LM.min.discharge.min.season.nozero)
LM.min.discharge.senslope.winter.nozero <- sens.output(time.step=LM.min.discharge.min.season.nozero$year,data=log(LM.min.discharge.min.season.nozero$Winter))
LM.min.discharge.senslope.spring.nozero <- sens.output(time.step=LM.min.discharge.min.season.nozero$year,data=log(LM.min.discharge.min.season.nozero$Spring))
LM.min.discharge.senslope.summer.nozero <- sens.output(time.step=LM.min.discharge.min.season.nozero$year,data=log(LM.min.discharge.min.season.nozero$Summer))
LM.min.discharge.senslope.autumn.nozero <- sens.output(time.step=LM.min.discharge.min.season.nozero$year,data=log(LM.min.discharge.min.season.nozero$Autumn))
LM.min.discharge.senslope.season.nozero <- rbind(LM.min.discharge.senslope.winter.nozero,LM.min.discharge.senslope.spring.nozero,LM.min.discharge.senslope.summer.nozero,LM.min.discharge.senslope.autumn.nozero)
LM.min.discharge.senslope.season.nozero$season <- unique(LittleMillseat$season)


ggplot(LittleMillseat, aes(factor(Year), min.discharge.nozero, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.season.nozero,aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0.0001,100)+
  scale_y_log10()+
  facet_wrap(~season)+
  ggtitle("Little Millseat Minimum Seasonal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(LittleMillseat, aes(factor(Year), mindaily_CFS, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.season,aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,10)+
  facet_wrap(~season)+
  ggtitle("Little Millseat Minimum Seasonal Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Monthly
LM.discharge.month <- unique(LittleMillseat$month)
LM.min.discharge.month <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.min.discharge.month[i,j] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==LM.discharge.month[j])],na.rm=TRUE)
  }
  colnames(LM.min.discharge.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
}

LM.min.discharge.month$year <- unique(LittleMillseat$Year)
LM.min.discharge.month <- na.omit(LM.min.discharge.month)

LM.min.discharge.min.month <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.min.discharge.min.month[i,j] <- min(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==LM.discharge.month[j])],na.rm=TRUE)
  }
}
colnames(LM.min.discharge.min.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
LM.min.discharge.min.month$year <- unique(LittleMillseat$Year)
LM.min.discharge.min.month <- na.omit(LM.min.discharge.min.month)


LM.min.discharge.senslope.jan <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$January)
LM.min.discharge.senslope.feb <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$February)
LM.min.discharge.senslope.mar <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$March)
LM.min.discharge.senslope.apr <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$April)
LM.min.discharge.senslope.may <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$May)
LM.min.discharge.senslope.jun <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$June)
LM.min.discharge.senslope.jul <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$July)
LM.min.discharge.senslope.aug <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$August)
LM.min.discharge.senslope.sep <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$September)
LM.min.discharge.senslope.oct <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$October)
LM.min.discharge.senslope.nov <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$November)
LM.min.discharge.senslope.dec <- sens.output(time.step=LM.min.discharge.min.month$year,data=LM.min.discharge.min.month$December)
LM.min.discharge.senslope.month <- rbind(LM.min.discharge.senslope.jan,LM.min.discharge.senslope.feb,LM.min.discharge.senslope.mar,LM.min.discharge.senslope.apr,LM.min.discharge.senslope.may,LM.min.discharge.senslope.jun,LM.min.discharge.senslope.jul,LM.min.discharge.senslope.aug,LM.min.discharge.senslope.sep,LM.min.discharge.senslope.oct,LM.min.discharge.senslope.nov,LM.min.discharge.senslope.dec)
LM.min.discharge.senslope.month$Month <- unique(LittleMillseat$Month)

LM.min.discharge.min.month.nozero <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.min.discharge.min.month.nozero[i,j] <- min(LittleMillseat$min.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(LM.min.discharge.min.month.nozero) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
LM.min.discharge.min.month.nozero$year <- unique(LittleMillseat$Year)
LM.min.discharge.min.month.nozero <- na.omit(LM.min.discharge.min.month.nozero)


LM.min.discharge.senslope.jan.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$January))
LM.min.discharge.senslope.feb.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$February))
LM.min.discharge.senslope.mar.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$March))
LM.min.discharge.senslope.apr.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$April))
LM.min.discharge.senslope.may.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$May))
LM.min.discharge.senslope.jun.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$June))
LM.min.discharge.senslope.jul.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$July))
LM.min.discharge.senslope.aug.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$August))
LM.min.discharge.senslope.sep.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$September))
LM.min.discharge.senslope.oct.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$October))
LM.min.discharge.senslope.nov.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$November))
LM.min.discharge.senslope.dec.nozero <- sens.output(time.step=LM.min.discharge.min.month.nozero$year,data=log(LM.min.discharge.min.month.nozero$December))
LM.min.discharge.senslope.month.nozero <- rbind(LM.min.discharge.senslope.jan.nozero,LM.min.discharge.senslope.feb.nozero,LM.min.discharge.senslope.mar.nozero,LM.min.discharge.senslope.apr.nozero,LM.min.discharge.senslope.may.nozero,LM.min.discharge.senslope.jun.nozero,LM.min.discharge.senslope.jul.nozero,LM.min.discharge.senslope.aug.nozero,LM.min.discharge.senslope.sep.nozero,LM.min.discharge.senslope.oct.nozero,LM.min.discharge.senslope.nov.nozero,LM.min.discharge.senslope.dec.nozero)
LM.min.discharge.senslope.month.nozero$Month <- unique(LittleMillseat$Month)

ggplot(LittleMillseat, aes(factor(Year), min.discharge.nozero, fill=month)) +
  geom_boxplot() +
  geom_abline(data=LM.min.discharge.senslope.month.nozero,aes(slope=slope,intercept=0.01))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ylim(0,100)+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Little Millseat Minimum Monthly Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(LittleMillseat, aes(factor(Year), mindaily_CFS, fill=month)) +
  geom_boxplot()+
  geom_abline(data=min.discharge.senslope.month,aes(slope=slope, intercept=0.01))+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,15)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Minimum Monthly Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

```

### Section 3.1.1: Minimum Flow Statistical Summaries
```{r}
LM.Min.Flow.statistical.summary <- rbind.fill(LM.min.discharge.senslope.halfdec,LM.min.discharge.senslope.year,LM.min.discharge.senslope.wateryear,LM.min.discharge.senslope.climateyear,LM.min.discharge.senslope.season,LM.min.discharge.senslope.month)

LM.Min.Flow.Nozero.statistical.summary <- rbind.fill(LM.min.discharge.nozero.senslope.halfdec,LM.min.discharge.senslope.year.nozero,LM.min.discharge.senslope.wateryear.nozero,LM.min.discharge.senslope.climateyear.nozero,LM.min.discharge.senslope.season.nozero,LM.min.discharge.senslope.month.nozero)
```

## Section 3.2: Mean Flow
```{r}
LittleMillseat$mean.discharge.nozero <- LittleMillseat$meandaily_CFS+0.0001

ggplot(data=LittleMillseat, aes(x=Date, y=mean.discharge.nozero))+
  geom_line()+
  scale_y_log10()+
  ggtitle("Little Millseat Mean Daily Discharge at Little Millseat (Log Scale)")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(data=LittleMillseat, aes(x=Date, y=meandaily_CFS))+
  geom_line()+
  ggtitle("Little Millseat Mean Daily Discharge at Little Millseat")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#1/2 Decade
LM.mean.discharge.half.dec <- data.frame(matrix(nrow=length(LM.discharge.half.dec),ncol=3))
for(i in 1:length(LM.discharge.half.dec)){
  LM.mean.discharge.half.dec[i,1] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$half.decade==LM.discharge.half.dec[i])],na.rm=TRUE)
}

colnames(LM.mean.discharge.half.dec) <- c("meandaily_CFS","halfdec","no.zero")
LM.mean.discharge.half.dec$halfdec <- unique(LittleMillseat$half.decade)
LM.mean.discharge.half.dec$no.zero <- LM.mean.discharge.half.dec$meandaily_CFS+0.0001

LM.mean.discharge.mean.halfdec <- data.frame(matrix(nrow=length(unique(LittleMillseat$half.decade)),ncol=1))
for(i in 1:length(unique(LittleMillseat$half.decade))){
    LM.mean.discharge.mean.halfdec[i,1] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$half.decade==LM.discharge.half.dec[i])],na.rm=TRUE)
}

colnames(LM.mean.discharge.mean.halfdec) <- c('mean.discharge.mean')
LM.mean.discharge.mean.halfdec$halfdec <- LM.discharge.half.dec
LM.mean.discharge.mean.halfdec <- na.omit(LM.mean.discharge.mean.halfdec)
LM.mean.discharge.senslope.halfdec <- sens.output(time.step=LM.mean.discharge.mean.halfdec$halfdec,data=LM.mean.discharge.mean.halfdec$mean.discharge.mean)
LM.mean.discharge.senslope.halfdec$half.decade <- "Half.Decade"

LM.mean.discharge.mean.halfdec.nozero <- data.frame(matrix(nrow=length(unique(LittleMillseat$half.decade)),ncol=1))
for(i in 1:length(unique(LittleMillseat$half.decade))){
    LM.mean.discharge.mean.halfdec.nozero[i,1] <- mean(LittleMillseat$mean.discharge.nozero[which(LittleMillseat$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(LM.mean.discharge.mean.halfdec.nozero) <- c('mean.discharge.mean')
LM.mean.discharge.mean.halfdec.nozero$halfdec <- LM.discharge.half.dec
LM.mean.discharge.mean.halfdec.nozero <- na.omit(LM.mean.discharge.mean.halfdec.nozero)
LM.mean.discharge.nozero.senslope.halfdec <- sens.output(time.step=LM.mean.discharge.mean.halfdec.nozero$halfdec,data=log(LM.mean.discharge.mean.halfdec.nozero$mean.discharge.mean))
LM.mean.discharge.nozero.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(LittleMillseat, aes(factor(half.decade), mean.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.nozero.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_y_log10()+
  ggtitle("Little Millseat Mean Half-Decadal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))


ggplot(LittleMillseat, aes(factor(half.decade), meandaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Mean Half-Decadal Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Yearly
#Calendar Year
LM.mean.discharge.year <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=1))
for(i in 1:length(LM.discharge.year)){
  LM.mean.discharge.year[i,1] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}

LM.mean.discharge.year$year <- unique(LittleMillseat$Year)
LM.mean.discharge.mean.year <- data.frame(matrix((nrow=length(LM.discharge.year)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Year))){
    LM.mean.discharge.mean.year[i,1] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}
colnames(LM.mean.discharge.mean.year) <- c('mean.discharge.mean')
LM.mean.discharge.mean.year$year <- LM.discharge.year
LM.mean.discharge.mean.year <- na.omit(LM.mean.discharge.mean.year)
LM.mean.discharge.senslope.year <- sens.output(time.step=LM.mean.discharge.mean.year$year,data=LM.mean.discharge.mean.year$mean.discharge.mean)
LM.mean.discharge.senslope.year$year <- "Calendar.Year"

LM.mean.discharge.mean.year.nozero <- data.frame(matrix((nrow=length(LM.discharge.year)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Year))){
    LM.mean.discharge.mean.year.nozero[i,1] <- mean(LittleMillseat$mean.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}

colnames(LM.mean.discharge.mean.year.nozero) <- c('mean.discharge.mean')
LM.mean.discharge.mean.year.nozero$year <- LM.discharge.year
LM.mean.discharge.mean.year.nozero <- na.omit(LM.mean.discharge.mean.year.nozero)
LM.mean.discharge.senslope.year.nozero <- sens.output(time.step=LM.mean.discharge.mean.year.nozero$year,data=log(LM.mean.discharge.mean.year.nozero$mean.discharge.mean))
LM.mean.discharge.senslope.year.nozero$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_meanflow.cal.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Year), mean.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.year.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Mean Annual Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Year), meandaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.year,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Mean Annual Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Water Year
LM.discharge.wateryear <- unique(LittleMillseat$Water_Year)
LM.mean.discharge.wateryear <- data.frame(matrix(nrow=length(LM.discharge.wateryear),ncol=1))
for(i in 1:length(LM.discharge.wateryear)){
  LM.mean.discharge.wateryear[i,1] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

LM.mean.discharge.wateryear$Water_Year <- unique(LittleMillseat$Water_Year)
LM.mean.discharge.mean.wateryear <- data.frame(matrix((nrow=length(LM.mean.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Water_Year))){
    LM.mean.discharge.mean.wateryear[i,1] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

colnames(LM.mean.discharge.mean.wateryear) <- c('mean.discharge.mean')
LM.mean.discharge.mean.wateryear$Water_Year <- LM.discharge.wateryear
LM.mean.discharge.mean.wateryear <- na.omit(LM.mean.discharge.mean.wateryear)
LM.mean.discharge.senslope.wateryear <- sens.output(time.step=LM.mean.discharge.mean.wateryear$Water_Year,data=LM.mean.discharge.mean.wateryear$mean.discharge.mean)
LM.mean.discharge.senslope.wateryear$year <- "Water.Year"

LM.mean.discharge.mean.wateryear.nozero <- data.frame(matrix((nrow=length(LM.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Water_Year))){
    LM.mean.discharge.mean.wateryear.nozero[i,1] <- mean(LittleMillseat$mean.discharge.nozero[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

colnames(LM.mean.discharge.mean.wateryear.nozero) <- c('mean.discharge.mean')
LM.mean.discharge.mean.wateryear.nozero$Water_Year <- LM.discharge.wateryear
LM.mean.discharge.mean.wateryear.nozero <- na.omit(LM.mean.discharge.mean.wateryear.nozero)
LM.mean.discharge.senslope.wateryear.nozero <- sens.output(time.step=LM.mean.discharge.mean.wateryear.nozero$Water_Year,data=log(LM.mean.discharge.mean.wateryear.nozero$mean.discharge.mean))
LM.mean.discharge.senslope.wateryear.nozero$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_meanflow.water.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Water_Year), mean.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Mean Annual Discharge (Log Scale) Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Water_Year), meandaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.wateryear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Mean Annual Discharge Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Climate Year

LM.discharge.climateyear <- unique(LittleMillseat$Climate_Year)
LM.mean.discharge.climateyear <- data.frame(matrix(nrow=length(LM.discharge.climateyear),ncol=1))
for(i in 1:length(LM.discharge.climateyear)){
  LM.mean.discharge.climateyear[i,1] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

LM.mean.discharge.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.mean.discharge.mean.climateyear <- data.frame(matrix((nrow=length(LM.mean.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Climate_Year))){
    LM.mean.discharge.mean.climateyear[i,1] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

colnames(LM.mean.discharge.mean.climateyear) <- c('mean.discharge.mean')
LM.mean.discharge.mean.climateyear$Climate_Year <- LM.discharge.climateyear
LM.mean.discharge.mean.climateyear <- na.omit(LM.mean.discharge.mean.climateyear)
LM.mean.discharge.senslope.climateyear <- sens.output(time.step=LM.mean.discharge.mean.climateyear$Climate_Year,data=LM.mean.discharge.mean.climateyear$mean.discharge.mean)
LM.mean.discharge.senslope.climateyear$year <- "Climate.Year"

LM.mean.discharge.mean.climateyear.nozero <- data.frame(matrix((nrow=length(LM.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Climate_Year))){
    LM.mean.discharge.mean.climateyear.nozero[i,1] <- mean(LittleMillseat$mean.discharge.nozero[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

colnames(LM.mean.discharge.mean.climateyear.nozero) <- c('mean.discharge.mean')
LM.mean.discharge.mean.climateyear.nozero$Climate_Year <- LM.discharge.climateyear
LM.mean.discharge.mean.climateyear.nozero <- na.omit(LM.mean.discharge.mean.climateyear.nozero)
LM.mean.discharge.senslope.climateyear.nozero <- sens.output(time.step=LM.mean.discharge.mean.climateyear.nozero$Climate_Year,data=log(LM.mean.discharge.mean.climateyear.nozero$mean.discharge.mean))
LM.mean.discharge.senslope.climateyear.nozero$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_meanflow.clim.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Climate_Year), mean.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Mean Annual Discharge (Log Scale) Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Climate_Year), meandaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.climateyear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Mean Annual Discharge Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
LittleMillseat$season <- time2season(LittleMillseat$Date.1,out.fmt="seasons")
LM.discharge.season <- unique(LittleMillseat$season)
LM.mean.discharge.season <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.mean.discharge.season[i,j] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
  colnames(LM.mean.discharge.season) <- c("Summer","Autumn","Winter","Spring")
}
LM.mean.discharge.season$year <- unique(LittleMillseat$Year)
LM.season <- unique(LittleMillseat$season)

LM.mean.discharge.mean.season <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.mean.discharge.mean.season[i,j] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
}
LM.season <- c("Winter","Spring","Summer","Autumn")
colnames(LM.mean.discharge.mean.season) <- LM.season
LM.mean.discharge.mean.season$year <- LM.discharge.year
LM.mean.discharge.mean.season <- na.omit(LM.mean.discharge.mean.season)
LM.mean.discharge.senslope.winter <- sens.output(time.step=LM.mean.discharge.mean.season$year,data=LM.mean.discharge.mean.season$Winter)
LM.mean.discharge.senslope.spring <- sens.output(time.step=LM.mean.discharge.mean.season$year,data=LM.mean.discharge.mean.season$Spring)
LM.mean.discharge.senslope.summer <- sens.output(time.step=LM.mean.discharge.mean.season$year,data=LM.mean.discharge.mean.season$Summer)
LM.mean.discharge.senslope.autumn <- sens.output(time.step=LM.mean.discharge.mean.season$year,data=LM.mean.discharge.mean.season$Autumn)
LM.mean.discharge.senslope.season <- rbind(LM.mean.discharge.senslope.winter,LM.mean.discharge.senslope.spring,LM.mean.discharge.senslope.summer,LM.mean.discharge.senslope.autumn)
LM.mean.discharge.senslope.season$season <- unique(LittleMillseat$season)

LM.mean.discharge.mean.season.nozero <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.mean.discharge.mean.season.nozero[i,j] <- mean(LittleMillseat$mean.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
}
colnames(LM.mean.discharge.mean.season.nozero) <- LM.season
LM.mean.discharge.mean.season.nozero$year <- LM.discharge.year
LM.mean.discharge.mean.season.nozero <- na.omit(LM.mean.discharge.mean.season.nozero)
LM.mean.discharge.senslope.winter.nozero <- sens.output(time.step=LM.mean.discharge.mean.season.nozero$year,data=log(LM.mean.discharge.mean.season.nozero$Winter))
LM.mean.discharge.senslope.spring.nozero <- sens.output(time.step=LM.mean.discharge.mean.season.nozero$year,data=log(LM.mean.discharge.mean.season.nozero$Spring))
LM.mean.discharge.senslope.summer.nozero <- sens.output(time.step=LM.mean.discharge.mean.season.nozero$year,data=log(LM.mean.discharge.mean.season.nozero$Summer))
LM.mean.discharge.senslope.autumn.nozero <- sens.output(time.step=LM.mean.discharge.mean.season.nozero$year,data=log(LM.mean.discharge.mean.season.nozero$Autumn))
LM.mean.discharge.senslope.season.nozero <- rbind(LM.mean.discharge.senslope.winter.nozero,LM.mean.discharge.senslope.spring.nozero,LM.mean.discharge.senslope.summer.nozero,LM.mean.discharge.senslope.autumn.nozero)
LM.mean.discharge.senslope.season.nozero$season <- unique(LittleMillseat$season)


ggplot(LittleMillseat, aes(factor(Year), mean.discharge.nozero, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.season.nozero,aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0.0001,100)+
  scale_y_log10()+
  facet_wrap(~season)+
  ggtitle("Little Millseat Mean Seasonal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(LittleMillseat, aes(factor(Year), meandaily_CFS, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.season,aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,10)+
  facet_wrap(~season)+
  ggtitle("Little Millseat Mean Seasonal Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Monthly
LM.discharge.month <- unique(LittleMillseat$month)
LM.mean.discharge.month <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.mean.discharge.month[i,j] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==LM.discharge.month[j])],na.rm=TRUE)
  }
  colnames(LM.mean.discharge.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
}

LM.mean.discharge.month$year <- unique(LittleMillseat$Year)
LM.mean.discharge.month <- na.omit(LM.mean.discharge.month)

LM.mean.discharge.mean.month <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.mean.discharge.mean.month[i,j] <- mean(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==LM.discharge.month[j])],na.rm=TRUE)
  }
}
colnames(LM.mean.discharge.mean.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
LM.mean.discharge.mean.month$year <- LM.discharge.year
LM.mean.discharge.mean.month <- na.omit(LM.mean.discharge.mean.month)

LM.mean.discharge.senslope.jan <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$January)
LM.mean.discharge.senslope.feb <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$February)
LM.mean.discharge.senslope.mar <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$March)
LM.mean.discharge.senslope.apr <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$April)
LM.mean.discharge.senslope.may <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$May)
LM.mean.discharge.senslope.jun <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$June)
LM.mean.discharge.senslope.jul <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$July)
LM.mean.discharge.senslope.aug <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$August)
LM.mean.discharge.senslope.sep <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$September)
LM.mean.discharge.senslope.oct <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$October)
LM.mean.discharge.senslope.nov <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$November)
LM.mean.discharge.senslope.dec <- sens.output(time.step=LM.mean.discharge.mean.month$year,data=LM.mean.discharge.mean.month$December)
LM.mean.discharge.senslope.month <- rbind(LM.mean.discharge.senslope.jan,LM.mean.discharge.senslope.feb,LM.mean.discharge.senslope.mar,LM.mean.discharge.senslope.apr,LM.mean.discharge.senslope.may,LM.mean.discharge.senslope.jun,LM.mean.discharge.senslope.jul,LM.mean.discharge.senslope.aug,LM.mean.discharge.senslope.sep,LM.mean.discharge.senslope.oct,LM.mean.discharge.senslope.nov,LM.mean.discharge.senslope.dec)
LM.mean.discharge.senslope.month$Month <- unique(LittleMillseat$Month)

LM.mean.discharge.mean.month.nozero <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.mean.discharge.mean.month.nozero[i,j] <- mean(LittleMillseat$mean.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(LM.mean.discharge.mean.month.nozero) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
LM.mean.discharge.mean.month.nozero$year <- LM.discharge.year
LM.mean.discharge.mean.month.nozero <- na.omit(LM.mean.discharge.mean.month.nozero)

LM.mean.discharge.senslope.jan.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$January))
LM.mean.discharge.senslope.feb.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$February))
LM.mean.discharge.senslope.mar.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$March))
LM.mean.discharge.senslope.apr.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$April))
LM.mean.discharge.senslope.may.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$May))
LM.mean.discharge.senslope.jun.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$June))
LM.mean.discharge.senslope.jul.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$July))
LM.mean.discharge.senslope.aug.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$August))
LM.mean.discharge.senslope.sep.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$September))
LM.mean.discharge.senslope.oct.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$October))
LM.mean.discharge.senslope.nov.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$November))
LM.mean.discharge.senslope.dec.nozero <- sens.output(time.step=LM.mean.discharge.mean.month.nozero$year,data=log(LM.mean.discharge.mean.month.nozero$December))
LM.mean.discharge.senslope.month.nozero <- rbind(LM.mean.discharge.senslope.jan.nozero,LM.mean.discharge.senslope.feb.nozero,LM.mean.discharge.senslope.mar.nozero,LM.mean.discharge.senslope.apr.nozero,LM.mean.discharge.senslope.may.nozero,LM.mean.discharge.senslope.jun.nozero,LM.mean.discharge.senslope.jul.nozero,LM.mean.discharge.senslope.aug.nozero,LM.mean.discharge.senslope.sep.nozero,LM.mean.discharge.senslope.oct.nozero,LM.mean.discharge.senslope.nov.nozero,LM.mean.discharge.senslope.dec.nozero)
LM.mean.discharge.senslope.month.nozero$Month <- unique(LittleMillseat$Month)

ggplot(LittleMillseat, aes(factor(Year), mean.discharge.nozero, fill=month)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.discharge.senslope.month.nozero,aes(slope=slope,intercept=0.01))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ylim(0,100)+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Little Millseat Mean Monthly Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(LittleMillseat, aes(factor(Year), meandaily_CFS, fill=month)) +
  geom_boxplot()+
  geom_abline(data=mean.discharge.senslope.month,aes(slope=slope, intercept=0.01))+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,15)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Mean Monthly Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

```
### Section 3.2.1: Mean Flow Statistical Summary
```{r}
LM.Mean.Flow.statistical.summary <- rbind.fill(LM.mean.discharge.senslope.halfdec,LM.mean.discharge.senslope.year,LM.mean.discharge.senslope.wateryear,LM.mean.discharge.senslope.climateyear,LM.mean.discharge.senslope.season,LM.mean.discharge.senslope.month)

LM.Mean.Flow.Nozero.statistical.summary <- rbind.fill(LM.mean.discharge.nozero.senslope.halfdec,LM.mean.discharge.senslope.year.nozero,LM.mean.discharge.senslope.wateryear.nozero,LM.mean.discharge.senslope.climateyear.nozero,LM.mean.discharge.senslope.season.nozero,LM.mean.discharge.senslope.month.nozero)
```

## Section 3.3: Maximum Flow
```{r}
#Entire Time Series (Daily)
LittleMillseat$max.discharge.nozero <- LittleMillseat$maxdaily_CFS+0.0001

ggplot(data=LittleMillseat, aes(x=Date, y=max.discharge.nozero))+
  geom_line()+
  scale_y_log10()+
  ggtitle("Little Millseat Maximum Daily Discharge at Little Millseat (Log Scale)")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(data=LittleMillseat, aes(x=Date, y=maxdaily_CFS))+
  geom_line()+
  ggtitle("Little Millseat Maximum Daily Discharge at Little Millseat")+
  xlab("Date")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#1/2 Decade
LM.discharge.half.dec <- unique(LittleMillseat$half.decade)
LM.max.discharge.half.dec <- data.frame(matrix(nrow=length(LM.discharge.half.dec),ncol=3))
for(i in 1:length(LM.discharge.half.dec)){
  LM.max.discharge.half.dec[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$half.decade==LM.discharge.half.dec[i])],na.rm=TRUE)
}

colnames(LM.max.discharge.half.dec) <- c("maxdaily_CFS","halfdec","no.zero")
LM.max.discharge.half.dec$halfdec <- unique(LittleMillseat$half.decade)
LM.max.discharge.half.dec$no.zero <- LM.max.discharge.half.dec$maxdaily_CFS+0.0001

LM.max.discharge.max.halfdec <- data.frame(matrix(nrow=length(unique(LittleMillseat$half.decade)),ncol=1))
for(i in 1:length(unique(LittleMillseat$half.decade))){
    LM.max.discharge.max.halfdec[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$half.decade==LM.discharge.half.dec[i])],na.rm=TRUE)
}

colnames(LM.max.discharge.max.halfdec) <- c('max.discharge.max')
LM.max.discharge.max.halfdec$halfdec <- LM.discharge.half.dec
LM.max.discharge.max.halfdec <- na.omit(LM.max.discharge.max.halfdec)
LM.max.discharge.senslope.halfdec <- sens.output(time.step=LM.max.discharge.max.halfdec$halfdec,data=LM.max.discharge.max.halfdec$max.discharge.max)
LM.max.discharge.senslope.halfdec$half.decade <- "Half.Decade"

LM.max.discharge.max.halfdec.nozero <- data.frame(matrix(nrow=length(unique(LittleMillseat$half.decade)),ncol=1))
for(i in 1:length(unique(LittleMillseat$half.decade))){
    LM.max.discharge.max.halfdec.nozero[i,1] <- max(LittleMillseat$max.discharge.nozero[which(LittleMillseat$half.decade==half.decades[i])],na.rm=TRUE)
}

colnames(LM.max.discharge.max.halfdec.nozero) <- c('max.discharge.max')
LM.max.discharge.max.halfdec.nozero$halfdec <- LM.discharge.half.dec
LM.max.discharge.max.halfdec.nozero$max.discharge.max[9] <- NA
LM.max.discharge.max.halfdec.nozero <- na.omit(LM.max.discharge.max.halfdec.nozero)
LM.max.discharge.nozero.senslope.halfdec <- sens.output(time.step=LM.max.discharge.max.halfdec.nozero$halfdec,data=log(LM.max.discharge.max.halfdec.nozero$max.discharge.max))
LM.max.discharge.nozero.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(LittleMillseat, aes(factor(half.decade), max.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.nozero.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_y_log10()+
  ggtitle("Little Millseat Maximum Half-Decadal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))


ggplot(LittleMillseat, aes(factor(half.decade), maxdaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.halfdec, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Maximum Half-Decadal Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Yearly
#Calendar Year
LM.discharge.year <- unique(LittleMillseat$Year)
LM.max.discharge.year <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=1))
for(i in 1:length(LM.discharge.year)){
  LM.max.discharge.year[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}

LM.max.discharge.year$year <- unique(LittleMillseat$Year)
LM.max.discharge.max.year <- data.frame(matrix((nrow=length(LM.discharge.year)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Year))){
    LM.max.discharge.max.year[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}
colnames(LM.max.discharge.max.year) <- c('max.discharge.max')
LM.max.discharge.max.year$year <- LM.discharge.year
LM.max.discharge.max.year <- na.omit(LM.max.discharge.max.year)
LM.max.discharge.senslope.year <- sens.output(time.step=LM.max.discharge.max.year$year,data=LM.max.discharge.max.year$max.discharge.max)
LM.max.discharge.senslope.year$year <- "Calendar.Year"

LM.max.discharge.max.year.nozero <- data.frame(matrix((nrow=length(LM.discharge.year)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Year))){
    LM.max.discharge.max.year.nozero[i,1] <- max(LittleMillseat$max.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i])],na.rm=TRUE)
}
LM.max.discharge.max.year.nozero$year <- "Calendar.Year"

colnames(LM.max.discharge.max.year.nozero) <- c('max.discharge.max')
LM.max.discharge.max.year.nozero$year <- LM.discharge.year
LM.max.discharge.max.year.nozero <- na.omit(LM.max.discharge.max.year.nozero)
LM.max.discharge.senslope.year.nozero <- sens.output(time.step=LM.max.discharge.max.year.nozero$year,data=log(LM.max.discharge.max.year.nozero$max.discharge.max))

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_maxflow.cal.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Year), max.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.year.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Maximum Annual Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Year), maxdaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.year,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Maximum Annual Discharge")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Water Year
LM.discharge.wateryear <- unique(LittleMillseat$Water_Year)
LM.max.discharge.wateryear <- data.frame(matrix(nrow=length(LM.discharge.wateryear),ncol=1))
for(i in 1:length(LM.discharge.wateryear)){
  LM.max.discharge.wateryear[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

LM.max.discharge.wateryear$Water_Year <- unique(LittleMillseat$Water_Year)
LM.max.discharge.max.wateryear <- data.frame(matrix((nrow=length(LM.max.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Water_Year))){
    LM.max.discharge.max.wateryear[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

colnames(LM.max.discharge.max.wateryear) <- c('max.discharge.max')
LM.max.discharge.max.wateryear$Water_Year <- LM.discharge.wateryear
LM.max.discharge.max.wateryear <- na.omit(LM.max.discharge.max.wateryear)
LM.max.discharge.senslope.wateryear <- sens.output(time.step=LM.max.discharge.max.wateryear$Water_Year,data=LM.max.discharge.max.wateryear$max.discharge.max)
LM.max.discharge.senslope.wateryear$year <- "Water.Year"

LM.max.discharge.max.wateryear.nozero <- data.frame(matrix((nrow=length(LM.discharge.wateryear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Water_Year))){
    LM.max.discharge.max.wateryear.nozero[i,1] <- max(LittleMillseat$max.discharge.nozero[which(LittleMillseat$Water_Year==LM.discharge.wateryear[i])],na.rm=TRUE)
}

colnames(LM.max.discharge.max.wateryear.nozero) <- c('max.discharge.max')
LM.max.discharge.max.wateryear.nozero$Water_Year <- LM.discharge.wateryear
LM.max.discharge.max.wateryear.nozero <- na.omit(LM.max.discharge.max.wateryear.nozero)
LM.max.discharge.senslope.wateryear.nozero <- sens.output(time.step=LM.max.discharge.max.wateryear.nozero$Water_Year,data=log(LM.max.discharge.max.wateryear.nozero$max.discharge.max))
LM.max.discharge.senslope.wateryear.nozero$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_maxflow.water.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Water_Year), max.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Maximum Annual Discharge (Log Scale) Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Water_Year), maxdaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.wateryear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Maximum Annual Discharge Using Water Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Climate Year

LM.discharge.climateyear <- unique(LittleMillseat$Climate_Year)
LM.max.discharge.climateyear <- data.frame(matrix(nrow=length(LM.discharge.climateyear),ncol=1))
for(i in 1:length(LM.discharge.climateyear)){
  LM.max.discharge.climateyear[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

LM.max.discharge.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.max.discharge.max.climateyear <- data.frame(matrix((nrow=length(LM.max.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Climate_Year))){
    LM.max.discharge.max.climateyear[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

colnames(LM.max.discharge.max.climateyear) <- c('max.discharge.max')
LM.max.discharge.max.climateyear$Climate_Year <- LM.discharge.climateyear
LM.max.discharge.max.climateyear <- na.omit(LM.max.discharge.max.climateyear)
LM.max.discharge.senslope.climateyear <- sens.output(time.step=LM.max.discharge.max.climateyear$Climate_Year,data=LM.max.discharge.max.climateyear$max.discharge.max)
LM.max.discharge.senslope.climateyear$year <- "CLimate.Year"

LM.max.discharge.max.climateyear.nozero <- data.frame(matrix((nrow=length(LM.discharge.climateyear)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Climate_Year))){
    LM.max.discharge.max.climateyear.nozero[i,1] <- max(LittleMillseat$max.discharge.nozero[which(LittleMillseat$Climate_Year==LM.discharge.climateyear[i])],na.rm=TRUE)
}

colnames(LM.max.discharge.max.climateyear.nozero) <- c('max.discharge.max')
LM.max.discharge.max.climateyear.nozero$Climate_Year <- LM.discharge.climateyear
LM.max.discharge.max.climateyear.nozero <- na.omit(LM.max.discharge.max.climateyear.nozero)
LM.max.discharge.senslope.climateyear.nozero <- sens.output(time.step=LM.max.discharge.max.climateyear.nozero$Climate_Year,data=log(LM.max.discharge.max.climateyear.nozero$max.discharge.max))
LM.max.discharge.senslope.climateyear.nozero$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_maxflow.clim.jpeg", width=1000)
ggplot(LittleMillseat, aes(factor(Climate_Year), max.discharge.nozero)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.wateryear.nozero, aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  scale_y_log10()+
  ggtitle("Little Millseat Maximum Annual Discharge (Log Scale) Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

ggplot(LittleMillseat, aes(factor(Climate_Year), maxdaily_CFS)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.climateyear,aes(slope=slope,intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ggtitle("Little Millseat Maximum Annual Discharge Using Climate Year")+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
LittleMillseat$season <- time2season(LittleMillseat$Date.1,out.fmt="seasons")
LM.discharge.season <- unique(LittleMillseat$season)
LM.max.discharge.season <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.max.discharge.season[i,j] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
  colnames(LM.max.discharge.season) <- c("Summer","Autumn","Winter","Spring")
}
LM.max.discharge.season$year <- unique(LittleMillseat$Year)
LM.season <- unique(LittleMillseat$season)

LM.max.discharge.max.season <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.max.discharge.max.season[i,j] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
}
LM.season <- c("Winter","Spring","Summer","Autumn")
colnames(LM.max.discharge.max.season) <- LM.season
LM.max.discharge.max.season$year <- LM.discharge.year
LM.max.discharge.max.season <- na.omit(LM.max.discharge.max.season)
LM.max.discharge.senslope.winter <- sens.output(time.step=LM.max.discharge.max.season$year,data=LM.max.discharge.max.season$Winter)
LM.max.discharge.senslope.spring <- sens.output(time.step=LM.max.discharge.max.season$year,data=LM.max.discharge.max.season$Spring)
LM.max.discharge.senslope.summer <- sens.output(time.step=LM.max.discharge.max.season$year,data=LM.max.discharge.max.season$Summer)
LM.max.discharge.senslope.autumn <- sens.output(time.step=LM.max.discharge.max.season$year,data=LM.max.discharge.max.season$Autumn)
LM.max.discharge.senslope.season <- rbind(LM.max.discharge.senslope.winter,LM.max.discharge.senslope.spring,LM.max.discharge.senslope.summer,LM.max.discharge.senslope.autumn)
LM.max.discharge.senslope.season$season <- unique(LittleMillseat$season)

LM.max.discharge.max.season.nozero <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.max.discharge.max.season.nozero[i,j] <- max(LittleMillseat$max.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])],na.rm=TRUE)
  }
}
colnames(LM.max.discharge.max.season.nozero) <- LM.season
LM.max.discharge.max.season.nozero$year <- LM.discharge.year
LM.max.discharge.max.season.nozero <- na.omit(LM.max.discharge.max.season.nozero)
LM.max.discharge.senslope.winter.nozero <- sens.output(time.step=LM.max.discharge.max.season.nozero$year,data=log(LM.max.discharge.max.season.nozero$Winter))
LM.max.discharge.senslope.spring.nozero <- sens.output(time.step=LM.max.discharge.max.season.nozero$year,data=log(LM.max.discharge.max.season.nozero$Spring))
LM.max.discharge.senslope.summer.nozero <- sens.output(time.step=LM.max.discharge.max.season.nozero$year,data=log(LM.max.discharge.max.season.nozero$Summer))
LM.max.discharge.senslope.autumn.nozero <- sens.output(time.step=LM.max.discharge.max.season.nozero$year,data=log(LM.max.discharge.max.season.nozero$Autumn))
LM.max.discharge.senslope.season.nozero <- rbind(LM.max.discharge.senslope.winter.nozero,LM.max.discharge.senslope.spring.nozero,LM.max.discharge.senslope.summer.nozero,LM.max.discharge.senslope.autumn.nozero)
LM.max.discharge.senslope.season.nozero$season <- unique(LittleMillseat$season)


ggplot(LittleMillseat, aes(factor(Year), max.discharge.nozero, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.season.nozero,aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0.0001,100)+
  scale_y_log10()+
  facet_wrap(~season)+
  ggtitle("Little Millseat Maximum Seasonal Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(LittleMillseat, aes(factor(Year), maxdaily_CFS, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.season,aes(slope=slope, intercept=0.01))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,10)+
  facet_wrap(~season)+
  ggtitle("Little Millseat Maximum Seasonal Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Monthly
LM.discharge.month <- unique(LittleMillseat$month)
LM.max.discharge.month <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.max.discharge.month[i,j] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==LM.discharge.month[j])],na.rm=TRUE)
  }
  colnames(LM.max.discharge.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
}

LM.max.discharge.month$year <- unique(LittleMillseat$Year)
LM.max.discharge.month <- na.omit(LM.max.discharge.month)

LM.max.discharge.max.month <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.max.discharge.max.month[i,j] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==LM.discharge.month[j])],na.rm=TRUE)
  }
}
colnames(LM.max.discharge.max.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
LM.max.discharge.max.month$year <- LM.discharge.year
LM.max.discharge.max.month <- na.omit(LM.max.discharge.max.month)

LM.max.discharge.senslope.jan <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$January)
LM.max.discharge.senslope.feb <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$February)
LM.max.discharge.senslope.mar <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$March)
LM.max.discharge.senslope.apr <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$April)
LM.max.discharge.senslope.may <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$May)
LM.max.discharge.senslope.jun <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$June)
LM.max.discharge.senslope.jul <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$July)
LM.max.discharge.senslope.aug <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$August)
LM.max.discharge.senslope.sep <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$September)
LM.max.discharge.senslope.oct <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$October)
LM.max.discharge.senslope.nov <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$November)
LM.max.discharge.senslope.dec <- sens.output(time.step=LM.max.discharge.max.month$year,data=LM.max.discharge.max.month$December)
LM.max.discharge.senslope.month <- rbind(LM.max.discharge.senslope.jan,LM.max.discharge.senslope.feb,LM.max.discharge.senslope.mar,LM.max.discharge.senslope.apr,LM.max.discharge.senslope.may,LM.max.discharge.senslope.jun,LM.max.discharge.senslope.jul,LM.max.discharge.senslope.aug,LM.max.discharge.senslope.sep,LM.max.discharge.senslope.oct,LM.max.discharge.senslope.nov,LM.max.discharge.senslope.dec)
LM.max.discharge.senslope.month$Month <- unique(LittleMillseat$Month)

LM.max.discharge.max.month.nozero <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.max.discharge.max.month.nozero[i,j] <- max(LittleMillseat$max.discharge.nozero[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==discharge.month[j])],na.rm=TRUE)
  }
}
colnames(LM.max.discharge.max.month.nozero) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
LM.max.discharge.max.month.nozero$year <- LM.discharge.year
LM.max.discharge.max.month.nozero$March[29] <- NA
LM.max.discharge.max.month.nozero <- na.omit(LM.max.discharge.max.month.nozero)

LM.max.discharge.senslope.jan.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$January))
LM.max.discharge.senslope.feb.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$February))
LM.max.discharge.senslope.mar.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$March))
LM.max.discharge.senslope.apr.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$April))
LM.max.discharge.senslope.may.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$May))
LM.max.discharge.senslope.jun.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$June))
LM.max.discharge.senslope.jul.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$July))
LM.max.discharge.senslope.aug.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$August))
LM.max.discharge.senslope.sep.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$September))
LM.max.discharge.senslope.oct.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$October))
LM.max.discharge.senslope.nov.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$November))
LM.max.discharge.senslope.dec.nozero <- sens.output(time.step=LM.max.discharge.max.month.nozero$year,data=log(LM.max.discharge.max.month.nozero$December))
LM.max.discharge.senslope.month.nozero <- rbind(LM.max.discharge.senslope.jan.nozero,LM.max.discharge.senslope.feb.nozero,LM.max.discharge.senslope.mar.nozero,LM.max.discharge.senslope.apr.nozero,LM.max.discharge.senslope.may.nozero,LM.max.discharge.senslope.jun.nozero,LM.max.discharge.senslope.jul.nozero,LM.max.discharge.senslope.aug.nozero,LM.max.discharge.senslope.sep.nozero,LM.max.discharge.senslope.oct.nozero,LM.max.discharge.senslope.nov.nozero,LM.max.discharge.senslope.dec.nozero)
LM.max.discharge.senslope.month.nozero$Month <- unique(LittleMillseat$Month)

ggplot(LittleMillseat, aes(factor(Year), max.discharge.nozero, fill=month)) +
  geom_boxplot() +
  geom_abline(data=LM.max.discharge.senslope.month.nozero,aes(slope=slope,intercept=0.01))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ylim(0,100)+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Little Millseat Maximum Monthly Discharge (Log Scale)")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

ggplot(LittleMillseat, aes(factor(Year), maxdaily_CFS, fill=month)) +
  geom_boxplot()+
  geom_abline(data=LM.max.discharge.senslope.month,aes(slope=slope, intercept=0.01))+
  scale_y_log10()+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  ylim(0,15)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Maximum Monthly Discharge")+
  xlab("Year")+
  ylab("Discharge (cfs)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

```
### Section 3.3.1: Maximum Flow Statistical Summary
```{r}
LM.Max.Flow.statistical.summary <- rbind.fill(LM.max.discharge.senslope.halfdec,LM.max.discharge.senslope.year,LM.max.discharge.senslope.wateryear,LM.max.discharge.senslope.climateyear,LM.max.discharge.senslope.season,LM.max.discharge.senslope.month)

LM.Max.Flow.Nozero.statistical.summary <- rbind.fill(LM.max.discharge.nozero.senslope.halfdec,LM.max.discharge.senslope.year.nozero,LM.max.discharge.senslope.wateryear.nozero,LM.max.discharge.senslope.climateyear.nozero,LM.max.discharge.senslope.season.nozero,LM.max.discharge.senslope.month.nozero)
```


## Section 3.4: Minimum Water Temperature
```{r}
colnames(LM.watertemp.data) <- c("Date.1","Year","halfdec","mean","min","max")
LM.watertemp.data <- na.omit(LM.watertemp.data)
LM.watertemp.data$season <- time2season(LM.watertemp.data$Date.1,out.fmt="seasons")
LM.watertemp.data$month <- format(as.Date(LM.watertemp.data$Date.1, format="%m/%d/%Y"),"%m")
LM.watertemp.data$month <- as.numeric(LM.watertemp.data$month)
LM.watertemp.data$Month <- months.name[LM.watertemp.data$month]

#Entire Time Series (Daily)
ggplot(data=LittleMillseat, aes(x=Date.1, y=tempmin))+
  geom_line()+
  ggtitle("Little Millseat Minimum Daily Water Temperature at Little Millseat")+
  xlab("Date")+
  scale_x_date(limits = as.Date(c("2010-01-01", "2015-12-31")))
  ylab("Water Temperature (F)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
  
#1/2 Decade
LM.watertemp.half.dec <- unique(LittleMillseat$half.decade)
LM.min.watertemp.half.dec <- data.frame(matrix(nrow=length(LM.watertemp.half.dec),ncol=1))
for(i in 1:length(LM.watertemp.half.dec)){
  LM.min.watertemp.half.dec[i,1] <- min(LittleMillseat$tempmin[which(LittleMillseat$half.decade==LM.watertemp.half.dec[i])],na.rm=TRUE)
} 

LM.median.watertemp.min.halfdec <- data.frame(matrix(nrow=length(LM.watertemp.half.dec),ncol=1))
for(i in 1:length(LM.watertemp.half.dec)){
    LM.median.watertemp.min.halfdec[i,1] <- median(LittleMillseat$tempmin[which(LittleMillseat$half.decade==LM.watertemp.half.dec[i])],na.rm=TRUE)
}

colnames(LM.median.watertemp.min.halfdec) <- c('median.watertemp')
LM.median.watertemp.min.halfdec$halfdec <- LM.watertemp.half.dec
LM.median.watertemp.min.halfdec <- na.omit(LM.median.watertemp.min.halfdec)
LM.min.watertemp.senslope.halfdec <- sens.output(time.step=LM.median.watertemp.min.halfdec$halfdec,data=LM.median.watertemp.min.halfdec$median.watertemp)
LM.min.watertemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(LM.watertemp.data, aes(factor(halfdec), min)) +
  geom_boxplot() +
  geom_abline(data=LM.min.watertemp.senslope.halfdec, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Half-Decade Minimum Water Temperature")+
  xlab("Half Decade")+
  ylab("Water Temperature (F)")

#Yearly
LM.water.temp.year <- unique(LM.watertemp.data$Year)
LM.min.watertemp.year <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=1))
for(i in 1:length(LM.water.temp.year)){
  LM.min.watertemp.year[i,1] <- 
    min(LittleMillseat$tempmin[which(LittleMillseat$Year==LM.water.temp.year[i])])
} 

LM.median.watertemp.min.year <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=1))
for(i in 1:length(LM.water.temp.year)){
    LM.median.watertemp.min.year[i,1] <- median(LittleMillseat$tempmin[which(LittleMillseat$Year==LM.water.temp.year[i])],na.rm=TRUE)
}

colnames(LM.median.watertemp.min.year) <- c('median.watertemp')
LM.median.watertemp.min.year$year <- LM.water.temp.year
LM.median.watertemp.min.year <- na.omit(LM.median.watertemp.min.year)
LM.min.watertemp.senslope.year <- sens.output(time.step=LM.median.watertemp.min.year$year,data=LM.median.watertemp.min.year$median.watertemp)
LM.min.watertemp.senslope.year$year <- "Calendar.Year"

ggplot(LM.watertemp.data, aes(factor(Year), min)) +
  geom_boxplot() +
  geom_abline(data=LM.min.watertemp.senslope.year, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Minimum Annual Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
LM.watertemp.season <- unique(LittleMillseat$season)
LM.min.watertemp.season <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.watertemp.season)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.watertemp.season)){
    LM.min.watertemp.season[i,j] <- mean(LittleMillseat$tempmin[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$season==LM.watertemp.season[j])],na.rm=TRUE)
  }
}

LM.median.watertemp.min.season <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.watertemp.season)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.watertemp.season)){
    LM.median.watertemp.min.season[i,j] <- median(LittleMillseat$tempmin[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$season==LM.watertemp.season[j])],na.rm=TRUE)
  }
}
colnames(LM.median.watertemp.min.season) <- c("Winter","Spring","Summer","Autumn")
LM.median.watertemp.min.season$year <- LM.water.temp.year
LM.median.watertemp.min.season <- na.omit(LM.median.watertemp.min.season)

LM.min.watertemp.senslope.winter <- sens.output(time.step=LM.median.watertemp.min.season$year,data=LM.median.watertemp.min.season$Winter)
LM.min.watertemp.senslope.spring <- sens.output(time.step=LM.median.watertemp.min.season$year,data=LM.median.watertemp.min.season$Spring)
LM.min.watertemp.senslope.summer <- sens.output(time.step=LM.median.watertemp.min.season$year,data=LM.median.watertemp.min.season$Summer)
LM.min.watertemp.senslope.autumn <- sens.output(time.step=LM.median.watertemp.min.season$year,data=LM.median.watertemp.min.season$Autumn)
LM.min.watertemp.senslope.season <- rbind(LM.min.watertemp.senslope.winter,LM.min.watertemp.senslope.spring,LM.min.watertemp.senslope.summer,LM.min.watertemp.senslope.autumn)
LM.min.watertemp.senslope.season$season <- unique(LittleMillseat$season)

ggplot(LM.watertemp.data, aes(factor(Year), min, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.min.watertemp.senslope.season, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  facet_wrap(~season)+
  ggtitle("Little Millseat Minimum Seasonal Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

#Monthly
LM.water.temp.month <- unique(LittleMillseat$month)
LM.min.watertemp.month <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.water.temp.month)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.water.temp.month)){
    LM.min.watertemp.month[i,j] <- min(LittleMillseat$tempmin[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$month==LM.water.temp.month[j])],na.rm=TRUE)
  }}

LM.median.watertemp.min.month <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.water.temp.month)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.water.temp.month)){
    LM.median.watertemp.min.month[i,j] <- median(LittleMillseat$tempmin[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$month==LM.water.temp.month[j])],na.rm=TRUE)
  }
}
colnames(LM.median.watertemp.min.month) <- unique(LittleMillseat$Month)
LM.median.watertemp.min.month$year <- LM.water.temp.year
LM.median.watertemp.min.month <- na.omit(LM.median.watertemp.min.month)

LM.min.watertemp.senslope.jan <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$January)
LM.min.watertemp.senslope.feb <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$February)
LM.min.watertemp.senslope.mar <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$March)
LM.min.watertemp.senslope.apr <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$April)
LM.min.watertemp.senslope.may <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$May)
LM.min.watertemp.senslope.jun <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$June)
LM.min.watertemp.senslope.jul <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$July)
LM.min.watertemp.senslope.aug <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$August)
LM.min.watertemp.senslope.sep <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$September)
LM.min.watertemp.senslope.oct <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$October)
LM.min.watertemp.senslope.nov <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$November)
LM.min.watertemp.senslope.dec <- sens.output(time.step=LM.median.watertemp.min.month$year,data=LM.median.watertemp.min.month$December)
LM.min.watertemp.senslope.month <- rbind(LM.min.watertemp.senslope.jan,LM.min.watertemp.senslope.feb,LM.min.watertemp.senslope.mar,LM.min.watertemp.senslope.apr,LM.min.watertemp.senslope.may,LM.min.watertemp.senslope.jun,LM.min.watertemp.senslope.jul,LM.min.watertemp.senslope.aug,LM.min.watertemp.senslope.sep,LM.min.watertemp.senslope.oct,LM.min.watertemp.senslope.nov,LM.min.watertemp.senslope.dec)
LM.min.watertemp.senslope.month$Month <- unique(LittleMillseat$Month)

ggplot(LM.watertemp.data, aes(factor(Year), min, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=LM.min.watertemp.senslope.month, aes(slope=slope, intercept=10))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Little Millseat Minimum Monthly Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```
### Section 3.4.1: Minimum Water Temperature Statistical Summary
```{r}
LM.Min.watertemp.statistical.summary <- rbind.fill(LM.min.watertemp.senslope.halfdec,LM.min.watertemp.senslope.year,LM.min.watertemp.senslope.season,LM.min.watertemp.senslope.month)
```

## Section 3.5: Mean Water Temperature
```{r}
#Entire Time Series (Daily)
ggplot(data=LittleMillseat, aes(x=Date.1, y=tempmean))+
  geom_line()+
  ggtitle("Little Millseat Mean Daily Water Temperature at Little Millseat")+
  xlab("Date")+
  scale_x_date(limits = as.Date(c("2010-01-01", "2015-12-31")))
  ylab("Water Temperature (F)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
  
#1/2 Decade
LM.watertemp.half.dec <- unique(LittleMillseat$half.decade)
LM.mean.watertemp.half.dec <- data.frame(matrix(nrow=length(LM.watertemp.half.dec),ncol=1))
for(i in 1:length(LM.watertemp.half.dec)){
  LM.mean.watertemp.half.dec[i,1] <- mean(LittleMillseat$tempmean[which(LittleMillseat$half.decade==LM.watertemp.half.dec[i])],na.rm=TRUE)
} 

LM.median.watertemp.mean.halfdec <- data.frame(matrix(nrow=length(LM.watertemp.half.dec),ncol=1))
for(i in 1:length(LM.watertemp.half.dec)){
    LM.median.watertemp.mean.halfdec[i,1] <- median(LittleMillseat$tempmean[which(LittleMillseat$half.decade==LM.watertemp.half.dec[i])],na.rm=TRUE)
}

colnames(LM.median.watertemp.mean.halfdec) <- c('median.watertemp')
LM.median.watertemp.mean.halfdec$halfdec <- LM.watertemp.half.dec
LM.median.watertemp.mean.halfdec <- na.omit(LM.median.watertemp.mean.halfdec)
LM.mean.watertemp.senslope.halfdec <- sens.output(time.step=LM.median.watertemp.mean.halfdec$halfdec,data=LM.median.watertemp.mean.halfdec$median.watertemp)
LM.mean.watertemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(LM.watertemp.data, aes(factor(halfdec), mean)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.watertemp.senslope.halfdec, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Half-Decade Mean Water Temperature")+
  xlab("Half Decade")+
  ylab("Water Temperature (F)")

#Yearly
LM.water.temp.year <- unique(LM.watertemp.data$Year)
LM.mean.watertemp.year <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=1))
for(i in 1:length(LM.water.temp.year)){
  LM.mean.watertemp.year[i,1] <- 
    mean(LittleMillseat$tempmean[which(LittleMillseat$Year==LM.water.temp.year[i])])
} 

LM.median.watertemp.mean.year <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=1))
for(i in 1:length(LM.water.temp.year)){
    LM.median.watertemp.mean.year[i,1] <- median(LittleMillseat$tempmean[which(LittleMillseat$Year==LM.water.temp.year[i])],na.rm=TRUE)
}

colnames(LM.median.watertemp.mean.year) <- c('median.watertemp')
LM.median.watertemp.mean.year$year <- LM.water.temp.year
LM.median.watertemp.mean.year <- na.omit(LM.median.watertemp.mean.year)
LM.mean.watertemp.senslope.year <- sens.output(time.step=LM.median.watertemp.mean.year$year,data=LM.median.watertemp.mean.year$median.watertemp)
LM.mean.watertemp.senslope.year$year <- "Calendar.Year"

ggplot(LM.watertemp.data, aes(factor(Year), mean)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.watertemp.senslope.year, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Mean Annual Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
LM.watertemp.season <- unique(LittleMillseat$season)
LM.mean.watertemp.season <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.watertemp.season)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.watertemp.season)){
    LM.mean.watertemp.season[i,j] <- mean(LittleMillseat$tempmean[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$season==LM.watertemp.season[j])],na.rm=TRUE)
  }
}

LM.median.watertemp.mean.season <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.watertemp.season)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.watertemp.season)){
    LM.median.watertemp.mean.season[i,j] <- median(LittleMillseat$tempmean[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$season==LM.watertemp.season[j])],na.rm=TRUE)
  }
}
colnames(LM.median.watertemp.mean.season) <- c("Winter","Spring","Summer","Autumn")
LM.median.watertemp.mean.season$year <- LM.water.temp.year
LM.median.watertemp.mean.season <- na.omit(LM.median.watertemp.mean.season)

LM.mean.watertemp.senslope.winter <- sens.output(time.step=LM.median.watertemp.mean.season$year,data=LM.median.watertemp.mean.season$Winter)
LM.mean.watertemp.senslope.spring <- sens.output(time.step=LM.median.watertemp.mean.season$year,data=LM.median.watertemp.mean.season$Spring)
LM.mean.watertemp.senslope.summer <- sens.output(time.step=LM.median.watertemp.mean.season$year,data=LM.median.watertemp.mean.season$Summer)
LM.mean.watertemp.senslope.autumn <- sens.output(time.step=LM.median.watertemp.mean.season$year,data=LM.median.watertemp.mean.season$Autumn)
LM.mean.watertemp.senslope.season <- rbind(LM.mean.watertemp.senslope.winter,LM.mean.watertemp.senslope.spring,LM.mean.watertemp.senslope.summer,LM.mean.watertemp.senslope.autumn)
LM.mean.watertemp.senslope.season$season <- unique(LittleMillseat$season)

ggplot(LM.watertemp.data, aes(factor(Year), mean, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.watertemp.senslope.season, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  facet_wrap(~season)+
  ggtitle("Little Millseat Mean Seasonal Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

#Monthly
LM.water.temp.month <- unique(LittleMillseat$month)
LM.mean.watertemp.month <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.water.temp.month)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.water.temp.month)){
    LM.mean.watertemp.month[i,j] <- mean(LittleMillseat$tempmean[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$month==LM.water.temp.month[j])],na.rm=TRUE)
  }}

LM.median.watertemp.mean.month <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.water.temp.month)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.water.temp.month)){
    LM.median.watertemp.mean.month[i,j] <- median(LittleMillseat$tempmean[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$month==LM.water.temp.month[j])],na.rm=TRUE)
  }
}
colnames(LM.median.watertemp.mean.month) <- unique(LittleMillseat$Month)
LM.median.watertemp.mean.month$year <- LM.water.temp.year
LM.median.watertemp.mean.month <- na.omit(LM.median.watertemp.mean.month)

LM.mean.watertemp.senslope.jan <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$January)
LM.mean.watertemp.senslope.feb <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$February)
LM.mean.watertemp.senslope.mar <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$March)
LM.mean.watertemp.senslope.apr <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$April)
LM.mean.watertemp.senslope.may <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$May)
LM.mean.watertemp.senslope.jun <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$June)
LM.mean.watertemp.senslope.jul <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$July)
LM.mean.watertemp.senslope.aug <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$August)
LM.mean.watertemp.senslope.sep <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$September)
LM.mean.watertemp.senslope.oct <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$October)
LM.mean.watertemp.senslope.nov <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$November)
LM.mean.watertemp.senslope.dec <- sens.output(time.step=LM.median.watertemp.mean.month$year,data=LM.median.watertemp.mean.month$December)
LM.mean.watertemp.senslope.month <- rbind(LM.mean.watertemp.senslope.jan,LM.mean.watertemp.senslope.feb,LM.mean.watertemp.senslope.mar,LM.mean.watertemp.senslope.apr,LM.mean.watertemp.senslope.may,LM.mean.watertemp.senslope.jun,LM.mean.watertemp.senslope.jul,LM.mean.watertemp.senslope.aug,LM.mean.watertemp.senslope.sep,LM.mean.watertemp.senslope.oct,LM.mean.watertemp.senslope.nov,LM.mean.watertemp.senslope.dec)
LM.mean.watertemp.senslope.month$Month <- unique(LittleMillseat$Month)

ggplot(LM.watertemp.data, aes(factor(Year), mean, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=LM.mean.watertemp.senslope.month, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Little Millseat Mean Monthly Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```
### Section 3.5.1: Mean Water Temperature Statistical SUmmary
```{r}
LM.Mean.watertemp.statistical.summary <- rbind.fill(LM.mean.watertemp.senslope.halfdec,LM.mean.watertemp.senslope.year,LM.mean.watertemp.senslope.season,LM.mean.watertemp.senslope.month)
```

## Section 3.6: Maximum Water Temperature
```{r}
#Entire Time Series (Daily)
ggplot(data=LittleMillseat, aes(x=Date.1, y=tempmax))+
  geom_line()+
  ggtitle("Little Millseat Maximum Daily Water Temperature at Little Millseat")+
  xlab("Date")+
  scale_x_date(limits = as.Date(c("2010-01-01", "2015-12-31")))
  ylab("Water Temperature (F)")+
  scale_x_date(date_breaks = "years" , date_labels = "%y")+
  theme(axis.text.x = element_text(size = 6), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))
  
#1/2 Decade
LM.watertemp.half.dec <- unique(LittleMillseat$half.decade)
LM.max.watertemp.half.dec <- data.frame(matrix(nrow=length(LM.watertemp.half.dec),ncol=1))
for(i in 1:length(LM.watertemp.half.dec)){
  LM.max.watertemp.half.dec[i,1] <- max(LittleMillseat$tempmax[which(LittleMillseat$half.decade==LM.watertemp.half.dec[i])],na.rm=TRUE)
} 

LM.median.watertemp.max.halfdec <- data.frame(matrix(nrow=length(LM.watertemp.half.dec),ncol=1))
for(i in 1:length(LM.watertemp.half.dec)){
    LM.median.watertemp.max.halfdec[i,1] <- median(LittleMillseat$tempmax[which(LittleMillseat$half.decade==LM.watertemp.half.dec[i])],na.rm=TRUE)
}

colnames(LM.median.watertemp.max.halfdec) <- c('median.watertemp')
LM.median.watertemp.max.halfdec$halfdec <- LM.watertemp.half.dec
LM.median.watertemp.max.halfdec <- na.omit(LM.median.watertemp.max.halfdec)
LM.max.watertemp.senslope.halfdec <- sens.output(time.step=LM.median.watertemp.max.halfdec$halfdec,data=LM.median.watertemp.max.halfdec$median.watertemp)
LM.max.watertemp.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(LM.watertemp.data, aes(factor(halfdec), max)) +
  geom_boxplot() +
  geom_abline(data=LM.max.watertemp.senslope.halfdec, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Half-Decade Maximum Water Temperature")+
  xlab("Half Decade")+
  ylab("Water Temperature (F)")

#Yearly
LM.water.temp.year <- unique(LM.watertemp.data$Year)
LM.max.watertemp.year <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=1))
for(i in 1:length(LM.water.temp.year)){
  LM.max.watertemp.year[i,1] <- 
    max(LittleMillseat$tempmax[which(LittleMillseat$Year==LM.water.temp.year[i])])
} 

LM.median.watertemp.max.year <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=1))
for(i in 1:length(LM.water.temp.year)){
    LM.median.watertemp.max.year[i,1] <- median(LittleMillseat$tempmax[which(LittleMillseat$Year==LM.water.temp.year[i])],na.rm=TRUE)
}

colnames(LM.median.watertemp.max.year) <- c('median.watertemp')
LM.median.watertemp.max.year$year <- LM.water.temp.year
LM.median.watertemp.max.year <- na.omit(LM.median.watertemp.max.year)
LM.max.watertemp.senslope.year <- sens.output(time.step=LM.median.watertemp.max.year$year,data=LM.median.watertemp.max.year$median.watertemp)
LM.max.watertemp.senslope.year$year <- "Calendar.Year"

ggplot(LM.watertemp.data, aes(factor(Year), max)) +
  geom_boxplot() +
  geom_abline(data=LM.max.watertemp.senslope.year, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  ggtitle("Little Millseat Maximum Annual Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=10),axis.title.y = element_text(size=10))

#Seasonal
LM.watertemp.season <- unique(LittleMillseat$season)
LM.max.watertemp.season <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.watertemp.season)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.watertemp.season)){
    LM.max.watertemp.season[i,j] <- mean(LittleMillseat$tempmax[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$season==LM.watertemp.season[j])],na.rm=TRUE)
  }
}

LM.median.watertemp.max.season <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.watertemp.season)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.watertemp.season)){
    LM.median.watertemp.max.season[i,j] <- median(LittleMillseat$tempmax[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$season==LM.watertemp.season[j])],na.rm=TRUE)
  }
}
colnames(LM.median.watertemp.max.season) <- c("Winter","Spring","Summer","Autumn")
LM.median.watertemp.max.season$year <- LM.water.temp.year
LM.median.watertemp.max.season <- na.omit(LM.median.watertemp.max.season)

LM.max.watertemp.senslope.winter <- sens.output(time.step=LM.median.watertemp.max.season$year,data=LM.median.watertemp.max.season$Winter)
LM.max.watertemp.senslope.spring <- sens.output(time.step=LM.median.watertemp.max.season$year,data=LM.median.watertemp.max.season$Spring)
LM.max.watertemp.senslope.summer <- sens.output(time.step=LM.median.watertemp.max.season$year,data=LM.median.watertemp.max.season$Summer)
LM.max.watertemp.senslope.autumn <- sens.output(time.step=LM.median.watertemp.max.season$year,data=LM.median.watertemp.max.season$Autumn)
LM.max.watertemp.senslope.season <- rbind(LM.max.watertemp.senslope.winter,LM.max.watertemp.senslope.spring,LM.max.watertemp.senslope.summer,LM.max.watertemp.senslope.autumn)
LM.max.watertemp.senslope.season$season <- unique(LittleMillseat$season)

ggplot(LM.watertemp.data, aes(factor(Year), max, fill=season)) +
  geom_boxplot() +
  geom_abline(data=LM.max.watertemp.senslope.season, aes(slope=slope, intercept=12))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  facet_wrap(~season)+
  ggtitle("Little Millseat Maximum Seasonal Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 8), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

#Monthly
LM.water.temp.month <- unique(LittleMillseat$month)
LM.max.watertemp.month <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.water.temp.month)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.water.temp.month)){
    LM.max.watertemp.month[i,j] <- max(LittleMillseat$tempmax[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$month==LM.water.temp.month[j])],na.rm=TRUE)
  }}

LM.median.watertemp.max.month <- data.frame(matrix(nrow=length(LM.water.temp.year),ncol=length(LM.water.temp.month)))
for(i in 1:length(LM.water.temp.year)){
  for(j in 1:length(LM.water.temp.month)){
    LM.median.watertemp.max.month[i,j] <- median(LittleMillseat$tempmax[which(LittleMillseat$Year==LM.water.temp.year[i]&LittleMillseat$month==LM.water.temp.month[j])],na.rm=TRUE)
  }
}
colnames(LM.median.watertemp.max.month) <- unique(LittleMillseat$Month)
LM.median.watertemp.max.month$year <- LM.water.temp.year
LM.median.watertemp.max.month <- na.omit(LM.median.watertemp.max.month)

LM.max.watertemp.senslope.jan <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$January)
LM.max.watertemp.senslope.feb <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$February)
LM.max.watertemp.senslope.mar <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$March)
LM.max.watertemp.senslope.apr <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$April)
LM.max.watertemp.senslope.may <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$May)
LM.max.watertemp.senslope.jun <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$June)
LM.max.watertemp.senslope.jul <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$July)
LM.max.watertemp.senslope.aug <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$August)
LM.max.watertemp.senslope.sep <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$September)
LM.max.watertemp.senslope.oct <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$October)
LM.max.watertemp.senslope.nov <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$November)
LM.max.watertemp.senslope.dec <- sens.output(time.step=LM.median.watertemp.max.month$year,data=LM.median.watertemp.max.month$December)
LM.max.watertemp.senslope.month <- rbind(LM.max.watertemp.senslope.jan,LM.max.watertemp.senslope.feb,LM.max.watertemp.senslope.mar,LM.max.watertemp.senslope.apr,LM.max.watertemp.senslope.may,LM.max.watertemp.senslope.jun,LM.max.watertemp.senslope.jul,LM.max.watertemp.senslope.aug,LM.max.watertemp.senslope.sep,LM.max.watertemp.senslope.oct,LM.max.watertemp.senslope.nov,LM.max.watertemp.senslope.dec)
LM.max.watertemp.senslope.month$Month <- unique(LittleMillseat$Month)

ggplot(LM.watertemp.data, aes(factor(Year), max, fill=Month)) +
  geom_boxplot() +
  geom_abline(data=LM.max.watertemp.senslope.month, aes(slope=slope, intercept=15))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  ggtitle("Little Millseat Maximum Monthly Water Temperature Data")+
  xlab("Year")+
  ylab("Water Temperature (F)")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```
### Section 3.6.1: Maximum Water Temperature Statistical Summary
```{r}
LM.Max.watertemp.statistical.summary <- rbind.fill(LM.max.watertemp.senslope.halfdec,LM.max.watertemp.senslope.year,LM.max.watertemp.senslope.season,LM.max.watertemp.senslope.month)
```

# Section 4: Thresholds of Flow Duration Curve

## Section 4.1: No Flow Days
```{r}
LM.years <- unique(LittleMillseat$Year)
#1/2 Decade
LM.noflow.half.decs <- unique(LittleMillseat$half.decade)
LM.noflow.half.dec <- data.frame(matrix(nrow=length(LM.noflow.half.decs),ncol=1))

for(i in 1:length(unique(LittleMillseat$half.decade))){
  LM.Q.half.dec<-LittleMillseat[which(LittleMillseat$half.decade==noflow.half.decs[i]),]
  LM.noflow.half.dec[i,1]<-sum(ifelse(na.omit(LM.Q.half.dec$meandaily_CFS)==0,1,0))
  colnames(LM.noflow.half.dec) <- c("No.Flow.Days")
}
LM.noflow.half.dec$half.decade <- LM.noflow.half.decs
LM.nf.senslope.halfdec <- sens.output(time.step=LM.noflow.half.dec$half.decade,data=LM.noflow.half.dec$No.Flow.Days)
LM.nf.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(data=LM.noflow.half.dec, mapping=aes(x=half.decade, y=No.Flow.Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.nf.senslope.halfdec, aes(slope=slope, intercept=125))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("Number of No-Flow Days")+
  ggtitle("Little Millseat Half Decadal No-Flow Days")

#Yearly
#Calendar Year
LM.zero.flow.year <- unique(LittleMillseat$Year)

LM.yearly.noflow.days<- data.frame("zero.flow"=matrix(nrow=length(LM.years),ncol=1))
for(i in 1:length(unique(LittleMillseat$Year))){
  LM.Q.year<-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
  LM.yearly.noflow.days[i,1]<-sum(ifelse(na.omit(LM.Q.year$meandaily_CFS)==0,1,0))
}
LM.yearly.noflow.days$year <- LM.years
LM.yearly.noflow.days$year <- as.numeric(LM.yearly.noflow.days$year)
LM.yearly.noflow.days <- na.omit(LM.yearly.noflow.days)
LM.nf.senslope.year <- sens.output(time.step=LM.yearly.noflow.days$year,data=LM.yearly.noflow.days$zero.flow)
LM.nf.senslope.year$year <- "Calendar.Year"

ggplot(LM.yearly.noflow.days, aes(factor(year), zero.flow)) +
  geom_bar(stat="identity")+
  geom_abline(data=LM.nf.senslope.year, aes(slope=slope, intercept=30))+
  scale_x_discrete(breaks=c("1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Little Millseat Yearly No-Flow Days")

#Water Year
LM.zero.flow.wateryear <- unique(LittleMillseat$Water_Year)

LM.wateryearly.noflow.days<- data.frame("zero.flow"=matrix(nrow=length(unique(LittleMillseat$Water_Year)),ncol=1))
LM.wateryearly.noflow.days$Water_Year <- unique(LittleMillseat$Water_Year)
for(i in 1:length(unique(LittleMillseat$Water_Year))){
  LM.Q.wateryear<-LittleMillseat[which(LittleMillseat$Water_Year==LM.years[i]),]
  LM.wateryearly.noflow.days[i,1]<-sum(ifelse(na.omit(LM.Q.wateryear$meandaily_CFS)==0,1,0))
}
LM.wateryearly.noflow.days <- na.omit(LM.wateryearly.noflow.days)
LM.nf.senslope.wateryear <- sens.output(time.step=LM.wateryearly.noflow.days$Water_Year,data=LM.wateryearly.noflow.days$zero.flow)
LM.nf.senslope.wateryear$year <- "Water.Year"

ggplot(LM.wateryearly.noflow.days, aes(factor(Water_Year), zero.flow)) +
  geom_bar(stat="identity")+
  geom_abline(data=LM.nf.senslope.wateryear, aes(slope=slope, intercept=30))+
  scale_x_discrete(breaks=c("1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Little Millseat Yearly No-Flow Days Using Water Year")

#Climate Year
LM.zero.flow.climateyear <- unique(LittleMillseat$Climate_Year)

LM.climateyearly.noflow.days<- data.frame("zero.flow"=matrix(nrow=length(unique(LittleMillseat$Climate_Year)),ncol=1))
for(i in 1:length(unique(LittleMillseat$Climate_Year))){
  LM.Q.climateyear<-LittleMillseat[which(LittleMillseat$Climate_Year==LM.years[i]),]
  LM.climateyearly.noflow.days[i,1]<-sum(ifelse(na.omit(LM.Q.climateyear$meandaily_CFS)==0,1,0))
}
LM.climateyearly.noflow.days$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.climateyearly.noflow.days <- na.omit(LM.climateyearly.noflow.days)
LM.nf.senslope.climateyear <- sens.output(time.step=LM.climateyearly.noflow.days$Climate_Year,data=LM.climateyearly.noflow.days$zero.flow)
LM.nf.senslope.climateyear$year <- "Climate.Year"

ggplot(LM.climateyearly.noflow.days, aes(factor(Climate_Year), zero.flow)) +
  geom_bar(stat="identity")+
  geom_abline(data=LM.nf.senslope.climateyear, aes(slope=slope, intercept=30))+
  scale_x_discrete(breaks=c("1985","1995","2005","2015"))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Little Millseat Yearly No-Flow Days Using Climate Year")

#Seasonal
LM.zero.flow.season <- unique(LittleMillseat$season)
LM.seasonal.noflow.days <- data.frame(matrix(nrow=length(LM.zero.flow.year),ncol=length(LM.zero.flow.season)))
LM.seasonal.noflow.days$year <- as.numeric(unique(LittleMillseat$Year))

for(i in 1:length(unique(LittleMillseat$Year))){
  for(j in 1:length(unique(LittleMillseat$season))){
    LM.Q.year <- LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
    LM.Q.season <- LittleMillseat[which(LittleMillseat$season==LM.zero.flow.season[j]),]
  LM.seasonal.noflow.days[i,j]<-sum(ifelse(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.zero.flow.year[i]&LittleMillseat$season==LM.zero.flow.season[j])]==0,1,0))}
  colnames(LM.seasonal.noflow.days) <- c("Winter","Spring","Summer","Autumn","year")
}
LM.seasonal.noflow.days <- na.omit(LM.seasonal.noflow.days)

LM.nf.senslope.winter <- sens.output(time.step=LM.seasonal.noflow.days$year,data=LM.seasonal.noflow.days$Winter)
LM.nf.senslope.spring <- sens.output(time.step=LM.seasonal.noflow.days$year,data=LM.seasonal.noflow.days$Spring)
LM.nf.senslope.summer <- sens.output(time.step=LM.seasonal.noflow.days$year,data=LM.seasonal.noflow.days$Summer)
LM.nf.senslope.autumn <- sens.output(time.step=LM.seasonal.noflow.days$year,data=LM.seasonal.noflow.days$Autumn)
LM.nf.senslope.season <- rbind(LM.nf.senslope.winter,LM.nf.senslope.spring,LM.nf.senslope.summer,LM.nf.senslope.autumn)
LM.nf.senslope.season$season <- c("Winter","Spring","Summer","Autumn")

LM.zeroflow.season.long <- gather(LM.seasonal.noflow.days, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
LM.season <- c("Winter","Spring","Summer","Autumn")

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.NF.jpeg", width=750)
ggplot(LM.zeroflow.season.long, aes(factor(year), value)) +
  geom_bar(stat="identity")+
  geom_abline(data=LM.nf.senslope.season, aes(slope=slope, intercept=15))+
  scale_x_discrete(breaks=c("1975","1985","1995","2005","2015"))+
  facet_wrap(~factor(season))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Little Millseat Seasonal No-Flow Days")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Monthly
LM.zero.flow.month <- unique(LittleMillseat$month)

LM.monthly.noflow.days <- data.frame(matrix(nrow=length(LM.zero.flow.year),ncol=length(LM.zero.flow.month)))
LM.monthly.noflow.days$year <- unique(LittleMillseat$Year)
for(i in 1:length(unique(LittleMillseat$Year))){
  for(j in 1:length(unique(LittleMillseat$month))){
    LM.Q.year <- LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
    LM.Q.month <- LittleMillseat[which(LittleMillseat$month==LM.zero.flow.month[j]),]
  LM.monthly.noflow.days[i,j]<-sum(ifelse(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.zero.flow.year[i]&LittleMillseat$month==LM.zero.flow.month[j])]==0,1,0))}
}
colnames(LM.monthly.noflow.days) <- c("January", "February", "March", "April", "May", "June","July","August","September","October", "November", "December","year")

LM.monthly.noflow.days <- na.omit(LM.monthly.noflow.days)

LM.nf.senslope.jan <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$January)
LM.nf.senslope.feb <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$February)
LM.nf.senslope.mar <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$March)
LM.nf.senslope.apr <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$April)
LM.nf.senslope.may <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$May)
LM.nf.senslope.jun <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$June)
LM.nf.senslope.jul <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$July)
LM.nf.senslope.aug <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$August)
LM.nf.senslope.sep <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$September)
LM.nf.senslope.oct <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$October)
LM.nf.senslope.nov <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$November)
LM.nf.senslope.dec <- sens.output(time.step=LM.monthly.noflow.days$year,data=LM.monthly.noflow.days$December)
LM.nf.senslope.month <- rbind(LM.nf.senslope.jan,LM.nf.senslope.feb,LM.nf.senslope.mar,LM.nf.senslope.apr,LM.nf.senslope.may,LM.nf.senslope.jun,LM.nf.senslope.jul,LM.nf.senslope.aug,LM.nf.senslope.sep,LM.nf.senslope.oct,LM.nf.senslope.nov,LM.nf.senslope.dec)
LM.nf.senslope.month$Month <- unique(LittleMillseat$Month)

LM.zeroflow.month.long <- gather(LM.monthly.noflow.days, key="Month", value="value", c("July", "August","September","October","November","December","January","February","March","April","May","June"))
LM.zeroflow.month.long <- na.omit(LM.zeroflow.month.long)

ggplot(LM.zeroflow.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=LM.nf.senslope.month, aes(slope=slope, intercept=5))+
  xlim(1980,2008)+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Number of No-Flow Days")+
  ggtitle("Little Millseat Monthly No-Flow Days")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

```
### Section 4.1.1: No Flow Days Statistical Summary
```{r}
LM.NFD.statistical.summary <- rbind.fill(LM.nf.senslope.halfdec,LM.nf.senslope.year,LM.nf.senslope.wateryear,LM.nf.senslope.climateyear,LM.nf.senslope.season,LM.nf.senslope.month)
```

## Section 4.2: Flows <Q90
```{r}
#Timeseries
LM.Rank.flow.min <- data.frame("sort.data"=sort(LittleMillseat$mindaily_CFS,decreasing = TRUE))
#sorting the data in decreasing order
LM.Rank.flow.min$rank <- 1:length(LM.Rank.flow.min$sort.data)
#adding a rank to the flows in the data frame
LM.Rank.flow.min$probability <- ((LM.Rank.flow.min$rank)/(length(LM.Rank.flow.min$rank)))*100
# adding the probability of the flows
LM.Flow.ninety <- LM.Rank.flow.min$sort.data[which.min(abs(LM.Rank.flow.min$probability-90))]#ranking the data and taking out the data <90% discharge
LM.ten.percent.flow <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
#making a new data frame with the <90% data
LM.percent.below.ten <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
for(i in 1:length(unique(LittleMillseat$Year))){
LM.Q.year<-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
LM.ten.percent.flow[i]<-sum(ifelse(na.omit(LM.Q.year$mindaily_CFS)<=LM.Flow.ninety,1,0))
#Dentoing which flows are <90%
LM.percent.below.ten[i]<-(LM.ten.percent.flow[i]/length(na.omit(LM.Q.year$mindaily_CFS)))*100
}
# establishing the discharge where only 10% of flow exceeds that rate
LM.ten.percent.flow <- data.frame("ten.percent"=LM.ten.percent.flow,"year"=unique(LittleMillseat$Year))
# creating a matrix to report the 5% exceeded values

#Half-Decadal
LM.days.exceeding.ninety.decade <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
colnames(LM.days.exceeding.ninety.decade) <- "Number_Days"
rownames(LM.days.exceeding.ninety.decade) <- LM.half.decades

for (i in 1:length(LM.half.decades)) {
    
    LM.subset.decades <- LittleMillseat[which(LittleMillseat$half.decade==LM.half.decades[i]),]
    
    LM.days.exceeding.ninety.decade[i,1] <- sum(ifelse(na.omit(LM.subset.decades$mindaily_CFS)<=LM.Flow.ninety,1,0))
}
LM.days.exceeding.ninety.decade$halfdec <- LM.half.decades

LM.ninety.senslope.halfdec <- sens.output(time.step=LM.days.exceeding.ninety.decade$halfdec,data=LM.days.exceeding.ninety.decade$Number_Days)
LM.ninety.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
LM.days.exceeding.ninety.year <- data.frame(matrix(nrow=length(LM.years),ncol=1))
colnames(LM.days.exceeding.ninety.year) <- "Number_Days"

for (i in 1:length(LM.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
    LM.days.exceeding.ninety.year[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)<=LM.Flow.ninety,1,0))
}
LM.days.exceeding.ninety.year$year <- as.numeric(LM.years)
LM.ninety.senslope.year <- sens.output(time.step=LM.days.exceeding.ninety.year$year,data=LM.days.exceeding.ninety.year$Number_Days)
LM.ninety.senslope.year$year <- "Calendar.Year"

#Water Year
LM.water.years <- unique(LittleMillseat$Water_Year)
LM.days.exceeding.ninety.water.year <- data.frame(matrix(nrow=length(LM.water.years),ncol=1))
colnames(LM.days.exceeding.ninety.water.year) <- "Number_Days"

for (i in 1:length(LM.water.years)) {
    LM.subset.water.years <- LittleMillseat[which(LittleMillseat$Water_Year==LM.water.years[i]),]
    LM.days.exceeding.ninety.water.year[i,1] <- sum(ifelse(na.omit(LM.subset.water.years$mindaily_CFS)<=LM.Flow.ninety,1,0))
}
LM.days.exceeding.ninety.water.year$year <- LM.water.years
LM.ninety.senslope.water.year <- sens.output(time.step=LM.days.exceeding.ninety.water.year$year,data=LM.days.exceeding.ninety.water.year$Number_Days)
LM.ninety.senslope.water.year$year <- "Water.Year"

#Climate Year
LM.climate.years <- unique(LittleMillseat$Climate_Year)
LM.days.exceeding.ninety.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1))
colnames(LM.days.exceeding.ninety.climateyear) <- "Number_Days"

for (i in 1:length(LM.climate.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Climate_Year==LM.climate.years[i]),]
    LM.days.exceeding.ninety.climateyear[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)<=LM.Flow.ninety,1,0))
}
LM.days.exceeding.ninety.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.ninety.senslope.climateyear <- sens.output(time.step=LM.days.exceeding.ninety.climateyear$Climate_Year,data=LM.days.exceeding.ninety.climateyear$Number_Days)
LM.ninety.senslope.climateyear$year <- "Climate.Year"

#Seasonal
LM.days.exceeding.ninety.season <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$season))))
colnames(LM.days.exceeding.ninety.season) <- c("Winter","Spring","Summer","Autumn")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.seasons)){
    LM.days.exceeding.ninety.season[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.seasons[j])]<=Flow.ninety,1,0))
    }
}

LM.days.exceeding.ninety.season$year <- LM.years
LM.days.exceeding.ninety.season <- na.omit(LM.days.exceeding.ninety.season)

LM.ninety.senslope.winter <- sens.output(time.step=LM.days.exceeding.ninety.season$year,data=LM.days.exceeding.ninety.season$Winter)
LM.ninety.senslope.spring <- sens.output(time.step=LM.days.exceeding.ninety.season$year,data=LM.days.exceeding.ninety.season$Spring)
LM.ninety.senslope.summer <- sens.output(time.step=LM.days.exceeding.ninety.season$year,data=LM.days.exceeding.ninety.season$Summer)
LM.ninety.senslope.autumn <- sens.output(time.step=LM.days.exceeding.ninety.season$year,data=LM.days.exceeding.ninety.season$Autumn)
LM.ninety.senslope.season <- rbind(LM.ninety.senslope.winter,LM.ninety.senslope.spring,LM.ninety.senslope.summer,LM.ninety.senslope.autumn)
LM.ninety.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
LM.days.exceeding.ninety.month <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$month))))
colnames(LM.days.exceeding.ninety.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.months)){
    LM.days.exceeding.ninety.month[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[j])]<=LM.Flow.ninety,1,0))
    }
}
LM.days.exceeding.ninety.month$year <- LM.years
LM.days.exceeding.ninety.month <- na.omit(LM.days.exceeding.ninety.month)

LM.ninety.senslope.jan <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$January)
LM.ninety.senslope.feb <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$February)
LM.ninety.senslope.mar <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$March)
LM.ninety.senslope.apr <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$April)
LM.ninety.senslope.may <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$May)
LM.ninety.senslope.jun <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$June)
LM.ninety.senslope.jul <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$July)
LM.ninety.senslope.aug <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$August)
LM.ninety.senslope.sep <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$September)
LM.ninety.senslope.oct <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$October)
LM.ninety.senslope.nov <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$November)
LM.ninety.senslope.dec <- sens.output(time.step=LM.days.exceeding.ninety.month$year,data=LM.days.exceeding.ninety.month$December)
LM.ninety.senslope.month <- rbind(LM.ninety.senslope.jan,LM.ninety.senslope.feb,LM.ninety.senslope.mar,LM.ninety.senslope.apr,LM.ninety.senslope.may,LM.ninety.senslope.jun,LM.ninety.senslope.jul,LM.ninety.senslope.aug,LM.ninety.senslope.sep,LM.ninety.senslope.oct,LM.ninety.senslope.nov,LM.ninety.senslope.dec)
LM.ninety.senslope.month$Month <- unique(LittleMillseat$Month)

```

### Section 4.2.1: Flows <Q90 Plot
```{r}
#Half-Decadal
ggplot(data=LM.days.exceeding.ninety.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.ninety.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Little Millseat Half-Decadal Days With Flow Less Than Q90")

#yearly
ggplot(data=LM.days.exceeding.ninety.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.ninety.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q90")

ggplot(data=LM.days.exceeding.ninety.water.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.ninety.senslope.water.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q90 Using Water Year")

ggplot(data=LM.days.exceeding.ninety.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.ninety.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q90 Using Climate Year")
#seasonal
LM.days.exceeding.ninety.season.long <- gather(LM.days.exceeding.ninety.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
LM.days.exceeding.ninety.season.long <- na.omit(LM.days.exceeding.ninety.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM90.cal.jpeg", width=750)
ggplot(LM.days.exceeding.ninety.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=LM.ninety.senslope.season, aes(slope=slope, intercept=10))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Little Millseat Seasonal Days With Flow Less Than Q90")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
LM.days.exceeding.ninety.month.long <- gather(LM.days.exceeding.ninety.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
LM.days.exceeding.ninety.month.long <- na.omit(LM.days.exceeding.ninety.month.long)

ggplot(LM.days.exceeding.ninety.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=LM.ninety.senslope.month, aes(slope=slope, intercept=5))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q90")+
  ggtitle("Little Millseat Monthly Days With Flow Less Than Q90")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

### Section 4.2.2: Flows <Q90 Statistical Summary
```{r}
LM.ninety.statistical.summary <- rbind.fill(LM.ninety.senslope.halfdec,LM.ninety.senslope.year,LM.ninety.senslope.wateryear,LM.ninety.senslope.climateyear,LM.ninety.senslope.season,LM.ninety.senslope.month)
```

## Section 4.3: Flows <Q75
```{r}
LM.Flow.seventy.five <- LM.Rank.flow.min$sort.data[which.min(abs(LM.Rank.flow.min$probability-75))]#ranking the data and taking out the data <90% discharge
LM.twenty.five.percent.flow <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
#making a new data frame with the <90% data
LM.percent.below.twenty.five <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
for(i in 1:length(unique(LittleMillseat$Year))){
LM.Q.year<-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
LM.twenty.five.percent.flow[i]<-sum(ifelse(na.omit(LM.Q.year$mindaily_CFS)<=LM.Flow.seventy.five,1,0))
#Dentoing which flows are <90%
LM.percent.below.twenty.five[i]<-(LM.twenty.five.percent.flow[i]/length(na.omit(LM.Q.year$mindaily_CFS)))*100
}
# establishing the discharge where only 10% of flow exceeds that rate
LM.twenty.five.percent.flow <- data.frame("twenty.five.percent"=LM.twenty.five.percent.flow,"year"=unique(LittleMillseat$Year))
# creating a matrix to report the 5% exceeded values

#Half-Decadal
LM.days.exceeding.seventy.five.decade <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
colnames(LM.days.exceeding.seventy.five.decade) <- "Number_Days"
rownames(LM.days.exceeding.seventy.five.decade) <- LM.half.decades

for (i in 1:length(LM.half.decades)) {
    
    LM.subset.decades <- LittleMillseat[which(LittleMillseat$half.decade==LM.half.decades[i]),]
    
    LM.days.exceeding.seventy.five.decade[i,1] <- sum(ifelse(na.omit(LM.subset.decades$mindaily_CFS)<=LM.Flow.seventy.five,1,0))
}
LM.days.exceeding.seventy.five.decade$halfdec <- LM.half.decades

LM.seventy.five.senslope.halfdec <- sens.output(time.step=LM.days.exceeding.seventy.five.decade$halfdec,data=LM.days.exceeding.seventy.five.decade$Number_Days)
LM.seventy.five.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
LM.days.exceeding.seventy.five.year <- data.frame(matrix(nrow=length(LM.years),ncol=1))
colnames(LM.days.exceeding.seventy.five.year) <- "Number_Days"

for (i in 1:length(LM.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
    LM.days.exceeding.seventy.five.year[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)<=LM.Flow.seventy.five,1,0))
}
LM.days.exceeding.seventy.five.year$year <- as.numeric(LM.years)
LM.seventy.five.senslope.year <- sens.output(time.step=LM.days.exceeding.seventy.five.year$year,data=LM.days.exceeding.seventy.five.year$Number_Days)
LM.seventy.five.senslope.year$year <- "Calendar.Year"

#Water Year
LM.days.exceeding.seventy.five.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1))
colnames(LM.days.exceeding.seventy.five.wateryear) <- "Number_Days"

for (i in 1:length(LM.water.years)) {
    LM.subset.wateryears <- LittleMillseat[which(LittleMillseat$Water_Year==LM.water.years[i]),]
    LM.days.exceeding.seventy.five.wateryear[i,1] <- sum(ifelse(na.omit(LM.subset.wateryears$mindaily_CFS)<=LM.Flow.seventy.five,1,0))
}
LM.days.exceeding.seventy.five.wateryear$Water_Year <- unique(LittleMillseat$Water_Year)
LM.seventy.five.senslope.wateryear <- sens.output(time.step=LM.days.exceeding.seventy.five.wateryear$Water_Year,data=LM.days.exceeding.seventy.five.wateryear$Number_Days)
LM.seventy.five.senslope.wateryear$year <- "Water.Year"

#Climate Year
LM.days.exceeding.seventy.five.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1))
colnames(LM.days.exceeding.seventy.five.climateyear) <- "Number_Days"

for (i in 1:length(LM.climate.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Climate_Year==LM.climate.years[i]),]
    LM.days.exceeding.seventy.five.climateyear[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)<=LM.Flow.seventy.five,1,0))
}
LM.days.exceeding.seventy.five.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.seventy.five.senslope.climateyear <- sens.output(time.step=LM.days.exceeding.seventy.five.climateyear$Climate_Year,data=LM.days.exceeding.seventy.five.climateyear$Number_Days)
LM.seventy.five.senslope.climateyear$year <- "Climate.Year"

#Seasonal
LM.days.exceeding.seventy.five.season <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$season))))
colnames(LM.days.exceeding.seventy.five.season) <- c("Winter","Spring","Summer","Autumn")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.seasons)){
    LM.days.exceeding.seventy.five.season[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.seasons[j])]<=Flow.seventy.five,1,0))
    }
}

LM.days.exceeding.seventy.five.season$year <- LM.years
LM.days.exceeding.seventy.five.season <- na.omit(LM.days.exceeding.seventy.five.season)

LM.seventy.five.senslope.winter <- sens.output(time.step=LM.days.exceeding.seventy.five.season$year,data=LM.days.exceeding.seventy.five.season$Winter)
LM.seventy.five.senslope.spring <- sens.output(time.step=LM.days.exceeding.seventy.five.season$year,data=LM.days.exceeding.seventy.five.season$Spring)
LM.seventy.five.senslope.summer <- sens.output(time.step=LM.days.exceeding.seventy.five.season$year,data=LM.days.exceeding.seventy.five.season$Summer)
LM.seventy.five.senslope.autumn <- sens.output(time.step=LM.days.exceeding.seventy.five.season$year,data=LM.days.exceeding.seventy.five.season$Autumn)
LM.seventy.five.senslope.season <- rbind(LM.seventy.five.senslope.winter,LM.seventy.five.senslope.spring,LM.seventy.five.senslope.summer,LM.seventy.five.senslope.autumn)
LM.seventy.five.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
LM.days.exceeding.seventy.five.month <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$month))))
colnames(LM.days.exceeding.seventy.five.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.months)){
    LM.days.exceeding.seventy.five.month[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[j])]<=LM.Flow.seventy.five,1,0))
    }
}
LM.days.exceeding.seventy.five.month$year <- LM.years
LM.days.exceeding.seventy.five.month <- na.omit(LM.days.exceeding.seventy.five.month)

LM.seventy.five.senslope.jan <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$January)
LM.seventy.five.senslope.feb <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$February)
LM.seventy.five.senslope.mar <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$March)
LM.seventy.five.senslope.apr <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$April)
LM.seventy.five.senslope.may <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$May)
LM.seventy.five.senslope.jun <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$June)
LM.seventy.five.senslope.jul <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$July)
LM.seventy.five.senslope.aug <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$August)
LM.seventy.five.senslope.sep <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$September)
LM.seventy.five.senslope.oct <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$October)
LM.seventy.five.senslope.nov <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$November)
LM.seventy.five.senslope.dec <- sens.output(time.step=LM.days.exceeding.seventy.five.month$year,data=LM.days.exceeding.seventy.five.month$December)
LM.seventy.five.senslope.month <- rbind(LM.seventy.five.senslope.jan,LM.seventy.five.senslope.feb,LM.seventy.five.senslope.mar,LM.seventy.five.senslope.apr,LM.seventy.five.senslope.may,LM.seventy.five.senslope.jun,LM.seventy.five.senslope.jul,LM.seventy.five.senslope.aug,LM.seventy.five.senslope.sep,LM.seventy.five.senslope.oct,LM.seventy.five.senslope.nov,LM.seventy.five.senslope.dec)
LM.seventy.five.senslope.month$Month <- unique(LittleMillseat$Month)

```

### Section 4.3.1: Flows <Q75 Plot
```{r}
#Half-Decadal
ggplot(data=LM.days.exceeding.seventy.five.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.seventy.five.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Little Millseat Half-Decadal Days With Flow Less Than Q75")

#yearly
ggplot(data=LM.days.exceeding.seventy.five.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.seventy.five.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q75")

ggplot(data=LM.days.exceeding.seventy.five.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.seventy.five.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q75 Using Water Year")

ggplot(data=LM.days.exceeding.seventy.five.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.seventy.five.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q75 Using Climate Year")
#seasonal
LM.days.exceeding.seventy.five.season.long <- gather(LM.days.exceeding.seventy.five.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
LM.days.exceeding.seventy.five.season.long <- na.omit(LM.days.exceeding.seventy.five.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM75.cal.jpeg", width=750)
ggplot(LM.days.exceeding.seventy.five.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=LM.seventy.five.senslope.season, aes(slope=slope, intercept=10))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Little Millseat Seasonal Days With Flow Less Than Q75")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
LM.days.exceeding.seventy.five.month.long <- gather(LM.days.exceeding.seventy.five.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
LM.days.exceeding.seventy.five.month.long <- na.omit(LM.days.exceeding.seventy.five.month.long)

ggplot(LM.days.exceeding.seventy.five.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=LM.seventy.five.senslope.month, aes(slope=slope, intercept=5))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q75")+
  ggtitle("Little Millseat Monthly Days With Flow Less Than Q75")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```
### Section 4.3.2: Flows <Q75 Statistical Summary
```{r}
LM.seventyfive.statistical.summary <- rbind.fill(LM.seventy.five.senslope.halfdec,LM.seventy.five.senslope.year,LM.seventy.five.senslope.wateryear,LM.seventy.five.senslope.climateyear,LM.seventy.five.senslope.season,LM.seventy.five.senslope.month)
```

## Section 4.4: Flows <Q50
```{r}
LM.Flow.fifty <- LM.Rank.flow.min$sort.data[which.min(abs(LM.Rank.flow.min$probability-50))]#ranking the data and taking out the data <90% discharge
LM.fifty.percent.flow <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
#making a new data frame with the <90% data
LM.percent.below.fifty <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
for(i in 1:length(unique(LittleMillseat$Year))){
LM.Q.year<-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
LM.fifty.percent.flow[i]<-sum(ifelse(na.omit(LM.Q.year$mindaily_CFS)<=LM.Flow.fifty,1,0))
#Dentoing which flows are <90%
LM.percent.below.fifty[i]<-(LM.fifty.percent.flow[i]/length(na.omit(LM.Q.year$mindaily_CFS)))*100
}
# establishing the discharge where only 10% of flow exceeds that rate
LM.fifty.percent.flow <- data.frame("fifty.percent"=LM.fifty.percent.flow,"year"=unique(LittleMillseat$Year))
# creating a matrix to report the 5% exceeded values

#Half-Decadal
LM.days.exceeding.fifty.decade <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
colnames(LM.days.exceeding.fifty.decade) <- "Number_Days"
rownames(LM.days.exceeding.fifty.decade) <- LM.half.decades

for (i in 1:length(LM.half.decades)) {
    
    LM.subset.decades <- LittleMillseat[which(LittleMillseat$half.decade==LM.half.decades[i]),]
    
    LM.days.exceeding.fifty.decade[i,1] <- sum(ifelse(na.omit(LM.subset.decades$mindaily_CFS)<=LM.Flow.fifty,1,0))
}
LM.days.exceeding.fifty.decade$halfdec <- LM.half.decades

LM.fifty.senslope.halfdec <- sens.output(time.step=LM.days.exceeding.fifty.decade$halfdec,data=LM.days.exceeding.fifty.decade$Number_Days)
LM.fifty.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
LM.days.exceeding.fifty.year <- data.frame(matrix(nrow=length(LM.years),ncol=1))
colnames(LM.days.exceeding.fifty.year) <- "Number_Days"

for (i in 1:length(LM.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
    LM.days.exceeding.fifty.year[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)<=LM.Flow.fifty,1,0))
}
LM.days.exceeding.fifty.year$year <- as.numeric(LM.years)
LM.fifty.senslope.year <- sens.output(time.step=LM.days.exceeding.fifty.year$year,data=LM.days.exceeding.fifty.year$Number_Days)
LM.fifty.senslope.year$year <- "Calendar.Year"

#Water Year
LM.days.exceeding.fifty.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1))
colnames(LM.days.exceeding.fifty.wateryear) <- "Number_Days"

for (i in 1:length(LM.water.years)) {
    LM.subset.wateryears <- LittleMillseat[which(LittleMillseat$Water_Year==LM.water.years[i]),]
    LM.days.exceeding.fifty.wateryear[i,1] <- sum(ifelse(na.omit(LM.subset.wateryears$mindaily_CFS)<=LM.Flow.fifty,1,0))
}
LM.days.exceeding.fifty.wateryear$Water_Year <- unique(LittleMillseat$Water_Year)
LM.fifty.senslope.wateryear <- sens.output(time.step=LM.days.exceeding.fifty.wateryear$Water_Year,data=LM.days.exceeding.fifty.wateryear$Number_Days)
LM.fifty.senslope.wateryear$year <- "Water.Year"

#Climate Year
LM.days.exceeding.fifty.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1))
colnames(LM.days.exceeding.fifty.climateyear) <- "Number_Days"

for (i in 1:length(LM.climate.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Climate_Year==LM.climate.years[i]),]
    LM.days.exceeding.fifty.climateyear[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)<=LM.Flow.fifty,1,0))
}
LM.days.exceeding.fifty.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.fifty.senslope.climateyear <- sens.output(time.step=LM.days.exceeding.fifty.climateyear$Climate_Year,data=LM.days.exceeding.fifty.climateyear$Number_Days)
LM.fifty.senslope.climateyear$year <- "Climate.Year"

#Seasonal
LM.days.exceeding.fifty.season <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$season))))
colnames(LM.days.exceeding.fifty.season) <- c("Winter","Spring","Summer","Autumn")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.seasons)){
    LM.days.exceeding.fifty.season[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.seasons[j])]<=Flow.fifty,1,0))
    }
}

LM.days.exceeding.fifty.season$year <- LM.years
LM.days.exceeding.fifty.season <- na.omit(LM.days.exceeding.fifty.season)

LM.fifty.senslope.winter <- sens.output(time.step=LM.days.exceeding.fifty.season$year,data=LM.days.exceeding.fifty.season$Winter)
LM.fifty.senslope.spring <- sens.output(time.step=LM.days.exceeding.fifty.season$year,data=LM.days.exceeding.fifty.season$Spring)
LM.fifty.senslope.summer <- sens.output(time.step=LM.days.exceeding.fifty.season$year,data=LM.days.exceeding.fifty.season$Summer)
LM.fifty.senslope.autumn <- sens.output(time.step=LM.days.exceeding.fifty.season$year,data=LM.days.exceeding.fifty.season$Autumn)
LM.fifty.senslope.season <- rbind(LM.fifty.senslope.winter,LM.fifty.senslope.spring,LM.fifty.senslope.summer,LM.fifty.senslope.autumn)
LM.fifty.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
LM.days.exceeding.fifty.month <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$month))))
colnames(LM.days.exceeding.fifty.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.months)){
    LM.days.exceeding.fifty.month[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[j])]<=LM.Flow.fifty,1,0))
    }
}
LM.days.exceeding.fifty.month$year <- LM.years
LM.days.exceeding.fifty.month <- na.omit(LM.days.exceeding.fifty.month)

LM.fifty.senslope.jan <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$January)
LM.fifty.senslope.feb <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$February)
LM.fifty.senslope.mar <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$March)
LM.fifty.senslope.apr <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$April)
LM.fifty.senslope.may <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$May)
LM.fifty.senslope.jun <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$June)
LM.fifty.senslope.jul <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$July)
LM.fifty.senslope.aug <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$August)
LM.fifty.senslope.sep <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$September)
LM.fifty.senslope.oct <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$October)
LM.fifty.senslope.nov <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$November)
LM.fifty.senslope.dec <- sens.output(time.step=LM.days.exceeding.fifty.month$year,data=LM.days.exceeding.fifty.month$December)
LM.fifty.senslope.month <- rbind(LM.fifty.senslope.jan,LM.fifty.senslope.feb,LM.fifty.senslope.mar,LM.fifty.senslope.apr,LM.fifty.senslope.may,LM.fifty.senslope.jun,LM.fifty.senslope.jul,LM.fifty.senslope.aug,LM.fifty.senslope.sep,LM.fifty.senslope.oct,LM.fifty.senslope.nov,LM.fifty.senslope.dec)
LM.fifty.senslope.month$Month <- unique(LittleMillseat$Month)

```

### Section 4.4.1: Flows <Q50 Plot
```{r}
#Half-Decadal
ggplot(data=LM.days.exceeding.fifty.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.fifty.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Little Millseat Half-Decadal Days With Flow Less Than Q50")

#yearly
ggplot(data=LM.days.exceeding.fifty.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.fifty.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q50")

ggplot(data=LM.days.exceeding.fifty.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.fifty.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q50 Using Water Year")

ggplot(data=LM.days.exceeding.fifty.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.fifty.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Little Millseat Yearly Days With Flow Less Than Q50 Using Climate Year")
#seasonal
LM.days.exceeding.fifty.season.long <- gather(LM.days.exceeding.fifty.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
LM.days.exceeding.fifty.season.long <- na.omit(LM.days.exceeding.fifty.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM50.cal.jpeg", width=750)
ggplot(LM.days.exceeding.fifty.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=LM.fifty.senslope.season, aes(slope=slope, intercept=10))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Little Millseat Seasonal Days With Flow Less Than Q50")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
LM.days.exceeding.fifty.month.long <- gather(LM.days.exceeding.fifty.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
LM.days.exceeding.fifty.month.long <- na.omit(LM.days.exceeding.fifty.month.long)

ggplot(LM.days.exceeding.fifty.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=LM.fifty.senslope.month, aes(slope=slope, intercept=5))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Less Than Q50")+
  ggtitle("Little Millseat Monthly Days With Flow Less Than Q50")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```
### Section 4.4.2: Flows <Q50 Statistical Summary
```{r}
LM.fifty.statistical.summary <- rbind.fill(LM.fifty.senslope.halfdec,LM.fifty.senslope.year,LM.fifty.senslope.wateryear,LM.fifty.senslope.climateyear,LM.fifty.senslope.season,LM.fifty.senslope.month)
```

## Section 4.5: Flows >Q25
```{r}
LM.Flow.twenty.five <- LM.Rank.flow.min$sort.data[which.min(abs(LM.Rank.flow.min$probability-25))]#ranking the data and taking out the data <90% discharge
LM.seventy.five.percent.flow <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
#making a new data frame with the <90% data
LM.percent.below.seventy.five <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
for(i in 1:length(unique(LittleMillseat$Year))){
LM.Q.year<-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
LM.seventy.five.percent.flow[i]<-sum(ifelse(na.omit(LM.Q.year$mindaily_CFS)>=LM.Flow.twenty.five,1,0))
#Dentoing which flows are <90%
LM.percent.below.seventy.five[i]<-(LM.seventy.five.percent.flow[i]/length(na.omit(LM.Q.year$mindaily_CFS)))*100
}
# establishing the discharge where only 10% of flow exceeds that rate
LM.seventy.five.percent.flow <- data.frame("seventy.five.percent"=LM.seventy.five.percent.flow,"year"=unique(LittleMillseat$Year))
# creating a matrix to report the 5% exceeded values

#Half-Decadal
LM.days.exceeding.twenty.five.decade <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
colnames(LM.days.exceeding.twenty.five.decade) <- "Number_Days"
rownames(LM.days.exceeding.twenty.five.decade) <- LM.half.decades

for (i in 1:length(LM.half.decades)) {
    
    LM.subset.decades <- LittleMillseat[which(LittleMillseat$half.decade==LM.half.decades[i]),]
    
    LM.days.exceeding.twenty.five.decade[i,1] <- sum(ifelse(na.omit(LM.subset.decades$mindaily_CFS)>=LM.Flow.twenty.five,1,0))
}
LM.days.exceeding.twenty.five.decade$halfdec <- LM.half.decades

LM.twenty.five.senslope.halfdec <- sens.output(time.step=LM.days.exceeding.twenty.five.decade$halfdec,data=LM.days.exceeding.twenty.five.decade$Number_Days)
LM.twenty.five.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
LM.days.exceeding.twenty.five.year <- data.frame(matrix(nrow=length(LM.years),ncol=1))
colnames(LM.days.exceeding.twenty.five.year) <- "Number_Days"

for (i in 1:length(LM.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
    LM.days.exceeding.twenty.five.year[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)>=LM.Flow.twenty.five,1,0))
}
LM.days.exceeding.twenty.five.year$year <- as.numeric(LM.years)
LM.twenty.five.senslope.year <- sens.output(time.step=LM.days.exceeding.twenty.five.year$year,data=LM.days.exceeding.twenty.five.year$Number_Days)
LM.twenty.five.senslope.year$year <- "Calendar.Year"

#Water Year
LM.days.exceeding.twenty.five.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1))
colnames(LM.days.exceeding.twenty.five.wateryear) <- "Number_Days"

for (i in 1:length(LM.water.years)) {
    LM.subset.wateryears <- LittleMillseat[which(LittleMillseat$Water_Year==LM.water.years[i]),]
    LM.days.exceeding.twenty.five.wateryear[i,1] <- sum(ifelse(na.omit(LM.subset.wateryears$mindaily_CFS)>=LM.Flow.twenty.five,1,0))
}
LM.days.exceeding.twenty.five.wateryear$Water_Year <- unique(LittleMillseat$Water_Year)
LM.twenty.five.senslope.wateryear <- sens.output(time.step=LM.days.exceeding.twenty.five.wateryear$Water_Year,data=LM.days.exceeding.twenty.five.wateryear$Number_Days)
LM.twenty.five.senslope.wateryear$year <- "Water.Year"

#Climate Year
LM.days.exceeding.twenty.five.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1))
colnames(LM.days.exceeding.twenty.five.climateyear) <- "Number_Days"

for (i in 1:length(LM.climate.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Climate_Year==LM.climate.years[i]),]
    LM.days.exceeding.twenty.five.climateyear[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)>=LM.Flow.twenty.five,1,0))
}
LM.days.exceeding.twenty.five.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.twenty.five.senslope.climateyear <- sens.output(time.step=LM.days.exceeding.twenty.five.climateyear$Climate_Year,data=LM.days.exceeding.twenty.five.climateyear$Number_Days)
LM.twenty.five.senslope.climateyear$year <- "Climate.Year"

#Seasonal
LM.days.exceeding.twenty.five.season <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$season))))
colnames(LM.days.exceeding.twenty.five.season) <- c("Winter","Spring","Summer","Autumn")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.seasons)){
    LM.days.exceeding.twenty.five.season[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.seasons[j])]>=Flow.twenty.five,1,0))
    }
}

LM.days.exceeding.twenty.five.season$year <- LM.years
LM.days.exceeding.twenty.five.season <- na.omit(LM.days.exceeding.twenty.five.season)

LM.twenty.five.senslope.winter <- sens.output(time.step=LM.days.exceeding.twenty.five.season$year,data=LM.days.exceeding.twenty.five.season$Winter)
LM.twenty.five.senslope.spring <- sens.output(time.step=LM.days.exceeding.twenty.five.season$year,data=LM.days.exceeding.twenty.five.season$Spring)
LM.twenty.five.senslope.summer <- sens.output(time.step=LM.days.exceeding.twenty.five.season$year,data=LM.days.exceeding.twenty.five.season$Summer)
LM.twenty.five.senslope.autumn <- sens.output(time.step=LM.days.exceeding.twenty.five.season$year,data=LM.days.exceeding.twenty.five.season$Autumn)
LM.twenty.five.senslope.season <- rbind(LM.twenty.five.senslope.winter,LM.twenty.five.senslope.spring,LM.twenty.five.senslope.summer,LM.twenty.five.senslope.autumn)
LM.twenty.five.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
LM.days.exceeding.twenty.five.month <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$month))))
colnames(LM.days.exceeding.twenty.five.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.months)){
    LM.days.exceeding.twenty.five.month[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[j])]>=LM.Flow.twenty.five,1,0))
    }
}
LM.days.exceeding.twenty.five.month$year <- LM.years
LM.days.exceeding.twenty.five.month <- na.omit(LM.days.exceeding.twenty.five.month)

LM.twenty.five.senslope.jan <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$January)
LM.twenty.five.senslope.feb <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$February)
LM.twenty.five.senslope.mar <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$March)
LM.twenty.five.senslope.apr <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$April)
LM.twenty.five.senslope.may <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$May)
LM.twenty.five.senslope.jun <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$June)
LM.twenty.five.senslope.jul <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$July)
LM.twenty.five.senslope.aug <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$August)
LM.twenty.five.senslope.sep <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$September)
LM.twenty.five.senslope.oct <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$October)
LM.twenty.five.senslope.nov <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$November)
LM.twenty.five.senslope.dec <- sens.output(time.step=LM.days.exceeding.twenty.five.month$year,data=LM.days.exceeding.twenty.five.month$December)
LM.twenty.five.senslope.month <- rbind(LM.twenty.five.senslope.jan,LM.twenty.five.senslope.feb,LM.twenty.five.senslope.mar,LM.twenty.five.senslope.apr,LM.twenty.five.senslope.may,LM.twenty.five.senslope.jun,LM.twenty.five.senslope.jul,LM.twenty.five.senslope.aug,LM.twenty.five.senslope.sep,LM.twenty.five.senslope.oct,LM.twenty.five.senslope.nov,LM.twenty.five.senslope.dec)
LM.twenty.five.senslope.month$Month <- unique(LittleMillseat$Month)

```

### Section 4.5.1: Flows >Q25 Plot
```{r}
#Half-Decadal
ggplot(data=LM.days.exceeding.twenty.five.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.twenty.five.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Little Millseat Half-Decadal Days With Flow Exceeding Q25")

#yearly
ggplot(data=LM.days.exceeding.twenty.five.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.twenty.five.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q25")

ggplot(data=LM.days.exceeding.twenty.five.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.twenty.five.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q25 Using Water Year")

ggplot(data=LM.days.exceeding.twenty.five.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.twenty.five.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q25 Using Climate Year")
#seasonal
LM.days.exceeding.twenty.five.season.long <- gather(LM.days.exceeding.twenty.five.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
LM.days.exceeding.twenty.five.season.long <- na.omit(LM.days.exceeding.twenty.five.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM25.cal.jpeg", width=750)
ggplot(LM.days.exceeding.twenty.five.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=LM.twenty.five.senslope.season, aes(slope=slope, intercept=15))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Little Millseat Seasonal Days With Flow Exceeding Q25")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
LM.days.exceeding.twenty.five.month.long <- gather(LM.days.exceeding.twenty.five.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
LM.days.exceeding.twenty.five.month.long <- na.omit(LM.days.exceeding.twenty.five.month.long)

ggplot(LM.days.exceeding.twenty.five.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=LM.twenty.five.senslope.month, aes(slope=slope, intercept=10))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q25")+
  ggtitle("Little Millseat Monthly Days With Flow Exceeding Q25")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```
### Section 4.5.2: Flows >Q25 Statistical Summary
```{r}
LM.twenty.five.statistical.summary <- rbind.fill(LM.twenty.five.senslope.halfdec,LM.twenty.five.senslope.year,LM.twenty.five.senslope.wateryear,LM.twenty.five.senslope.climateyear,LM.twenty.five.senslope.season,LM.twenty.five.senslope.month)
```

## Section 4.6: Flows >Q5
```{r}
LM.Flow.five <- LM.Rank.flow.min$sort.data[which.min(abs(LM.Rank.flow.min$probability-5))]#ranking the data and taking out the data <90% discharge
LM.ninety.five.percent.flow <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
#making a new data frame with the <90% data
LM.percent.below.ninety.five <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
for(i in 1:length(unique(LittleMillseat$Year))){
LM.Q.year<-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
LM.ninety.five.percent.flow[i]<-sum(ifelse(na.omit(LM.Q.year$mindaily_CFS)>=LM.Flow.five,1,0))
#Dentoing which flows are <90%
LM.percent.below.ninety.five[i]<-(LM.ninety.five.percent.flow[i]/length(na.omit(LM.Q.year$mindaily_CFS)))*100
}
# establishing the discharge where only 10% of flow exceeds that rate
LM.ninety.five.percent.flow <- data.frame("ninety.five.percent"=LM.ninety.five.percent.flow,"year"=unique(LittleMillseat$Year))
# creating a matrix to report the 5% exceeded values

#Half-Decadal
LM.days.exceeding.five.decade <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
colnames(LM.days.exceeding.five.decade) <- "Number_Days"
rownames(LM.days.exceeding.five.decade) <- LM.half.decades

for (i in 1:length(LM.half.decades)) {
    
    LM.subset.decades <- LittleMillseat[which(LittleMillseat$half.decade==LM.half.decades[i]),]
    
    LM.days.exceeding.five.decade[i,1] <- sum(ifelse(na.omit(LM.subset.decades$mindaily_CFS)>=LM.Flow.five,1,0))
}
LM.days.exceeding.five.decade$halfdec <- LM.half.decades

LM.five.senslope.halfdec <- sens.output(time.step=LM.days.exceeding.five.decade$halfdec,data=LM.days.exceeding.five.decade$Number_Days)
LM.five.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
LM.days.exceeding.five.year <- data.frame(matrix(nrow=length(LM.years),ncol=1))
colnames(LM.days.exceeding.five.year) <- "Number_Days"

for (i in 1:length(LM.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
    LM.days.exceeding.five.year[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)>=LM.Flow.five,1,0))
}
LM.days.exceeding.five.year$year <- as.numeric(LM.years)
LM.five.senslope.year <- sens.output(time.step=LM.days.exceeding.five.year$year,data=LM.days.exceeding.five.year$Number_Days)
LM.five.senslope.year$year <- "Calendar.Year"

#Water Year
LM.days.exceeding.five.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1))
colnames(LM.days.exceeding.five.wateryear) <- "Number_Days"

for (i in 1:length(LM.water.years)) {
    LM.subset.wateryears <- LittleMillseat[which(LittleMillseat$Water_Year==LM.water.years[i]),]
    LM.days.exceeding.five.wateryear[i,1] <- sum(ifelse(na.omit(LM.subset.wateryears$mindaily_CFS)>=LM.Flow.five,1,0))
}
LM.days.exceeding.five.wateryear$Water_Year <- unique(LittleMillseat$Water_Year)
LM.five.senslope.wateryear <- sens.output(time.step=LM.days.exceeding.five.wateryear$Water_Year,data=LM.days.exceeding.five.wateryear$Number_Days)
LM.five.senslope.wateryear$year <- "Water.Year"

#Climate Year
LM.days.exceeding.five.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1))
colnames(LM.days.exceeding.five.climateyear) <- "Number_Days"

for (i in 1:length(LM.climate.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Climate_Year==LM.climate.years[i]),]
    LM.days.exceeding.five.climateyear[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)>=LM.Flow.five,1,0))
}
LM.days.exceeding.five.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.five.senslope.climateyear <- sens.output(time.step=LM.days.exceeding.five.climateyear$Climate_Year,data=LM.days.exceeding.five.climateyear$Number_Days)
LM.five.senslope.climateyear$year <- "Climate.Year"

#Seasonal
LM.days.exceeding.five.season <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$season))))
colnames(LM.days.exceeding.five.season) <- c("Winter","Spring","Summer","Autumn")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.seasons)){
    LM.days.exceeding.five.season[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.seasons[j])]>=Flow.five,1,0))
    }
}

LM.days.exceeding.five.season$year <- LM.years
LM.days.exceeding.five.season <- na.omit(LM.days.exceeding.five.season)

LM.five.senslope.winter <- sens.output(time.step=LM.days.exceeding.five.season$year,data=LM.days.exceeding.five.season$Winter)
LM.five.senslope.spring <- sens.output(time.step=LM.days.exceeding.five.season$year,data=LM.days.exceeding.five.season$Spring)
LM.five.senslope.summer <- sens.output(time.step=LM.days.exceeding.five.season$year,data=LM.days.exceeding.five.season$Summer)
LM.five.senslope.autumn <- sens.output(time.step=LM.days.exceeding.five.season$year,data=LM.days.exceeding.five.season$Autumn)
LM.five.senslope.season <- rbind(LM.five.senslope.winter,LM.five.senslope.spring,LM.five.senslope.summer,LM.five.senslope.autumn)
LM.five.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
LM.days.exceeding.five.month <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$month))))
colnames(LM.days.exceeding.five.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.months)){
    LM.days.exceeding.five.month[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[j])]>=LM.Flow.five,1,0))
    }
}
LM.days.exceeding.five.month$year <- LM.years
LM.days.exceeding.five.month <- na.omit(LM.days.exceeding.five.month)

LM.five.senslope.jan <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$January)
LM.five.senslope.feb <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$February)
LM.five.senslope.mar <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$March)
LM.five.senslope.apr <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$April)
LM.five.senslope.may <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$May)
LM.five.senslope.jun <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$June)
LM.five.senslope.jul <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$July)
LM.five.senslope.aug <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$August)
LM.five.senslope.sep <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$September)
LM.five.senslope.oct <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$October)
LM.five.senslope.nov <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$November)
LM.five.senslope.dec <- sens.output(time.step=LM.days.exceeding.five.month$year,data=LM.days.exceeding.five.month$December)
LM.five.senslope.month <- rbind(LM.five.senslope.jan,LM.five.senslope.feb,LM.five.senslope.mar,LM.five.senslope.apr,LM.five.senslope.may,LM.five.senslope.jun,LM.five.senslope.jul,LM.five.senslope.aug,LM.five.senslope.sep,LM.five.senslope.oct,LM.five.senslope.nov,LM.five.senslope.dec)
LM.five.senslope.month$Month <- unique(LittleMillseat$Month)

```

### Section 4.6.1: Flows >Q5 Plot
```{r}
#Half-Decadal
ggplot(data=LM.days.exceeding.five.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.five.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Little Millseat Half-Decadal Days With Flow Exceeding Q5")

#yearly
ggplot(data=LM.days.exceeding.five.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.five.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q5")

ggplot(data=LM.days.exceeding.five.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.five.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q5 Using Water Year")

ggplot(data=LM.days.exceeding.five.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.five.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q5 Using Climate Year")
#seasonal
LM.days.exceeding.five.season.long <- gather(LM.days.exceeding.five.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
LM.days.exceeding.five.season.long <- na.omit(LM.days.exceeding.five.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM5.cal.jpeg", width=750)
ggplot(LM.days.exceeding.five.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=LM.five.senslope.season, aes(slope=slope, intercept=10))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Little Millseat Seasonal Days With Flow Exceeding Q5")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
LM.days.exceeding.five.month.long <- gather(LM.days.exceeding.five.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
LM.days.exceeding.five.month.long <- na.omit(LM.days.exceeding.five.month.long)

ggplot(LM.days.exceeding.five.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=LM.five.senslope.month, aes(slope=slope, intercept=5))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q5")+
  ggtitle("Little Millseat Monthly Days With Flow Exceeding Q5")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

```

### Section 4.6.2:Flows >Q5 Statistical Summary
```{r}
LM.five.statistical.summary <- rbind.fill(LM.five.senslope.halfdec,LM.five.senslope.year,LM.five.senslope.wateryear,LM.five.senslope.climateyear,LM.five.senslope.season,LM.five.senslope.month)
```

## Section 4.7: Flows >Q1
```{r}
LM.Flow.one <- LM.Rank.flow.min$sort.data[which.min(abs(LM.Rank.flow.min$probability-1))]#ranking the data and taking out the data <90% discharge
LM.ninety.nine.percent.flow <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
#making a new data frame with the <90% data
LM.percent.below.ninety.nine <- matrix(nrow=length(unique(LittleMillseat$Year)),ncol=1)
for(i in 1:length(unique(LittleMillseat$Year))){
LM.Q.year<-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
LM.ninety.nine.percent.flow[i]<-sum(ifelse(na.omit(LM.Q.year$mindaily_CFS)>=LM.Flow.one,1,0))
#Dentoing which flows are <90%
LM.percent.below.ninety.nine[i]<-(LM.ninety.nine.percent.flow[i]/length(na.omit(LM.Q.year$mindaily_CFS)))*100
}
# establishing the discharge where only 10% of flow exceeds that rate
LM.ninety.nine.percent.flow <- data.frame("ninety.nine.percent"=LM.ninety.nine.percent.flow,"year"=unique(LittleMillseat$Year))
# creating a matrix to report the 5% exceeded values

#Half-Decadal
LM.days.exceeding.one.decade <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
colnames(LM.days.exceeding.one.decade) <- "Number_Days"
rownames(LM.days.exceeding.one.decade) <- LM.half.decades

for (i in 1:length(LM.half.decades)) {
    
    LM.subset.decades <- LittleMillseat[which(LittleMillseat$half.decade==LM.half.decades[i]),]
    
    LM.days.exceeding.one.decade[i,1] <- sum(ifelse(na.omit(LM.subset.decades$mindaily_CFS)>=LM.Flow.one,1,0))
}
LM.days.exceeding.one.decade$halfdec <- LM.half.decades

LM.one.senslope.halfdec <- sens.output(time.step=LM.days.exceeding.one.decade$halfdec,data=LM.days.exceeding.one.decade$Number_Days)
LM.one.senslope.halfdec$half.decade <- "Half.Decade"

#Yearly
#Calendar Year
LM.days.exceeding.one.year <- data.frame(matrix(nrow=length(LM.years),ncol=1))
colnames(LM.days.exceeding.one.year) <- "Number_Days"

for (i in 1:length(LM.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
    LM.days.exceeding.one.year[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)>=LM.Flow.one,1,0))
}
LM.days.exceeding.one.year$year <- as.numeric(LM.years)
LM.one.senslope.year <- sens.output(time.step=LM.days.exceeding.one.year$year,data=LM.days.exceeding.one.year$Number_Days)
LM.one.senslope.year$year <- "Calendar.Year"

#Water Year
LM.days.exceeding.one.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1))
colnames(LM.days.exceeding.one.wateryear) <- "Number_Days"

for (i in 1:length(LM.water.years)) {
    LM.subset.wateryears <- LittleMillseat[which(LittleMillseat$Water_Year==LM.water.years[i]),]
    LM.days.exceeding.one.wateryear[i,1] <- sum(ifelse(na.omit(LM.subset.wateryears$mindaily_CFS)>=LM.Flow.one,1,0))
}
LM.days.exceeding.one.wateryear$Water_Year <- unique(LittleMillseat$Water_Year)
LM.one.senslope.wateryear <- sens.output(time.step=LM.days.exceeding.one.wateryear$Water_Year,data=LM.days.exceeding.one.wateryear$Number_Days)
LM.one.senslope.wateryear$year <- "Water.Year"

#Climate Year
LM.days.exceeding.one.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1))
colnames(LM.days.exceeding.one.climateyear) <- "Number_Days"

for (i in 1:length(LM.climate.years)) {
    LM.subset.years <- LittleMillseat[which(LittleMillseat$Climate_Year==LM.climate.years[i]),]
    LM.days.exceeding.one.climateyear[i,1] <- sum(ifelse(na.omit(LM.subset.years$mindaily_CFS)>=LM.Flow.one,1,0))
}
LM.days.exceeding.one.climateyear$Climate_Year <- unique(LittleMillseat$Climate_Year)
LM.one.senslope.climateyear <- sens.output(time.step=LM.days.exceeding.one.climateyear$Climate_Year,data=LM.days.exceeding.one.climateyear$Number_Days)
LM.one.senslope.climateyear$year <- "Climate.Year"

#Seasonal
LM.days.exceeding.one.season <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$season))))
colnames(LM.days.exceeding.one.season) <- c("Winter","Spring","Summer","Autumn")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.seasons)){
    LM.days.exceeding.one.season[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.seasons[j])]>=Flow.one,1,0))
    }
}

LM.days.exceeding.one.season$year <- LM.years
LM.days.exceeding.one.season <- na.omit(LM.days.exceeding.one.season)

LM.one.senslope.winter <- sens.output(time.step=LM.days.exceeding.one.season$year,data=LM.days.exceeding.one.season$Winter)
LM.one.senslope.spring <- sens.output(time.step=LM.days.exceeding.one.season$year,data=LM.days.exceeding.one.season$Spring)
LM.one.senslope.summer <- sens.output(time.step=LM.days.exceeding.one.season$year,data=LM.days.exceeding.one.season$Summer)
LM.one.senslope.autumn <- sens.output(time.step=LM.days.exceeding.one.season$year,data=LM.days.exceeding.one.season$Autumn)
LM.one.senslope.season <- rbind(LM.one.senslope.winter,LM.one.senslope.spring,LM.one.senslope.summer,LM.one.senslope.autumn)
LM.one.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

#Monthly
LM.days.exceeding.one.month <- data.frame(matrix(nrow=length(LM.years),ncol=length(unique(LittleMillseat$month))))
colnames(LM.days.exceeding.one.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

for (i in 1:length(LM.years)) {
    for (j in 1:length(LM.months)){
    LM.days.exceeding.one.month[i,j] <- sum(ifelse(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[j])]>=LM.Flow.one,1,0))
    }
}
LM.days.exceeding.one.month$year <- LM.years
LM.days.exceeding.one.month <- na.omit(LM.days.exceeding.one.month)

LM.one.senslope.jan <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$January)
LM.one.senslope.feb <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$February)
LM.one.senslope.mar <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$March)
LM.one.senslope.apr <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$April)
LM.one.senslope.may <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$May)
LM.one.senslope.jun <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$June)
LM.one.senslope.jul <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$July)
LM.one.senslope.aug <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$August)
LM.one.senslope.sep <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$September)
LM.one.senslope.oct <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$October)
LM.one.senslope.nov <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$November)
LM.one.senslope.dec <- sens.output(time.step=LM.days.exceeding.one.month$year,data=LM.days.exceeding.one.month$December)
LM.one.senslope.month <- rbind(LM.one.senslope.jan,LM.one.senslope.feb,LM.one.senslope.mar,LM.one.senslope.apr,LM.one.senslope.may,LM.one.senslope.jun,LM.one.senslope.jul,LM.one.senslope.aug,LM.one.senslope.sep,LM.one.senslope.oct,LM.one.senslope.nov,LM.one.senslope.dec)
LM.one.senslope.month$Month <- unique(LittleMillseat$Month)

```

### Section 4.7.1: Flows >Q1 Plot
```{r}
#Half-Decadal
ggplot(data=LM.days.exceeding.one.decade, aes(x=halfdec,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.one.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half-Decade")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Little Millseat Half-Decadal Days With Flow Exceeding Q1")

#yearly
ggplot(data=LM.days.exceeding.one.year, aes(x=year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.one.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q1")

ggplot(data=LM.days.exceeding.one.wateryear, aes(x=Water_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.one.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Water Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q1 Using Water Year")

ggplot(data=LM.days.exceeding.one.climateyear, aes(x=Climate_Year,y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.one.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Little Millseat Yearly Days With Flow Exceeding Q1 Using Climate Year")
#seasonal
LM.days.exceeding.one.season.long <- gather(LM.days.exceeding.one.season, key="season", value="value", c("Winter", "Spring","Summer", "Autumn"))
LM.days.exceeding.one.season.long <- na.omit(LM.days.exceeding.one.season.long)

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM1.cal.jpeg", width=750)
ggplot(LM.days.exceeding.one.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=LM.one.senslope.season, aes(slope=slope, intercept=10))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Little Millseat Seasonal Days With Flow Exceeding Q1")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#monthly
LM.days.exceeding.one.month.long <- gather(LM.days.exceeding.one.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
LM.days.exceeding.one.month.long <- na.omit(LM.days.exceeding.one.month.long)

ggplot(LM.days.exceeding.one.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=LM.one.senslope.month, aes(slope=slope, intercept=5))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Days With Flow Exceeding Q1")+
  ggtitle("Little Millseat Monthly Days With Flow Exceeding Q1")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

```

### Section 4.7.2: Flows >Q1 Statistical Summary
```{r}
LM.one.statistical.summary <- rbind.fill(LM.one.senslope.halfdec,LM.one.senslope.year,LM.one.senslope.wateryear,LM.one.senslope.climateyear,LM.one.senslope.season,LM.one.senslope.month)
```

## Section 4.8: Yearly Flow Duration Curves (unnecessary)

# Section 5: Timing

## Section 5.1: First No-Flow Day
```{r}
#yearly
LM.first.nf.date <- data.frame(matrix(nrow=length(LM.years),ncol=1))
for(i in 1:length(LM.years)){
  LM.min.year <- data.frame(min.Q=LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==unique(LM.years)[i])])
  LM.min.year$date <- LittleMillseat$Date.1[which(LittleMillseat$Year==unique(LM.years)[i])]
  LM.new.noflow <- ifelse(length(which(LM.min.year$min.Q==0))==0,NA,which(LM.min.year$min.Q==0))
  LM.first.noflow <- min(LM.new.noflow)
  LM.first.noflow.date <- LM.min.year$date[LM.first.noflow]
  LM.first.nf.date[i,1] <- LM.first.noflow.date
}
colnames(LM.first.nf.date) <- c("First.no.flow")
LM.first.nf.date$year <- as.numeric(LM.years)
LM.first.nf.date$First.no.flow <- as.Date(LM.first.nf.date$First.no.flow)
LM.first.nf.date$day.of.year <- strftime(LM.first.nf.date$First.no.flow, format="%j")
LM.first.nf.date$day.of.year <- as.numeric(LM.first.nf.date$day.of.year)

LM.first.nf.date <- na.omit(LM.first.nf.date)
LM.first.nfdate.senslope <- sens.output(time.step=LM.first.nf.date$year,data=LM.first.nf.date$day.of.year)
LM.first.nfdate.senslope$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_firstnf.cal.jpeg", width=1000)
ggplot(data=LM.first.nf.date, aes(x=year, y=day.of.year))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.first.nfdate.senslope, aes(slope=slope, intercept=intercept))+
  ylim(0,365)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Day of Year")+
  ggtitle("Little Millseat Yearly First No-Flow Day")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
LM.first.nf.date.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1))
for(i in 1:length(LM.water.years)){
  LM.min.wateryear <- data.frame(LM.min.Q=LittleMillseat$meandaily_CFS[which(LittleMillseat$Water_Year==unique(LM.water.years)[i])])
  LM.min.wateryear$date <- LittleMillseat$Date.1[which(LittleMillseat$Water_Year==unique(LM.water.years)[i])]
  LM.new.noflow.wateryear <- ifelse(length(which(LM.min.wateryear$LM.min.Q==0))==0,NA,which(LM.min.wateryear$LM.min.Q==0))
  LM.first.noflow.wateryear <- min(LM.new.noflow.wateryear)
  LM.first.noflow.date.wateryear <- LM.min.wateryear$date[LM.first.noflow.wateryear]
  LM.first.nf.date.wateryear[i,1] <- LM.first.noflow.date.wateryear
}
colnames(LM.first.nf.date.wateryear) <- c("First.no.flow")
LM.first.nf.date.wateryear$Water_Year <- LM.water.years
LM.first.nf.date.wateryear$First.no.flow <- as.Date(LM.first.nf.date.wateryear$First.no.flow)
LM.first.nf.date.wateryear$day.of.year <- strftime(LM.first.nf.date.wateryear$First.no.flow, format="%j")
LM.first.nf.date.wateryear$day.of.year <- as.numeric(LM.first.nf.date.wateryear$day.of.year)

LM.first.nf.date.wateryear <- na.omit(LM.first.nf.date.wateryear)
LM.first.nfdate.wateryear.senslope <- sens.output(time.step=LM.first.nf.date.wateryear$Water_Year,data=LM.first.nf.date.wateryear$day.of.year)
LM.first.nfdate.wateryear.senslope$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_firstnf.water.jpeg", width=1000)
ggplot(data=LM.first.nf.date.wateryear, aes(x=Water_Year, y=day.of.year))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.first.nfdate.wateryear.senslope, aes(slope=slope, intercept=intercept))+
  ylim(0,365)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Day of Year")+
  ggtitle("Little Millseat Yearly First No-Flow Day Using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
LM.first.nf.date.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1))
for(i in 1:length(LM.climate.years)){
  LM.min.climateyear <- data.frame(LM.min.Q=LittleMillseat$meandaily_CFS[which(LittleMillseat$Climate_Year==unique(LM.climate.years)[i])])
  LM.min.climateyear$date <- LittleMillseat$Date.1[which(LittleMillseat$Climate_Year==unique(LM.climate.years)[i])]
  LM.new.noflow.climateyear <- ifelse(length(which(LM.min.climateyear$LM.min.Q==0))==0,NA,which(LM.min.climateyear$LM.min.Q==0))
  LM.first.noflow.climateyear <- min(LM.new.noflow.climateyear)
  LM.first.noflow.date.climateyear <- LM.min.climateyear$date[LM.first.noflow.climateyear]
  LM.first.nf.date.climateyear[i,1] <- LM.first.noflow.date.climateyear
}
colnames(LM.first.nf.date.climateyear) <- c("First.no.flow")
LM.first.nf.date.climateyear$Climate_Year <- LM.climate.years
LM.first.nf.date.climateyear$First.no.flow <- as.Date(LM.first.nf.date.climateyear$First.no.flow)
LM.first.nf.date.climateyear$day.of.year <- strftime(LM.first.nf.date.climateyear$First.no.flow, format="%j")
LM.first.nf.date.climateyear$day.of.year <- as.numeric(LM.first.nf.date.climateyear$day.of.year)

LM.first.nf.date.climateyear <- na.omit(LM.first.nf.date.climateyear)
LM.first.nfdate.climateyear.senslope <- sens.output(time.step=LM.first.nf.date.climateyear$Climate_Year,data=LM.first.nf.date.climateyear$day.of.year)
LM.first.nfdate.climateyear.senslope$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_firstnf.clim.jpeg", width=1000)
ggplot(data=LM.first.nf.date.climateyear, aes(x=Climate_Year, y=day.of.year))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.first.nfdate.climateyear.senslope, aes(slope=slope, intercept=intercept))+
  ylim(0,365)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Day of Year")+
  ggtitle("Little Millseat Yearly First No-Flow Day Using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

```

## Section 5.2: First No-Flow Day Statistical Summary
```{r}
LM.first.nfdate.statistical.summary <- rbind.fill(LM.first.nfdate.senslope,LM.first.nfdate.wateryear.senslope,LM.first.nfdate.climateyear.senslope)
```

#Section 6: Duration

## Section 6.1: Longest Consecutive No-Flow Period
```{r}
#1/2 Decadal
LM.max.flow.duration.halfdec <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
rownames(LM.max.flow.duration.halfdec) <- LM.half.decades
colnames(LM.max.flow.duration.halfdec) <- c("Number_Days")

for (i in 1:length(LM.half.decades)) {
    if (length(LittleMillseat[which(LittleMillseat$half.decade == LM.half.decades[i]),8])!=0) {
      LM.subset.halfdec <-LittleMillseat[which(LittleMillseat$half.decade==LM.half.decades[i]),]
      LM.subset.halfdec$consec.days <- NA
      LM.subset.halfdec$Flow.state.ID<-ifelse(is.na(LM.subset.halfdec$Flow.state.ID),1,LM.subset.halfdec$Flow.state.ID)
   
    for (j in 1:length(LM.subset.halfdec$Date.1)) {
      if (j == 1 & LM.subset.halfdec$Flow.state.ID[j] == 1) {
        LM.subset.halfdec$consec.days[j] <- 1
      } else if (j > 1 & LM.subset.halfdec$Flow.state.ID[j] == 1) {
        LM.subset.halfdec$consec.days[j] <-
          LM.subset.halfdec$Flow.state.ID[j] + LM.subset.halfdec$consec.days[j - 1]
      } else {
        LM.subset.halfdec$consec.days[j] <- 0
      }
     
    }
    LM.max.flow.duration.halfdec[i,1] <- max(LM.subset.halfdec$consec.days)
    }else {NA}
   
}

LM.max.noflow.duration.halfdec <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
colnames(LM.max.noflow.duration.halfdec) <- c("Number_Days")
LM.max.noflow.duration.halfdec$halfdec <- LM.half.decades

for (i in 1:length(LM.half.decades)) {
    if (length(LittleMillseat[which(LittleMillseat$half.decade == LM.half.decades[i]),8])!=0) {
      LM.subset.halfdec <-LittleMillseat[which(LittleMillseat$half.decade==LM.half.decades[i]),]
      LM.subset.halfdec$consec.nf.days <- NA
      LM.subset.halfdec$Flow.state.ID<-ifelse(is.na(LM.subset.halfdec$Flow.state.ID),1,LM.subset.halfdec$Flow.state.ID)
   
    for (j in 1:length(LM.subset.halfdec$Date.1)) {
      if (j == 1 & LM.subset.halfdec$Flow.state.ID[j] == 0) {
        LM.subset.halfdec$consec.nf.days[j] <- 1
      } else if (j > 1 & LM.subset.halfdec$Flow.state.ID[j] == 0) {
        LM.subset.halfdec$consec.nf.days[j] <-
          LM.subset.halfdec$Flow.state.ID[j] + 1 + LM.subset.halfdec$consec.nf.days[j - 1]
      } else {
        LM.subset.halfdec$consec.nf.days[j] <- 0
      }
     
    }
    LM.max.noflow.duration.halfdec[i,1] <- max(LM.subset.halfdec$consec.nf.days)
    }else {NA}
   
}
LM.max.noflow.duration.halfdec <- na.omit(LM.max.noflow.duration.halfdec)

LM.max.nf.senslope.halfdec <- sens.output(time.step=LM.max.noflow.duration.halfdec$halfdec,data=LM.max.noflow.duration.halfdec$Number_Days)
LM.max.nf.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(data=LM.max.noflow.duration.halfdec, aes(x=halfdec, y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.max.nf.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Little Millseat Half-Decadal Maximum No-Flow Duration")

#yearly
LM.max.flow.duration.year <- matrix(nrow=length(LM.years),ncol=1) 
LM.max.flow.duration.year <- data.frame(LM.max.flow.duration.year)
rownames(LM.max.flow.duration.year) <- LM.years
colnames(LM.max.flow.duration.year) <- c("Number_Days")

for (i in 1:length(LM.years)) {
    if (length(LittleMillseat[which(LittleMillseat$Year == LM.years[i]),8])!=0) {
      LM.subset.year <-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
      LM.subset.year$consec.days <- NA
      LM.subset.year$Flow.state.ID<-ifelse(is.na(LM.subset.year$Flow.state.ID),1,LM.subset.year$Flow.state.ID)
   
    for (j in 1:length(LM.subset.year$Date.1)) {
      if (j == 1 & LM.subset.year$Flow.state.ID[j] == 1) {
        LM.subset.year$consec.days[j] <- 1
      } else if (j > 1 & LM.subset.year$Flow.state.ID[j] == 1) {
        LM.subset.year$consec.days[j] <-
          LM.subset.year$Flow.state.ID[j] + LM.subset.year$consec.days[j - 1]
      } else {
        LM.subset.year$consec.days[j] <- 0
      }
     
    }
    LM.max.flow.duration.year[i,1] <- max(LM.subset.year$consec.days)
    }else {NA}
   
}

LM.max.noflow.duration.year <- data.frame(matrix(nrow=length(LM.years),ncol=1))
colnames(LM.max.noflow.duration.year) <- c("Number_Days")
LM.max.noflow.duration.year$year <- LM.years

for (i in 1:length(LM.years)) {
    if (length(LittleMillseat[which(LittleMillseat$Year == LM.years[i]),8])!=0) {
      LM.subset.year <-LittleMillseat[which(LittleMillseat$Year==LM.years[i]),]
      LM.subset.year$consec.nf.days <- NA
      LM.subset.year$Flow.state.ID<-ifelse(is.na(LM.subset.year$Flow.state.ID),1,LM.subset.year$Flow.state.ID)
  for (j in 1:length(LM.subset.year$Date.1)) {
      if (j == 1 & LM.subset.year$Flow.state.ID[j] == 0) {
        LM.subset.year$consec.nf.days[j] <- 1
      } else if (j > 1 & LM.subset.year$Flow.state.ID[j] == 0) {
        LM.subset.year$consec.nf.days[j] <-
          LM.subset.year$Flow.state.ID[j]+ 1 + LM.subset.year$consec.nf.days[j - 1]
      } else {
        LM.subset.year$consec.nf.days[j] <- 0
      }
     
    }
    LM.max.noflow.duration.year[i,1] <- max(LM.subset.year$consec.nf.days)
    } else {NA}
   
}
LM.max.noflow.duration.year <- na.omit(LM.max.noflow.duration.year)
LM.max.nf.senslope.year <- sens.output(time.step=LM.max.noflow.duration.year$year,data=LM.max.noflow.duration.year$Number_Days)
LM.max.nf.senslope.year$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_longestnf.cal.jpeg", width=1000)
ggplot(data=LM.max.noflow.duration.year, aes(x=year, y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.max.nf.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Little Millseat Yearly Maximum No-Flow Duration")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
LM.max.flow.duration.climateyear <- matrix(nrow=length(LM.climate.years),ncol=1) 
LM.max.flow.duration.climateyear <- data.frame(LM.max.flow.duration.climateyear)
rownames(LM.max.flow.duration.climateyear) <- LM.climate.years
colnames(LM.max.flow.duration.climateyear) <- c("Number_Days")

for (i in 1:length(LM.climate.years)) {
    if (length(LittleMillseat[which(LittleMillseat$Climate_Year == LM.climate.years[i]),8])!=0) {
      LM.subset.climateyear <-LittleMillseat[which(LittleMillseat$Climate_Year==LM.climate.years[i]),]
      LM.subset.climateyear$consec.days <- NA
      LM.subset.climateyear$Flow.state.ID<-ifelse(is.na(LM.subset.climateyear$Flow.state.ID),1,LM.subset.climateyear$Flow.state.ID)
   
    for (j in 1:length(LM.subset.climateyear$Date.1)) {
      if (j == 1 & LM.subset.climateyear$Flow.state.ID[j] == 1) {
        LM.subset.climateyear$consec.days[j] <- 1
      } else if (j > 1 & LM.subset.climateyear$Flow.state.ID[j] == 1) {
        LM.subset.climateyear$consec.days[j] <-
          LM.subset.climateyear$Flow.state.ID[j] + LM.subset.climateyear$consec.days[j - 1]
      } else {
        LM.subset.climateyear$consec.days[j] <- 0
      }
     
    }
    LM.max.flow.duration.climateyear[i,1] <- max(LM.subset.climateyear$consec.days)
    }else {NA}
   
}

LM.max.noflow.duration.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1))
colnames(LM.max.noflow.duration.climateyear) <- c("Number_Days")
LM.max.noflow.duration.climateyear$Climate_Year <- LM.climate.years

for (i in 1:length(LM.climate.years)) {
    if (length(LittleMillseat[which(LittleMillseat$Climate_Year == LM.climate.years[i]),8])!=0) {
      LM.subset.climateyear <-LittleMillseat[which(LittleMillseat$Climate_Year==LM.climate.years[i]),]
      LM.subset.climateyear$consec.nf.days <- NA
      LM.subset.climateyear$Flow.state.ID<-ifelse(is.na(LM.subset.climateyear$Flow.state.ID),1,LM.subset.climateyear$Flow.state.ID)
  for (j in 1:length(LM.subset.climateyear$Date)) {
      if (j == 1 & LM.subset.climateyear$Flow.state.ID[j] == 0) {
        LM.subset.climateyear$consec.nf.days[j] <- 1
      } else if (j > 1 & LM.subset.climateyear$Flow.state.ID[j] == 0) {
        LM.subset.climateyear$consec.nf.days[j] <-
          LM.subset.climateyear$Flow.state.ID[j]+ 1 + LM.subset.climateyear$consec.nf.days[j - 1]
      } else {
        LM.subset.climateyear$consec.nf.days[j] <- 0
      }
     
    }
    LM.max.noflow.duration.climateyear[i,1] <- max(LM.subset.climateyear$consec.nf.days)
    } else {NA}
   
}
LM.max.nf.senslope.climateyear <- sens.output(time.step=LM.max.noflow.duration.climateyear$Climate_Year,data=LM.max.noflow.duration.climateyear$Number_Days)
LM.max.nf.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_longestnf.clim.jpeg", width=1000)
ggplot(data=LM.max.noflow.duration.climateyear, aes(x=Climate_Year, y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.max.nf.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Little Millseat Yearly Maximum No-Flow Duration Using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
LM.max.flow.duration.wateryear <- matrix(nrow=length(LM.water.years),ncol=1) 
LM.max.flow.duration.wateryear <- data.frame(LM.max.flow.duration.wateryear)
rownames(LM.max.flow.duration.wateryear) <- LM.water.years
colnames(LM.max.flow.duration.wateryear) <- c("Number_Days")

for (i in 1:length(LM.water.years)) {
    if (length(LittleMillseat[which(LittleMillseat$Water_Year == LM.water.years[i]),8])!=0) {
      LM.subset.wateryear <-LittleMillseat[which(LittleMillseat$Water_Year==LM.water.years[i]),]
      LM.subset.wateryear$consec.days <- NA
      LM.subset.wateryear$Flow.state.ID<-ifelse(is.na(LM.subset.wateryear$Flow.state.ID),1,LM.subset.wateryear$Flow.state.ID)
   
    for (j in 1:length(LM.subset.wateryear$Date.1)) {
      if (j == 1 & subset.wateryear$Flow.state.ID[j] == 1) {
        LM.subset.wateryear$consec.days[j] <- 1
      } else if (j > 1 & LM.subset.wateryear$Flow.state.ID[j] == 1) {
        LM.subset.wateryear$consec.days[j] <-
          LM.subset.wateryear$Flow.state.ID[j] + LM.subset.wateryear$consec.days[j - 1]
      } else {
        LM.subset.wateryear$consec.days[j] <- 0
      }
     
    }
    LM.max.flow.duration.wateryear[i,1] <- max(LM.subset.wateryear$consec.days)
    }else {NA}
   
}

LM.max.noflow.duration.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1))
colnames(LM.max.noflow.duration.wateryear) <- c("Number_Days")
LM.max.noflow.duration.wateryear$Water_Year <- LM.water.years

for (i in 1:length(LM.water.years)) {
    if (length(LittleMillseat[which(LittleMillseat$Water_Year == LM.water.years[i]),8])!=0) {
      LM.subset.wateryear <-LittleMillseat[which(LittleMillseat$Water_Year==LM.water.years[i]),]
      LM.subset.wateryear$consec.nf.days <- NA
      LM.subset.wateryear$Flow.state.ID<-ifelse(is.na(LM.subset.wateryear$Flow.state.ID),1,LM.subset.wateryear$Flow.state.ID)
  for (j in 1:length(LM.subset.wateryear$Date.1)) {
      if (j == 1 & LM.subset.wateryear$Flow.state.ID[j] == 0) {
        LM.subset.wateryear$consec.nf.days[j] <- 1
      } else if (j > 1 & LM.subset.wateryear$Flow.state.ID[j] == 0) {
        LM.subset.wateryear$consec.nf.days[j] <-
          LM.subset.wateryear$Flow.state.ID[j]+ 1 + LM.subset.wateryear$consec.nf.days[j - 1]
      } else {
        LM.subset.wateryear$consec.nf.days[j] <- 0
      }
     
    }
    LM.max.noflow.duration.wateryear[i,1] <- max(LM.subset.wateryear$consec.nf.days)
    } else {NA}
   
}
LM.max.nf.senslope.wateryear <- sens.output(time.step=LM.max.noflow.duration.wateryear$Water_Year,data=LM.max.noflow.duration.wateryear$Number_Days)
LM.max.nf.senslope.wateryear$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_longestnf.water.jpeg", width=1000)
ggplot(data=LM.max.noflow.duration.wateryear, aes(x=Water_Year, y=Number_Days))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.max.nf.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Little Millseat Yearly Maximum No-Flow Duration Using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#seasonal
LM.season <- unique(LittleMillseat$season)
LM.max.flow.duration.season <- data.frame(matrix(nrow=length(LM.years),ncol=length(LM.season)))
colnames(LM.max.flow.duration.season) <- LM.season
LM.max.flow.duration.season$year <- LM.years

for (i in 1:length(LM.years)) {
  for (k in 1:length(LM.season)) {
    if (length(LittleMillseat[which(LittleMillseat$Year == LM.years[i] & LittleMillseat$season == LM.season[k]),8])!=0) {
    LM.subset.season <-LittleMillseat[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.season[k]),]
    LM.subset.season$consec.days <- NA
    LM.subset.season$Flow.state.ID <- ifelse(is.na(LM.subset.season$Flow.state.ID),1,LM.subset.season$Flow.state.ID)
   
    for (j in 1:length(LM.subset.season$Date.1)) {
      if (j == 1 & LM.subset.season$Flow.state.ID[j] == 1) {
        LM.subset.season$consec.days[j] <- 1
      } else if (j > 1 & LM.subset.season$Flow.state.ID[j] == 1) {
        LM.subset.season$consec.days[j] <-
          LM.subset.season$Flow.state.ID[j] + LM.subset.season$consec.days[j - 1]
      } else {
        LM.subset.season$consec.days[j] <- 0
      }
     
    }
    LM.max.flow.duration.season[i, k] <- max(LM.subset.season$consec.days)
    } else {NA}
   
  }
}

LM.max.noflow.duration.season <- data.frame(matrix(nrow=length(LM.years),ncol=length(LM.season)))
colnames(LM.max.noflow.duration.season) <- LM.season
LM.max.noflow.duration.season$year <- LM.years

for (i in 1:length(LM.years)) {
  for (k in 1:length(LM.season)) {
    if (length(LittleMillseat[which(LittleMillseat$Year == LM.years[i] & LittleMillseat$season == LM.season[k]),8])!=0) {
    LM.subset.season <-LittleMillseat[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.season[k]),]
    LM.subset.season$consec.nf.days <- NA
    LM.subset.season$Flow.state.ID <- ifelse(is.na(LM.subset.season$Flow.state.ID),1,LM.subset.season$Flow.state.ID)
   
    for (j in 1:length(LM.subset.season$consec.nf.days)) {
      if (j == 1 & LM.subset.season$Flow.state.ID[j] == 0) {
        LM.subset.season$consec.nf.days[j] <- 1
      } else if (j > 1 & LM.subset.season$Flow.state.ID[j] == 0) {
        LM.subset.season$consec.nf.days[j] <-
          LM.subset.season$Flow.state.ID[j] + 1 + LM.subset.season$consec.nf.days[j - 1]
      } else {
        LM.subset.season$consec.nf.days[j] <- 0
      }
     
    }
    LM.max.noflow.duration.season[i, k] <- max(LM.subset.season$consec.nf.days)
    } else {NA}
   
  }
}

LM.max.noflow.duration.season$year <- as.numeric(LM.years)
LM.max.noflow.duration.season <- na.omit(LM.max.noflow.duration.season)

LM.max.nf.senslope.winter <- sens.output(time.step=LM.max.noflow.duration.season$year,data=LM.max.noflow.duration.season$winter)
LM.max.nf.senslope.spring <- sens.output(time.step=LM.max.noflow.duration.season$year,data=LM.max.noflow.duration.season$spring)
LM.max.nf.senslope.summer <- sens.output(time.step=LM.max.noflow.duration.season$year,data=LM.max.noflow.duration.season$summer)
LM.max.nf.senslope.autumn <- sens.output(time.step=LM.max.noflow.duration.season$year,data=LM.max.noflow.duration.season$autumm)
LM.max.nf.senslope.seasons <- rbind(LM.max.nf.senslope.winter,LM.max.nf.senslope.spring,LM.max.nf.senslope.summer,LM.max.nf.senslope.autumn)
LM.max.nf.senslope.seasons$season <- LM.season

LM.max.noflow.duration.season.long <- gather(LM.max.noflow.duration.season, key="season", value="value", c("winter","spring","summer","autumm",))

ggplot(LM.max.noflow.duration.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=LM.max.nf.senslope.seasons, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Little Millseat Seasonal Maximum No-Flow Duration")

#monthly
LM.months <- unique(LittleMillseat$month)
LM.max.flow.duration.month <- data.frame(matrix(nrow=length(LM.years),ncol=length(LM.months))) 
colnames(LM.max.flow.duration.month) <- LM.months
LM.max.flow.duration.month$year <- LM.years

for (i in 1:length(LM.years)) {
  for (k in 1:length(LM.months)) {
    if (length(LittleMillseat[which(LittleMillseat$Year == LM.years[i] & LittleMillseat$month == LM.months[k]),8])!=0) {
      LM.subset.month <-LittleMillseat[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[k]),]
    LM.subset.month$consec.days <- NA
    LM.subset.month$Flow.state.ID <- ifelse(is.na(LM.subset.month$Flow.state.ID),1,LM.subset.month$Flow.state.ID)
   
    for (j in 1:length(LM.subset.month$Date.1)) {
      if (j == 1 & LM.subset.month$Flow.state.ID[j] == 1) {
        LM.subset.month$consec.days[j] <- 1
      } else if (j > 1 & LM.subset.month$Flow.state.ID[j] == 1) {
        LM.subset.month$consec.days[j] <-
          LM.subset.month$Flow.state.ID[j] + LM.subset.month$consec.days[j - 1]
      } else {
        LM.subset.month$consec.days[j] <- 0
      }
     
    }
    LM.max.flow.duration.month[i, k] <- max(LM.subset.month$consec.days)
    } else {NA}
   
  }
}

LM.max.noflow.duration.month <- data.frame(matrix(nrow=length(LM.years),ncol=length(LM.months)))
colnames(LM.max.noflow.duration.month) <- LM.months
LM.max.noflow.duration.month$year <- LM.years

for (i in 1:length(LM.years)) {
  for (k in 1:length(LM.months)) {
    if (length(LittleMillseat[which(LittleMillseat$Year == LM.years[i] & LittleMillseat$month == LM.months[k]),8])!=0) {
      LM.subset.month <-LittleMillseat[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[k]),]
    LM.subset.month$consec.nf.days <- NA
    LM.subset.month$Flow.state.ID <- ifelse(is.na(LM.subset.month$Flow.state.ID),1,LM.subset.month$Flow.state.ID)
   
    for (j in 1:length(LM.subset.month$Date.1)) {
      if (j == 1 & LM.subset.month$Flow.state.ID[j] == 0) {
        LM.subset.month$consec.nf.days[j] <- 1
      } else if (j > 1 & LM.subset.month$Flow.state.ID[j] == 0) {
        LM.subset.month$consec.nf.days[j] <-
          LM.subset.month$Flow.state.ID[j] + 1 + LM.subset.month$consec.nf.days[j - 1]
      } else {
        LM.subset.month$consec.nf.days[j] <- 0
      }
     
    }
    LM.max.noflow.duration.month[i, k] <- max(LM.subset.month$consec.nf.days)
    } else {NA}
   
  }
}
colnames(LM.max.noflow.duration.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
LM.max.noflow.duration.month$year <- LM.years
LM.max.noflow.duration.month <- na.omit(LM.max.noflow.duration.month)
LM.max.nf.senslope.jan <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$January)
LM.max.nf.senslope.feb <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$February)
LM.max.nf.senslope.mar <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$March)
LM.max.nf.senslope.apr <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$April)
LM.max.nf.senslope.may <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$May)
LM.max.nf.senslope.jun <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$June)
LM.max.nf.senslope.jul <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$July)
LM.max.nf.senslope.aug <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$August)
LM.max.nf.senslope.sep <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$September)
LM.max.nf.senslope.oct <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$October)
LM.max.nf.senslope.nov <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$November)
LM.max.nf.senslope.dec <- sens.output(time.step=LM.max.noflow.duration.month$year,data=LM.max.noflow.duration.month$December)
LM.max.nf.senslope.month <- rbind(LM.max.nf.senslope.jan,LM.max.nf.senslope.feb,LM.max.nf.senslope.mar,LM.max.nf.senslope.apr,LM.max.nf.senslope.may,LM.max.nf.senslope.jun,LM.max.nf.senslope.jul,LM.max.nf.senslope.aug,LM.max.nf.senslope.sep,LM.max.nf.senslope.oct,LM.max.nf.senslope.nov,LM.max.nf.senslope.dec)
LM.max.nf.senslope.month$Month <- unique(LittleMillseat$Month)
LM.max.noflow.duration.month.long <- gather(LM.max.noflow.duration.month, key="Month", value="value", c("January","February","March","April","May","June","July","August","September","October","November","December"))

ggplot(LM.max.noflow.duration.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=LM.max.nf.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("No-Flow Duration (Days)")+
  ggtitle("Little Millseat Monthly Maximum No-Flow Duration")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))
```

## Section 6.2: Longest Consecutive No-Flow Duration Statistical Summary
```{r}
LM.longest.nf.statistical.summary <- rbind.fill(LM.max.nf.senslope.halfdec,LM.max.nf.senslope.year,LM.max.nf.senslope.wateryear,LM.max.nf.senslope.climateyear,LM.max.nf.senslope.seasons,LM.max.nf.senslope.month)
```

# Section 7: Magnitude

## Section 7.1: Peak Flows
```{r}
#1/2 Decade
LM.max.discharge.halfdec <- data.frame(matrix(nrow=length(LM.half.decades)))
for(i in 1:length(LM.discharge.half.dec)){
  LM.max.discharge.halfdec[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$half.decade==LM.half.decades[i])])
}
colnames(LM.max.discharge.halfdec) <- c("Peak_Flow")
LM.max.discharge.halfdec$halfdec <- LM.half.decades
LM.max.discharge.halfdec <- na.omit(LM.max.discharge.halfdec)
LM.max.flow.senslope.halfdec <- sens.output(time.step=LM.max.discharge.halfdec$halfdec,data=LM.max.discharge.halfdec$Peak_Flow)
LM.max.flow.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(data=LM.max.discharge.halfdec, aes(halfdec,Peak_Flow))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.max.flow.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("Discharge (cfs)")+
  ggtitle("Little Millseat Maximum Half-Decadal Discharge")+
  
  
#Yearly
LM.max.discharge.per.year <- data.frame(matrix(nrow=length(LM.discharge.year)))
for(i in 1:length(LM.discharge.year)){
  LM.max.discharge.per.year[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i])])
}
colnames(LM.max.discharge.per.year) <- c("Peak_Flow")
LM.max.discharge.per.year$year <- LM.years
LM.max.discharge.per.year <- na.omit(LM.max.discharge.per.year)

LM.max.flow.senslope.year <- sens.output(time.step=LM.max.discharge.per.year$year,data=LM.max.discharge.per.year$Peak_Flow)
LM.max.flow.senslope.year$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_peak.cal.jpeg", width=1000)
ggplot(data=LM.max.discharge.per.year, aes(year,Peak_Flow))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.max.flow.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("year")+
  ylab("Discharge (cfs)")+
  ggtitle("Little Millseat Maximum Yearly Discharge")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
LM.max.discharge.per.wateryear <- data.frame(matrix(nrow=length(LM.water.years)))
for(i in 1:length(LM.water.years)){
  LM.max.discharge.per.wateryear[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Water_Year==LM.water.years[i])])
}
colnames(LM.max.discharge.per.wateryear) <- c("Peak_Flow")
LM.max.discharge.per.wateryear$Water_Year <- LM.water.years
LM.max.discharge.per.wateryear <- na.omit(LM.max.discharge.per.wateryear)

LM.max.flow.senslope.wateryear <- sens.output(time.step=LM.max.discharge.per.wateryear$Water_Year,data=LM.max.discharge.per.wateryear$Peak_Flow)
LM.max.flow.senslope.wateryear$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_peak.water.jpeg", width=1000)
ggplot(data=LM.max.discharge.per.wateryear, aes(Water_Year,Peak_Flow))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.max.flow.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("year")+
  ylab("Discharge (cfs)")+
  ggtitle("Little Millseat Maximum Yearly Discharge Using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
LM.max.discharge.per.climateyear <- data.frame(matrix(nrow=length(LM.climate.years)))
for(i in 1:length(LM.climate.years)){
  LM.max.discharge.per.climateyear[i,1] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Climate_Year==LM.climate.years[i])])
}
colnames(LM.max.discharge.per.climateyear) <- c("Peak_Flow")
LM.max.discharge.per.climateyear$Climate_year <- LM.climate.years
LM.max.discharge.per.climateyear <- na.omit(LM.max.discharge.per.climateyear)

LM.max.flow.senslope.climateyear <- sens.output(time.step=LM.max.discharge.per.climateyear$Climate_year,data=LM.max.discharge.per.climateyear$Peak_Flow)
LM.max.flow.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_peak.clim.jpeg", width=1000)
ggplot(data=LM.max.discharge.per.climateyear, aes(Climate_year,Peak_Flow))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.max.flow.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("year")+
  ylab("Discharge (cfs)")+
  ggtitle("Little Millseat Maximum Yearly Discharge Using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Seasonal
LM.max.discharge.per.season <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.season)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.season)){
    LM.max.discharge.per.season[i,j] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$season==LM.discharge.season[j])])
  }
}
colnames(LM.max.discharge.per.season) <- c("Winter","Spring","Summer","Autumn")
LM.max.discharge.per.season$year <- LM.years
LM.max.discharge.per.season <- na.omit(LM.max.discharge.per.season)
LM.max.discharge.per.season.long <- gather(LM.max.discharge.per.season, key="season", value="value", c("Summer", "Autumn","Winter", "Spring"))

LM.max.flow.senslope.winter <- sens.output(time.step=LM.max.discharge.per.season$year,data=LM.max.discharge.per.season$Winter)
LM.max.flow.senslope.spring <- sens.output(time.step=LM.max.discharge.per.season$year,data=LM.max.discharge.per.season$Spring)
LM.max.flow.senslope.summer <- sens.output(time.step=LM.max.discharge.per.season$year,data=LM.max.discharge.per.season$Summer)
LM.max.flow.senslope.autumn <- sens.output(time.step=LM.max.discharge.per.season$year,data=LM.max.discharge.per.season$Autumn)
LM.max.flow.senslope.season <- rbind(LM.max.flow.senslope.winter,LM.max.flow.senslope.spring,LM.max.flow.senslope.summer,LM.max.flow.senslope.autumn)
LM.max.flow.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

ggplot(LM.max.discharge.per.season.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_abline(data=LM.max.flow.senslope.season, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  ggtitle("Little Millseat Maximum Seasonal Discharge")

#Monthly
LM.max.discharge.per.month <- data.frame(matrix(nrow=length(LM.discharge.year),ncol=length(LM.discharge.month)))
for(i in 1:length(LM.discharge.year)){
  for(j in 1:length(LM.discharge.month)){
    LM.max.discharge.per.month[i,j] <- max(LittleMillseat$maxdaily_CFS[which(LittleMillseat$Year==LM.discharge.year[i]&LittleMillseat$month==LM.discharge.month[j])])
  }}
colnames(LM.max.discharge.per.month) <- c("January","February","March","April","May","June","July", "August","September","October","November","December")
LM.max.discharge.per.month$year <- LM.years
LM.max.discharge.per.month.long <- gather(LM.max.discharge.per.month, key="Month", value="value", c("January","February","March","April","May","June","July", "August","September","October","November","December"))
LM.max.discharge.per.month <- na.omit(LM.max.discharge.per.month)
LM.max.flow.senslope.jan <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$January)
LM.max.flow.senslope.feb <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$February)
LM.max.flow.senslope.mar <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$March)
LM.max.flow.senslope.apr <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$April)
LM.max.flow.senslope.may <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$May)
LM.max.flow.senslope.jun <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$June)
LM.max.flow.senslope.jul <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$July)
LM.max.flow.senslope.aug <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$August)
LM.max.flow.senslope.sep <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$September)
LM.max.flow.senslope.oct <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$October)
LM.max.flow.senslope.nov <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$November)
LM.max.flow.senslope.dec <- sens.output(time.step=LM.max.discharge.per.month$year,data=LM.max.discharge.per.month$December)
LM.max.flow.senslope.month <- rbind(LM.max.flow.senslope.jan,LM.max.flow.senslope.feb,LM.max.flow.senslope.mar,LM.max.flow.senslope.apr,LM.max.flow.senslope.may,LM.max.flow.senslope.jun,LM.max.flow.senslope.jul,LM.max.flow.senslope.aug,LM.max.flow.senslope.sep,LM.max.flow.senslope.oct,LM.max.flow.senslope.nov,LM.max.flow.senslope.dec)
LM.max.flow.senslope.month$Month <- unique(LittleMillseat$Month)

ggplot(LM.max.discharge.per.month.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_abline(data=LM.max.flow.senslope.month, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Discharge(cfs)")+
  ggtitle("Little Millseat Maximum Monthly Discharge")

```

### Section 7.1.1: Peak Flows Statistical Summary
```{r}
LM.PeakFlow.statistical.summary <- rbind.fill(LM.max.flow.senslope.halfdec,LM.max.flow.senslope.year,LM.max.flow.senslope.wateryear,LM.max.flow.senslope.climateyear,LM.max.flow.senslope.season,LM.max.flow.senslope.month)
```

## Section 7.2: Slope of Midpoint of FDC
```{r}
#Timeseries
LM.fdc <- data.frame("sort.data"=sort(LittleMillseat$meandaily_CFS,decreasing = TRUE))
#sorting the data in decreasing order
LM.fdc$rank <- 1:length(LM.fdc$sort.data)
#adding a rank to the flows in the data frame
LM.fdc$probability <- ((LM.fdc$rank)/(1+length(LM.fdc$rank)))*100
# adding the probability of the flows
LM.fdc.20 <- LM.fdc$sort.data[which.min(abs(LM.fdc$probability-20))]
LM.fdc.70 <- LM.fdc$sort.data[which.min(abs(LM.fdc$probability-70))]
LM.fdc.slope <- (LM.fdc.20-LM.fdc.70)/50
print(LM.fdc.slope)

#1/2 Decade
LM_FDC_halfdec=list()#creating a new list for the flow duration curves
LM.half.decades <- unique(LittleMillseat$half.decade)
for(i in 1:(length(LM.half.decades))) {
  LM_FDC_halfdec[[i]] <- data.frame("sort.data"=sort(na.omit(LittleMillseat$meandaily_CFS[which(LittleMillseat$half.decade==LM.half.decades[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
  LM_FDC_halfdec[[i]]$rank <- 1:length(LM_FDC_halfdec[[i]]$sort.data)#adding a rank column where highest flow is 1
  LM_FDC_halfdec[[i]]$probability<-((LM_FDC_halfdec[[i]]$rank)/(length(LM_FDC_halfdec[[i]]$rank)+1))*100
}
#finding the probability of each event
LM_FDC_halfdec_stats <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1))
colnames(LM_FDC_halfdec_stats) <- c("halfdec")
LM_FDC_halfdec_stats$halfdec <- LM.half.decades
for(i in 1:length(LM.half.decades)){
  LM_FDC_halfdec_stats$twenty[i] <- LM_FDC_halfdec[[i]]$sort.data[which.min(abs((LM_FDC_halfdec[[i]]$probability)-20))]
  LM_FDC_halfdec_stats$seventy[i] <- LM_FDC_halfdec[[i]]$sort.data[which.min(abs((LM_FDC_halfdec[[i]]$probability)-70))]
} #finding the probability of each event
LM_FDC_halfdec_stats$slope <- ((LM_FDC_halfdec_stats$twenty)-(LM_FDC_halfdec_stats$seventy))/50
LM.fdc.slope.senslope.halfdec <- sens.output(time.step=LM_FDC_halfdec_stats$halfdec,data=LM_FDC_halfdec_stats$slope)
LM.fdc.slope.senslope.halfdec$half.decade <- "Half.Decade"

ggplot(data=LM_FDC_halfdec_stats, aes(x=halfdec,y=slope))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.fdc.slope.senslope.halfdec, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("Slope")+
  ggtitle("Little Millseat Half-Decadal Slope of Midpoint of FDC")

#yearly
LM_FDC_years=list()#creating a new list for the flow duration curves
LM.years <- unique(LittleMillseat$Year)
for(i in 1:(length(unique(LittleMillseat$Year)))){
  LM_FDC_years[[i]] <- data.frame("sort.data"=sort(na.omit(LittleMillseat$meandaily_CFS[which(LittleMillseat$Year==LM.years[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
LM_FDC_years[[i]]$rank <- 1:length(LM_FDC_years[[i]]$sort.data)#adding a rank column where highest flow is 1
LM_FDC_years[[i]]$probability<-((LM_FDC_years[[i]]$rank)/(length(LM_FDC_years[[i]]$rank)+1))*100
} #finding the probability of each event


LM_FDC_year_stats <- data.frame(matrix(nrow=(length(LM_FDC_years)),ncol=1))
colnames(LM_FDC_year_stats) <- c("year")
LM_FDC_year_stats$year <- LM.years
for(i in 1:length(unique(LM_FDC_year_stats$year))){
  LM_FDC_year_stats$twenty[i] <- LM_FDC_years[[i]]$sort.data[which.min(abs((LM_FDC_years[[i]]$probability)-20))]
  LM_FDC_year_stats$seventy[i] <- LM_FDC_years[[i]]$sort.data[which.min(abs((LM_FDC_years[[i]]$probability)-70))]
} #finding the probability of each event
LM_FDC_year_stats$slope <- ((LM_FDC_year_stats$twenty)-(LM_FDC_year_stats$seventy))/50
LM.FDC.slope.senslope.year <- sens.output(time.step=LM_FDC_year_stats$year,data=LM_FDC_year_stats$slope)
LM.FDC.slope.senslope.year$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_slopefdc.cal.jpeg", width=1000)
ggplot(data=LM_FDC_year_stats, aes(x=year, y=slope))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.FDC.slope.senslope.year, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Little Millseat Yearly Slope of Midpoint of FDC")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
LM_FDC_wateryears=list()#creating a new list for the flow duration curves
for(i in 1:(length(unique(LittleMillseat$Water_Year))))
  {
  LM_FDC_wateryears[[i]] <- data.frame("sort.data"=sort(na.omit(LittleMillseat$meandaily_CFS[which(LittleMillseat$Water_Year==LM.water.years[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
LM_FDC_wateryears[[i]]$rank <- 1:length(LM_FDC_wateryears[[i]]$sort.data)#adding a rank column where highest flow is 1
LM_FDC_wateryears[[i]]$probability<-((LM_FDC_wateryears[[i]]$rank)/(length(LM_FDC_wateryears[[i]]$rank)+1))*100
} #finding the probability of each event

LM_FDC_wateryear_stats <- data.frame(matrix(nrow=(length(LM_FDC_wateryears)),ncol=1))
colnames(LM_FDC_wateryear_stats) <- c("year")
LM_FDC_wateryear_stats$Water_Year <- LM.water.years
for(i in 1:length(unique(LM_FDC_wateryear_stats$Water_Year))){
  LM_FDC_wateryear_stats$twenty[i] <- LM_FDC_wateryears[[i]]$sort.data[which.min(abs((LM_FDC_wateryears[[i]]$probability)-20))]
  LM_FDC_wateryear_stats$seventy[i] <- LM_FDC_wateryears[[i]]$sort.data[which.min(abs((LM_FDC_wateryears[[i]]$probability)-70))]
} #finding the probability of each event
LM_FDC_wateryear_stats$slope <- ((LM_FDC_wateryear_stats$twenty)-(LM_FDC_wateryear_stats$seventy))/50
LM.FDC.slope.senslope.wateryear <- sens.output(time.step=LM_FDC_wateryear_stats$Water_Year,data=LM_FDC_wateryear_stats$slope)
LM.FDC.slope.senslope.wateryear$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_slopefdc.water.jpeg", width=1000)
ggplot(data=LM_FDC_wateryear_stats, aes(x=Water_Year, y=slope))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.FDC.slope.senslope.wateryear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Little Millseat Yearly Slope of Midpoint of FDC using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
LM_FDC_climateyears=list()#creating a new list for the flow duration curves
for(i in 1:(length(unique(LittleMillseat$Climate_Year))))
  {
  LM_FDC_climateyears[[i]] <- data.frame("sort.data"=sort(na.omit(LittleMillseat$meandaily_CFS[which(LittleMillseat$Climate_Year==LM.climate.years[i])]),decreasing = TRUE)) #sorting the data from highest to lowest flow
LM_FDC_climateyears[[i]]$rank <- 1:length(LM_FDC_climateyears[[i]]$sort.data)#adding a rank column where highest flow is 1
LM_FDC_climateyears[[i]]$probability<-((LM_FDC_climateyears[[i]]$rank)/(length(LM_FDC_climateyears[[i]]$rank)+1))*100
} #finding the probability of each event

LM_FDC_climateyear_stats <- data.frame(matrix(nrow=(length(LM_FDC_climateyears)),ncol=1))
colnames(LM_FDC_climateyear_stats) <- c("year")
LM_FDC_climateyear_stats$Climate_Year <- LM.climate.years
for(i in 1:length(unique(LM_FDC_climateyear_stats$Climate_Year))){
  LM_FDC_climateyear_stats$twenty[i] <- LM_FDC_climateyears[[i]]$sort.data[which.min(abs((LM_FDC_climateyears[[i]]$probability)-20))]
  LM_FDC_climateyear_stats$seventy[i] <- LM_FDC_climateyears[[i]]$sort.data[which.min(abs((LM_FDC_climateyears[[i]]$probability)-70))]
} #finding the probability of each event
LM_FDC_climateyear_stats$slope <- ((LM_FDC_climateyear_stats$twenty)-(LM_FDC_climateyear_stats$seventy))/50
LM.FDC.slope.senslope.climateyear <- sens.output(time.step=LM_FDC_climateyear_stats$Climate_Year,data=LM_FDC_climateyear_stats$slope)
LM.FDC.slope.senslope.climateyear$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_slopefdc.clim.jpeg", width=1000)
ggplot(data=LM_FDC_climateyear_stats, aes(x=Climate_Year, y=slope))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.FDC.slope.senslope.climateyear, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Little Millseat Yearly Slope of Midpoint of FDC using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#seasonal
LM.slope.seasonal <- data.frame(matrix(ncol=length(LM.seasons),nrow=length(LM.years)))
LM.seasonal.flow.twenty <-  data.frame(matrix(ncol=length(LM.seasons),nrow=length(LM.years)))
LM.seasonal.flow.seventy <-  data.frame(matrix(ncol=length(LM.seasons),nrow=length(LM.years)))


for(i in 1:length(LM.years)){
  for(j in 1:length(LM.seasons)){
    LM.subset.flow.season <- data.frame(LittleMillseat[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$season==LM.seasons[j]),])
    if(length(LM.subset.flow.season$Date)>0&sum(is.na(LM.subset.flow.season$meandaily_CFS))<length(LM.subset.flow.season$Date)){
      LM.sort.flow.season <- data.frame(sort(LM.subset.flow.season$meandaily_CFS,decreasing=TRUE))
      colnames(LM.sort.flow.season) <- c("Flow")
      LM.sort.flow.season$rank <- 1:length(LM.sort.flow.season$Flow)
      LM.sort.flow.season$probability <- (LM.sort.flow.season$rank/(1+length(LM.sort.flow.season$rank)))*100
      LM.seasonal.flow.twenty[i,j]<-LM.sort.flow.season$Flow[which.min(abs(LM.sort.flow.season$probability-20))]
      LM.seasonal.flow.seventy[i,j]<-LM.sort.flow.season$Flow[which.min(abs(LM.sort.flow.season$probability-70))]
      LM.slope.seasonal[i,j] <- (LM.seasonal.flow.twenty[i,j]-LM.seasonal.flow.seventy[i,j])/50
    }
    else{
      LM.seasonal.flow.twenty[i,j] <- NA
      LM.seasonal.flow.seventy[i,j] <- NA
      LM.slope.seasonal[i,j] <- NA
    }
  }
}
colnames(LM.slope.seasonal) <- c("Winter","Spring","Summer","Autumn")
LM.slope.seasonal$year <- LM.years

LM.slope.seasonal.long <- gather(LM.slope.seasonal, key="season", value="value", c("Winter","Spring","Summer","Autumn"))
LM.FDC.slope.senslope.winter <- sens.output(time.step=LM.slope.seasonal$year,data=LM.slope.seasonal$Winter)
LM.FDC.slope.senslope.spring <- sens.output(time.step=LM.slope.seasonal$year,data=LM.slope.seasonal$Spring)
LM.FDC.slope.senslope.summer <- sens.output(time.step=LM.slope.seasonal$year,data=LM.slope.seasonal$Summer)
LM.FDC.slope.senslope.autumn <- sens.output(time.step=LM.slope.seasonal$year,data=LM.slope.seasonal$Autumn)
LM.FDC.slope.senslope.season <- rbind(LM.FDC.slope.senslope.winter,LM.FDC.slope.senslope.spring,LM.FDC.slope.senslope.summer,LM.FDC.slope.senslope.autumn)
LM.FDC.slope.senslope.season$season <- c("Winter", "Spring", "Summer", "Autumn")

ggplot(LM.slope.seasonal.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=LM.FDC.slope.senslope.season, aes(slope=slope, intercept=intercept))+
  facet_wrap(~season)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Little Millseat Seasonal Slope of Midpoint of FDC")

#monthly
LM.slope.monthly <- data.frame(matrix(ncol=length(LM.months),nrow=length(LM.years)))
LM.monthly.flow.twenty <-  data.frame(matrix(ncol=length(LM.months),nrow=length(LM.years)))
LM.monthly.flow.seventy <-  data.frame(matrix(ncol=length(LM.months),nrow=length(LM.years)))


for(i in 1:length(LM.years)){
  for(j in 1:length(LM.months)){
    LM.subset.flow.month <- data.frame(LittleMillseat[which(LittleMillseat$Year==LM.years[i]&LittleMillseat$month==LM.months[j]),])
    if(length(LM.subset.flow.month$Date)>0&sum(is.na(LM.subset.flow.month$meandaily_CFS))<length(LM.subset.flow.month$Date)){
      LM.sort.flow.month <- data.frame(sort(LM.subset.flow.month$meandaily_CFS,decreasing=TRUE))
      colnames(LM.sort.flow.month) <- c("Flow")
      LM.sort.flow.month$rank <- 1:length(LM.sort.flow.month$Flow)
      LM.sort.flow.month$probability <- (LM.sort.flow.month$rank/(1+length(LM.sort.flow.month$rank)))*100
      LM.monthly.flow.twenty[i,j]<-LM.sort.flow.month$Flow[which.min(abs(LM.sort.flow.month$probability-20))]
      LM.monthly.flow.seventy[i,j]<-LM.sort.flow.month$Flow[which.min(abs(LM.sort.flow.month$probability-70))]
      LM.slope.monthly[i,j] <- (LM.monthly.flow.twenty[i,j]-LM.monthly.flow.seventy[i,j])/50
    }
    else{
      LM.monthly.flow.twenty[i,j] <- NA
      LM.monthly.flow.seventy[i,j] <- NA
      LM.slope.monthly[i,j] <- NA
    }
  }
}

colnames(LM.slope.monthly) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
LM.slope.monthly$year <- unique(LittleMillseat$Year)

LM.slope.monthly.long <- gather(slope.monthly, key="Month", value="value", c("January","February","March","April","May","June","July","August","September","October","November","December"))
LM.slope.monthly.long <- na.omit(LM.slope.monthly.long)
LM.slope.monthly <- na.omit(LM.slope.monthly)
LM.FDC.slope.senslope.jan <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$January)
LM.FDC.slope.senslope.feb <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$February)
LM.FDC.slope.senslope.mar <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$March)
LM.FDC.slope.senslope.apr <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$April)
LM.FDC.slope.senslope.may <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$May)
LM.FDC.slope.senslope.jun <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$June)
LM.FDC.slope.senslope.jul <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$July)
LM.FDC.slope.senslope.aug <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$August)
LM.FDC.slope.senslope.sep <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$September)
LM.FDC.slope.senslope.oct <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$October)
LM.FDC.slope.senslope.nov <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$November)
LM.FDC.slope.senslope.dec <- sens.output(time.step=LM.slope.monthly$year,data=LM.slope.monthly$December)
LM.FDC.slope.senslope.month <- rbind(LM.FDC.slope.senslope.jan,LM.FDC.slope.senslope.feb,LM.FDC.slope.senslope.mar,LM.FDC.slope.senslope.apr,LM.FDC.slope.senslope.may,LM.FDC.slope.senslope.jun,LM.FDC.slope.senslope.jul,LM.FDC.slope.senslope.aug,LM.FDC.slope.senslope.sep,LM.FDC.slope.senslope.oct,LM.FDC.slope.senslope.nov,LM.FDC.slope.senslope.dec)
LM.FDC.slope.senslope.month$Month <- unique(LittleMillseat$Month)

ggplot(LM.slope.monthly.long, aes(x=year, y=value))+
  geom_bar(stat='identity')+
  geom_abline(data=LM.FDC.slope.senslope.month, aes(slope=slope, intercept=intercept))+
  facet_wrap(~factor(Month,levels=c("January","February","March","April","May","June","July","August","September","October","November","December")))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Slope")+
  ggtitle("Little Millseat Monthly Slope of Midpoint of FDC")+
  theme(axis.text.x = element_text(size = 5), axis.title.x=element_text(size=10),axis.text.y=element_text(size=5),axis.title.y = element_text(size=10))

```

### Section 7.2.1: Slope of Midpoint of FDC Statistical Summary
```{r}
LM.FDCslope.statistical.summary <- rbind.fill(LM.fdc.slope.senslope.halfdec,LM.FDC.slope.senslope.year,LM.FDC.slope.senslope.wateryear,LM.FDC.slope.senslope.climateyear,LM.FDC.slope.senslope.season,LM.FDC.slope.senslope.month)
```

## Section 7.3: Water Budget
```{r}
LittleMillseat$FlowVolume <- LittleMillseat$meandaily_CFS*86400
#1/2 Decade

LM.vol.precip.halfdec <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1)) #creating a matrix to sum the precipitation in each year 
LM.precip.half.dec <- unique(LittleMillseat.precip$half.decade)

LM.sum.flow.halfdec <- data.frame(matrix(nrow=length(LM.half.decades),ncol=1)) 
for(i in 1:length(LM.precip.half.dec)){ #running a for loop through each year in precip data
  LM.vol.precip.halfdec[i,1] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$half.decade==LM.precip.half.dec[i])],na.rm=TRUE)*(1/25.4)*(1/12)*8503481
  LM.sum.flow.halfdec[i,1] <- median(LittleMillseat$mindaily_CFS[which(LittleMillseat$half.decade==LM.precip.half.dec[i])],na.rm=TRUE)*(86400)*365*5
  
  #assigning a new variable for the sum of each years precip data
}

LM.Water.budget.halfdec <- LM.sum.flow.halfdec/LM.vol.precip.halfdec
colnames(LM.Water.budget.halfdec) <- c("Water_Budget")
LM.Water.budget.halfdec$halfdec <- c(1:10)
LM.Water.budget.halfdec <- na.omit(LM.Water.budget.halfdec)
LM.water.budget.halfdec.senslope <- sens.output(time.step=LM.Water.budget.halfdec$halfdec,data=LM.Water.budget.halfdec$Water_Budget)
LM.water.budget.halfdec.senslope$half.decade <- "Half.Decade"

ggplot(data=LM.Water.budget.halfdec, aes(x=halfdec, y=Water_Budget))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.water.budget.halfdec.senslope, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Half Decade")+
  ylab("Water Budget")+
  ggtitle("Little Millseat Half-Decadal Water Budget")

#Yearly
LM.precip.year <- unique(LittleMillseat.precip$year)
LM.vol.precip.year <- data.frame(matrix(nrow=length(LM.precip.year),ncol=1)) #creating a matrix to sum the precipitation in each year 
LM.sum.flow.year <- data.frame(matrix(nrow=length(LM.precip.year),ncol=1)) 
for(i in 1:length(LM.precip.year)){ #running a for loop through each year in precip data
  LM.vol.precip.year[i,1] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$year==LM.precip.year[i])]*(1/25.4)*(1/12)*8503481,na.rm=TRUE)
  LM.sum.flow.year[i,1] <- median(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.precip.year[i])],na.rm=TRUE)*(86400)*365
  #assigning a new variable for the sum of each years precip data
}

LM.Water.budget.year <- LM.sum.flow.year/LM.vol.precip.year
colnames(LM.Water.budget.year) <- c("Water_Budget")
LM.Water.budget.year$year <- LM.precip.year
LM.Water.budget.year <- na.omit(LM.Water.budget.year)
LM.water.budget.year.senslope <- sens.output(time.step=LM.Water.budget.year$year,data=LM.Water.budget.year$Water_Budget)
LM.water.budget.year.senslope$year <- "Calendar.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_wb.cal.jpeg", width=1000)
ggplot(data=LM.Water.budget.year, aes(x=year, y=Water_Budget))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.water.budget.year.senslope, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Little Millseat Yearly Water Budget")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Water Year
LM.vol.precip.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1)) #creating a matrix to sum the precipitation in each year 
LM.sum.flow.wateryear <- data.frame(matrix(nrow=length(LM.water.years),ncol=1)) 
for(i in 1:length(LM.water.years)){ #running a for loop through each year in precip data
  LM.vol.precip.wateryear[i,1] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$Water_Year==LM.water.years[i])]*(1/25.4)*(1/12)*8503481,na.rm=TRUE)
  LM.sum.flow.wateryear[i,1] <- median(LittleMillseat$mindaily_CFS[which(LittleMillseat$Water_Year==LM.water.years[i])],na.rm=TRUE)*(86400)*365
  #assigning a new variable for the sum of each years precip data
}

LM.Water.budget.wateryear <- LM.sum.flow.wateryear/LM.vol.precip.wateryear
colnames(LM.Water.budget.wateryear) <- c("Water_Budget")
LM.Water.budget.wateryear$Water_Year <- LM.water.years
LM.Water.budget.wateryear <- na.omit(LM.Water.budget.wateryear)
LM.water.budget.wateryear.senslope <- sens.output(time.step=LM.Water.budget.wateryear$Water_Year,data=LM.Water.budget.wateryear$Water_Budget)
LM.water.budget.wateryear.senslope$year <- "Water.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_wb.water.jpeg", width=1000)
ggplot(data=LM.Water.budget.wateryear, aes(x=Water_Year, y=Water_Budget))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.water.budget.wateryear.senslope, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Little Millseat Yearly Water Budget Using Water Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Climate Year
LM.vol.precip.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1)) #creating a matrix to sum the precipitation in each year 
LM.sum.flow.climateyear <- data.frame(matrix(nrow=length(LM.climate.years),ncol=1)) 
for(i in 1:length(LM.climate.years)){ #running a for loop through each year in precip data
  LM.vol.precip.climateyear[i,1] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$Climate_Year==LM.climate.years[i])]*(1/25.4)*(1/12)*8503481,na.rm=TRUE)
  LM.sum.flow.climateyear[i,1] <- median(LittleMillseat$mindaily_CFS[which(LittleMillseat$Climate_Year==LM.climate.years[i])],na.rm=TRUE)*(86400)*365
  #assigning a new variable for the sum of each years precip data
}

LM.Water.budget.climateyear <- LM.sum.flow.climateyear/LM.vol.precip.climateyear
colnames(LM.Water.budget.climateyear) <- c("Water_Budget")
LM.Water.budget.climateyear$Climate_Year <- LM.climate.years
LM.Water.budget.climateyear <- na.omit(LM.Water.budget.climateyear)
LM.Water.budget.climateyear <- LM.Water.budget.climateyear[-1,]
LM.water.budget.climateyear.senslope <- sens.output(time.step=LM.Water.budget.climateyear$Climate_Year,data=LM.Water.budget.climateyear$Water_Budget)
LM.water.budget.climateyear.senslope$year <- "Climate.Year"

jpeg(file="C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM_wb.clim.jpeg", width=1000)
ggplot(data=LM.Water.budget.climateyear, aes(x=Climate_Year, y=Water_Budget))+
  geom_bar(stat="identity")+
  geom_abline(data=LM.water.budget.climateyear.senslope, aes(slope=slope, intercept=intercept))+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Little Millseat Yearly Water Budget Using Climate Year")+
  theme(axis.text.x = element_text(size = 13), axis.title.x=element_text(size=20),axis.text.y=element_text(size=20),axis.title.y = element_text(size=20),title=element_text(size=22))
dev.off()

#Seasonal
LM.precip.season <- c("winter","spring","summer","autumm")
LM.vol.precip.season <- data.frame(matrix(nrow=length(LM.precip.year),ncol=length(LM.precip.season))) #creating a matrix to sum the precipitation in each year 
LM.sum.flow.season <- data.frame(matrix(nrow=length(LM.precip.year),ncol=length(LM.precip.season))) 
for(i in 1:length(LM.precip.year)){
  for(j in 1:length(LM.precip.season)){#running a for loop through each year in precip data
  LM.vol.precip.season[i,j] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$year==LM.precip.year[i]&LittleMillseat.precip$season==LM.precip.season[j])],na.rm=TRUE)*0.0394*(1/12)*8503481
  LM.sum.flow.season[i,j] <- median(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.precip.year[i]&LittleMillseat$season==LM.precip.season[j])],na.rm=TRUE)*86400*365*0.25
  }
  #assigning a new variable for the sum of each years precip data
}
colnames(LM.sum.flow.season) <- c("Winter","Spring","Summer","Autumn")
colnames(LM.vol.precip.season) <- c("Winter","Spring","Summer","Autumn")

LM.Water.budget.season <- data.frame(matrix(ncol=4, nrow=length(LM.sum.flow.season$Winter)))
colnames(LM.Water.budget.season) <- c("Winter","Spring","Summer","Autumn")

LM.Water.budget.season$Winter <- LM.sum.flow.season$Winter/LM.vol.precip.season$Winter
LM.Water.budget.season$Spring <- LM.sum.flow.season$Spring/LM.vol.precip.season$Spring
LM.Water.budget.season$Summer <- LM.sum.flow.season$Summer/LM.vol.precip.season$Summer
LM.Water.budget.season$Autumn <- LM.sum.flow.season$Autumn/LM.vol.precip.season$Autumn
LM.Water.budget.season$year <- as.numeric(LM.precip.year)
LM.Water.budget.season.long <- gather(LM.Water.budget.season, key="season", value="value", c("Summer","Autumn","Winter","Spring"))

LM.Water.budget.season$Winter[16:20] <- NA
LM.Water.budget.season$Spring[16:20] <- NA
LM.Water.budget.season$Summer[16:20] <- NA
LM.Water.budget.season$Autumn[16:20] <- NA
LM.Water.budget.season <- na.omit(LM.Water.budget.season)

LM.water.budget.winter.senslope <- sens.output(time.step=LM.Water.budget.season$year,data=LM.Water.budget.season$Winter)
LM.water.budget.spring.senslope <- sens.output(time.step=LM.Water.budget.season$year,data=LM.Water.budget.season$Spring)
LM.water.budget.summer.senslope <- sens.output(time.step=LM.Water.budget.season$year,data=LM.Water.budget.season$Summer)
LM.water.budget.autumn.senslope <- sens.output(time.step=LM.Water.budget.season$year,data=LM.Water.budget.season$Autumn)
LM.water.budget.season.senslope <- rbind(LM.water.budget.winter.senslope,LM.water.budget.spring.senslope,LM.water.budget.summer.senslope,LM.water.budget.autumn.senslope)
LM.water.budget.season.senslope$season <- c("Winter","Spring","Summer","Autumn")

ggplot(LM.Water.budget.season.long, aes(x=year, y=value))+
  geom_abline(data=LM.water.budget.season.senslope, aes(slope=slope, intercept=intercept))+
  geom_bar(stat='identity')+
  facet_wrap(~season)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Little Millseat Seasonal Water Budget")



#Monthly
LM.precip.month <- unique(LittleMillseat$month)
LM.vol.precip.month <- data.frame(matrix(nrow=length(LM.precip.year),ncol=length(LM.precip.month))) #creating a matrix to sum the precipitation in each year 
LM.sum.flow.month <- data.frame(matrix(nrow=length(LM.precip.year),ncol=length(LM.precip.month))) 
for(i in 1:length(LM.precip.year)){
  for(j in 1:length(LM.precip.month)){#running a for loop through each year in precip data
  LM.vol.precip.month[i,j] <- sum(LittleMillseat.precip$Precip_mm[which(LittleMillseat.precip$year==LM.precip.year[i]&LittleMillseat.precip$month==LM.precip.month[j])],na.rm=TRUE)*0.0394*(1/12)*8503481
  LM.sum.flow.month[i,j] <- median(LittleMillseat$mindaily_CFS[which(LittleMillseat$Year==LM.precip.year[i]&LittleMillseat$month==LM.precip.month[j])],na.rm=TRUE)*86400*365*0.25
  }
  #assigning a new variable for the sum of each years precip data
}
colnames(LM.sum.flow.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")
colnames(LM.vol.precip.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

LM.Water.budget.month <- data.frame(matrix(ncol=12, nrow=length(LM.sum.flow.month$January)))
colnames(LM.Water.budget.month) <- c("January","February","March","April","May","June","July","August","September","October","November","December")

LM.Water.budget.month$January <- LM.sum.flow.month$January/LM.vol.precip.month$January
LM.Water.budget.month$February <- LM.sum.flow.month$February/LM.vol.precip.month$February
LM.Water.budget.month$March <- LM.sum.flow.month$March/LM.vol.precip.month$March
LM.Water.budget.month$April <- LM.sum.flow.month$April/LM.vol.precip.month$April
LM.Water.budget.month$May <- LM.sum.flow.month$May/LM.vol.precip.month$May
LM.Water.budget.month$June <- LM.sum.flow.month$June/LM.vol.precip.month$June
LM.Water.budget.month$July <- LM.sum.flow.month$July/LM.vol.precip.month$July
LM.Water.budget.month$August <- LM.sum.flow.month$August/LM.vol.precip.month$August
LM.Water.budget.month$September <- LM.sum.flow.month$September/LM.vol.precip.month$September
LM.Water.budget.month$October <- LM.sum.flow.month$October/LM.vol.precip.month$October
LM.Water.budget.month$November <- LM.sum.flow.month$November/LM.vol.precip.month$November
LM.Water.budget.month$December <- LM.sum.flow.month$December/LM.vol.precip.month$December
LM.Water.budget.month$year <- as.numeric(LM.precip.year)
LM.Water.budget.month.long <- gather(LM.Water.budget.month, key="Month", value="value", c("January","February","March","April","May","June","July","August","September","October","November","December"))

LM.Water.budget.month$January[16:20] <- NA
LM.Water.budget.month$February[16:20] <- NA
LM.Water.budget.month$March[16:20] <- NA
LM.Water.budget.month$April[16:20] <- NA
LM.Water.budget.month$May[16:20] <- NA
LM.Water.budget.month$June[16:20] <- NA
LM.Water.budget.month$July[16:20] <- NA
LM.Water.budget.month$August[16:20] <- NA
LM.Water.budget.month$September[16:20] <- NA
LM.Water.budget.month$October[16:20] <- NA
LM.Water.budget.month$November[16:20] <- NA
LM.Water.budget.month$December[16:20] <- NA
LM.Water.budget.month <- na.omit(LM.Water.budget.month)

LM.water.budget.jan.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$January)
LM.water.budget.feb.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$February)
LM.water.budget.mar.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$March)
LM.water.budget.apr.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$April)
LM.water.budget.may.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$May)
LM.water.budget.jun.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$June)
LM.water.budget.jul.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$July)
LM.water.budget.aug.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$August)
LM.water.budget.sep.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$September)
LM.water.budget.oct.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$October)
LM.water.budget.nov.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$November)
LM.water.budget.dec.senslope <- sens.output(time.step=LM.Water.budget.month$year,data=LM.Water.budget.month$December)
LM.water.budget.month.senslope <- rbind(LM.water.budget.jan.senslope,LM.water.budget.feb.senslope,LM.water.budget.mar.senslope,LM.water.budget.apr.senslope,LM.water.budget.may.senslope,LM.water.budget.jun.senslope,LM.water.budget.jul.senslope,LM.water.budget.aug.senslope,LM.water.budget.sep.senslope,LM.water.budget.oct.senslope,LM.water.budget.nov.senslope,LM.water.budget.dec.senslope)
LM.water.budget.month.senslope$Month <- c("January","February","March","April","May","June","July","August","September","October","November","December")

ggplot(LM.Water.budget.month.long, aes(x=year, y=value))+
  geom_abline(data=LM.water.budget.month.senslope, aes(slope=slope, intercept=intercept))+
  geom_bar(stat='identity')+
  facet_wrap(~Month)+
  geom_smooth(method = "lm", se=FALSE, color="red", aes(group=1))+
  xlab("Year")+
  ylab("Water Budget")+
  ggtitle("Little Millseat Seasonal Water Budget")


```

### Section 7.3.1: Water Budget Statistical Summary
```{r}
LM.Waterbudget.statistical.summary <- rbind.fill(LM.water.budget.halfdec.senslope,LM.water.budget.year.senslope,LM.water.budget.wateryear.senslope,LM.water.budget.climateyear.senslope,LM.water.budget.season.senslope,LM.water.budget.month.senslope)
```

# Section 8: Exporting to PDF
```{r}
pdf("LM.waterbudget.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Waterbudget.statistical.summary)

write.csv(LM.Waterbudget.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.waterbudget.statsum.csv", row.names=FALSE)

pdf("LM.FDCslope.statsum.pdf", width=10)       # Export PDF
grid.table(LM.FDCslope.statistical.summary)

write.csv(LM.FDCslope.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.FDCslope.statsum.csv", row.names=FALSE)

pdf("LM.peakflow.statsum.pdf", width=10)       # Export PDF
grid.table(LM.PeakFlow.statistical.summary)

write.csv(LM.PeakFlow.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.peakflow.statsum.csv", row.names=FALSE)

pdf("LM.longestnf.statsum.pdf", width=10)       # Export PDF
grid.table(LM.longest.nf.statistical.summary)

write.csv(LM.longest.nf.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.longestnf.statsum.csv", row.names=FALSE)

pdf("LM.firstnf.statsum.pdf", width=10)       # Export PDF
grid.table(LM.first.nfdate.statistical.summary)

write.csv(LM.first.nfdate.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.firstnf.statsum.csv", row.names=FALSE)

pdf("LM.one.statsum.pdf", width=10)       # Export PDF
grid.table(LM.one.statistical.summary)

write.csv(LM.one.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.one.statsum.csv", row.names=FALSE)

pdf("LMfive.statsum.pdf", width=10)       # Export PDF
grid.table(LM.five.statistical.summary)

write.csv(LM.five.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.five.statsum.csv", row.names=FALSE)

pdf("LM.twentyfive.statsum.pdf", width=10)       # Export PDF
grid.table(LM.twenty.five.statistical.summary)

write.csv(LM.twenty.five.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.twentyfive.statsum.csv", row.names=FALSE)

pdf("LM.fifty.statsum.pdf", width=10)       # Export PDF
grid.table(LM.fifty.statistical.summary)

write.csv(LM.fifty.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.fifty.statsum.csv", row.names=FALSE)

pdf("LM.seventyfive.statsum.pdf", width=10)       # Export PDF
grid.table(LM.seventyfive.statistical.summary)

write.csv(LM.seventyfive.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.seventyfive.statsum.csv", row.names=FALSE)

pdf("LM.ninety.statsum.pdf", width=10)       # Export PDF
grid.table(LM.ninety.statistical.summary)

write.csv(LM.ninety.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.ninety.statsum.csv", row.names=FALSE)

pdf("LM.minwatertemp.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Min.watertemp.statistical.summary)

write.csv(LM.Min.watertemp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.minwatertemp.statsum.csv", row.names=FALSE)

pdf("LM.meanwatertemp.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Mean.watertemp.statistical.summary)

write.csv(LM.Mean.watertemp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.meanwatertemp.statsum.csv", row.names=FALSE)

pdf("LM.maxwatertemp.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Max.watertemp.statistical.summary)

write.csv(LM.Max.watertemp.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.maxwatertemp.statsum.csv", row.names=FALSE)

pdf("LM.maxflownozero.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Max.Flow.Nozero.statistical.summary)

write.csv(LM.Max.Flow.Nozero.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.maxflownozero.statsum.csv", row.names=FALSE)

pdf("LM.maxflow.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Max.Flow.statistical.summary)

write.csv(LM.Max.Flow.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.maxflow.statsum.csv", row.names=FALSE)

pdf("LM.meanflownozero.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Mean.Flow.Nozero.statistical.summary)

write.csv(LM.Mean.Flow.Nozero.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.meanflow.nozero.statsum.csv", row.names=FALSE)

pdf("LM.meanflow.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Mean.Flow.statistical.summary)

write.csv(LM.Mean.Flow.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.meanflow.statsum.csv", row.names=FALSE)

pdf("LM.minflownozero.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Min.Flow.Nozero.statistical.summary)

write.csv(LM.Min.Flow.Nozero.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.minflownozero.statsum.csv", row.names=FALSE)

pdf("LM.minflow.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Min.Flow.statistical.summary)

write.csv(LM.Min.Flow.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.minflow.statsum.csv", row.names=FALSE)

pdf("LM.Precip.statsum.pdf", width=10)       # Export PDF
grid.table(LM.Precip.statistical.summary)

write.csv(LM.Precip.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.Precip.statsum.csv", row.names=FALSE)

pdf("LM.nfd.statsum.pdf", width=10)
grid.table(LM.NFD.statistical.summary)

write.csv(LM.NFD.statistical.summary, "C:/Users/laure/Desktop/Louisville/Thesis/Data/Falling Rock R Data/LM_Statistical_Summaries/LM.noflow.statsum.csv", row.names=FALSE)
```

